/* 
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD 
*/

var __defProp = Object.defineProperty;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __export = (target, all) => {
  for (var name in all)
    __defProp(target, name, { get: all[name], enumerable: true });
};
var __copyProps = (to, from, except, desc) => {
  if (from && typeof from === "object" || typeof from === "function") {
    for (let key of __getOwnPropNames(from))
      if (!__hasOwnProp.call(to, key) && key !== except)
        __defProp(to, key, { get: () => from[key], enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable });
  }
  return to;
};
var __toCommonJS = (mod) => __copyProps(__defProp({}, "__esModule", { value: true }), mod);

// main.ts
var main_exports = {};
__export(main_exports, {
  default: () => FlatTagPlugin
});
module.exports = __toCommonJS(main_exports);
var import_obsidian3 = require("obsidian");

// constants.ts
var VIEW_TYPE = "flat-tag-view";

// flatTagView.ts
var import_obsidian = require("obsidian");
var GlobalMuteConfirmModal = class extends import_obsidian.Modal {
  constructor(app, tagToMute, onConfirm) {
    super(app);
    this.tagToMute = tagToMute;
    this.onConfirm = onConfirm;
  }
  onOpen() {
    const { contentEl } = this;
    contentEl.empty();
    contentEl.createEl("h2", { text: "Global Mute Tag" });
    const isCurrentlyMuted = this.tagToMute.startsWith("%");
    const targetState = isCurrentlyMuted ? "UN-MUTE" : "MUTE";
    const resultingTag = isCurrentlyMuted ? `#${this.tagToMute.slice(1)}` : `#%${this.tagToMute}`;
    contentEl.createEl("p", {
      text: `Are you sure you want to globally ${targetState} the tag #${this.tagToMute}?`
    });
    contentEl.createEl("p", {
      text: `This will search your entire vault and change every instance to ${resultingTag}. This action modifies your files and cannot be easily undone.`
    });
    new import_obsidian.Setting(contentEl).addButton(
      (btn) => btn.setButtonText("Cancel").onClick(() => this.close())
    ).addButton(
      (btn) => btn.setButtonText(`Yes, ${targetState} Globally`).setCta().onClick(() => {
        this.onConfirm();
        this.close();
      })
    );
  }
  onClose() {
    const { contentEl } = this;
    contentEl.empty();
  }
};
var FlatTagView = class extends import_obsidian.ItemView {
  constructor(leaf, plugin) {
    super(leaf);
    this.selectedTags = /* @__PURE__ */ new Set();
    this.excludedTags = /* @__PURE__ */ new Set();
    this.allTags = /* @__PURE__ */ new Map();
    this.tagsByFile = /* @__PURE__ */ new Map();
    this.currentSort = "az";
    this.searchMode = "note";
    this.tagSearchText = "";
    this.touchTimer = null;
    this.lastInteractionWasTouch = false;
    this.renderId = 0;
    this.plugin = plugin;
    this.containerEl.addClass("flat-tag-view");
  }
  getViewType() {
    return VIEW_TYPE;
  }
  getDisplayText() {
    return "Flat Tags";
  }
  getIcon() {
    return "tag";
  }
  async onOpen() {
    this.container = this.contentEl.createDiv({ cls: "flat-tag-container" });
    this.containerEl.addEventListener("touchstart", () => {
      this.lastInteractionWasTouch = true;
    }, { passive: true });
    this.containerEl.addEventListener("pointerdown", (e) => {
      if (e.pointerType && e.pointerType !== "touch")
        this.lastInteractionWasTouch = false;
    }, { passive: true });
    this.sortContainer = this.container.createDiv({ cls: "flat-tag-sort-container" });
    const buttonSection = this.sortContainer.createDiv({ cls: "flat-tag-buttons-section" });
    this.sortAzBtn = buttonSection.createDiv({ cls: "flat-tag-sort-button", title: "Sort A-Z" });
    (0, import_obsidian.setIcon)(this.sortAzBtn, "lucide-sort-asc");
    this.sortCountBtn = buttonSection.createDiv({ cls: "flat-tag-sort-button", title: "Sort by usage" });
    (0, import_obsidian.setIcon)(this.sortCountBtn, "lucide-bar-chart-2");
    const clearButton = buttonSection.createDiv({ cls: "flat-tag-clear-button", title: "Clear tag selections" });
    (0, import_obsidian.setIcon)(clearButton, "x");
    clearButton.addEventListener("click", () => this.clearTagSelections());
    this.scopeBtn = buttonSection.createDiv({
      cls: "flat-tag-mode-button",
      text: "NOTE",
      title: "Click to cycle: Note -> Line"
    });
    this.taskBtn = buttonSection.createDiv({
      cls: "flat-tag-mode-button",
      text: "TASK-ALL",
      title: "Click to cycle: All -> Todo -> Done"
    });
    const cutoffSpacer = buttonSection.createDiv({ cls: "flat-tag-cutoff-spacer" });
    cutoffSpacer.ariaHidden = "true";
    const cutoffSection = buttonSection.createDiv({ cls: "flat-tag-cutoff-section" });
    this.cutoffToggleBtn = cutoffSection.createDiv({ cls: "flat-tag-cutoff-toggle", title: "Toggle frequency cutoff" });
    this.cutoffInput = cutoffSection.createEl("input", {
      cls: "flat-tag-cutoff-input",
      attr: { type: "number", min: "0", step: "1", inputmode: "numeric", placeholder: "0" }
    });
    this.cutoffToggleBtn.addEventListener("click", async () => {
      this.plugin.settings.frequencyCutoffEnabled = !this.plugin.settings.frequencyCutoffEnabled;
      await this.plugin.saveSettings();
      this.syncCutoffControlsFromSettings();
      this.renderTags();
    });
    this.cutoffInput.addEventListener("input", async () => {
      const parsed = parseInt(this.cutoffInput.value, 10);
      if (!isNaN(parsed) && parsed >= 0) {
        this.plugin.settings.frequencyCutoff = parsed;
        await this.plugin.saveSettings();
        this.renderTags();
      }
    });
    this.sortAzBtn.addEventListener("click", () => {
      if (this.currentSort === "az") {
        const vaultName = this.app.vault.getName();
        const count = Object.keys(this.app.metadataCache.getTags()).length;
        new import_obsidian.Notice(`'${vaultName}': ${count} unique tags`);
      } else {
        this.currentSort = "az";
        this.updateModeUI(true);
      }
    });
    this.sortCountBtn.addEventListener("click", () => {
      if (this.currentSort === "count") {
        const vaultName = this.app.vault.getName();
        const count = Object.keys(this.app.metadataCache.getTags()).length;
        new import_obsidian.Notice(`'${vaultName}': ${count} unique tags`);
      } else {
        this.currentSort = "count";
        this.updateModeUI(true);
      }
    });
    this.scopeBtn.addEventListener("click", () => this.toggleScopeMode());
    this.taskBtn.addEventListener("click", () => this.toggleTaskMode());
    const searchSection = this.sortContainer.createDiv({ cls: "flat-tag-search-section" });
    const searchBox = searchSection.createEl("input", {
      cls: "flat-tag-search-input",
      attr: { type: "text", placeholder: "Search tags..." }
    });
    const clearSearchButton = searchSection.createDiv({ cls: "flat-tag-search-clear-button", title: "Clear search" });
    (0, import_obsidian.setIcon)(clearSearchButton, "square-x");
    clearSearchButton.addEventListener("click", () => this.clearSearchBox());
    searchBox.addEventListener("input", (e) => {
      var _a;
      const target = e.target;
      this.tagSearchText = (_a = target.value) != null ? _a : "";
      this.renderTags();
    });
    this.tagContainer = this.container.createDiv({ cls: "flat-tag-list" });
    this.syncCutoffControlsFromSettings();
    this.updateModeUI(true);
    this.app.workspace.onLayoutReady(async () => {
      await this.loadTags();
    });
    this.registerEvent(this.app.metadataCache.on("changed", (file) => {
      this.updateFileTags(file);
    }));
    this.registerEvent(this.app.vault.on("delete", (file) => {
      if (file instanceof import_obsidian.TFile && file.extension === "md") {
        this.removeFileTags(file.path);
        this.renderTags();
      }
    }));
    this.registerEvent(this.app.vault.on("rename", (file, oldPath) => {
      if (file instanceof import_obsidian.TFile && file.extension === "md") {
        const tags = this.tagsByFile.get(oldPath);
        if (tags) {
          this.tagsByFile.set(file.path, tags);
          this.tagsByFile.delete(oldPath);
        }
      }
    }));
    this.registerEvent(this.app.workspace.on("flat-tag-view:settings-updated", () => {
      this.syncCutoffControlsFromSettings();
      this.renderTags();
    }));
  }
  async onClose() {
    this.contentEl.empty();
  }
  async loadTags() {
    this.allTags.clear();
    this.tagsByFile.clear();
    const files = this.app.vault.getMarkdownFiles();
    for (const file of files) {
      const fileTags = this.getFileTags(file);
      this.tagsByFile.set(file.path, fileTags);
      fileTags.forEach((tag) => this.allTags.set(tag, (this.allTags.get(tag) || 0) + 1));
    }
    this.renderTags();
  }
  updateFileTags(file) {
    const oldTagsArr = this.tagsByFile.get(file.path) || [];
    const newTagsArr = this.getFileTags(file);
    const oldSorted = [...oldTagsArr].sort().join(",");
    const newSorted = [...newTagsArr].sort().join(",");
    if (oldSorted === newSorted) {
      if (this.selectedTags.size > 0 && this.searchMode !== "note") {
        const selectedArr = Array.from(this.selectedTags);
        if (selectedArr.every((t) => oldTagsArr.includes(t))) {
          this.renderTags();
        }
      }
      return;
    }
    oldTagsArr.forEach((tag) => {
      const count = (this.allTags.get(tag) || 0) - 1;
      if (count <= 0)
        this.allTags.delete(tag);
      else
        this.allTags.set(tag, count);
    });
    newTagsArr.forEach((tag) => this.allTags.set(tag, (this.allTags.get(tag) || 0) + 1));
    this.tagsByFile.set(file.path, newTagsArr);
    this.renderTags();
  }
  removeFileTags(filePath) {
    const oldTags = this.tagsByFile.get(filePath);
    if (!oldTags)
      return;
    oldTags.forEach((tag) => {
      const count = (this.allTags.get(tag) || 0) - 1;
      if (count <= 0)
        this.allTags.delete(tag);
      else
        this.allTags.set(tag, count);
    });
    this.tagsByFile.delete(filePath);
  }
  async renderTags() {
    var _a;
    this.sortAzBtn.toggleClass("is-active", this.currentSort === "az");
    this.sortCountBtn.toggleClass("is-active", this.currentSort === "count");
    const currentRenderId = ++this.renderId;
    const filteredTags = await this.getFilteredTagsAsync();
    if (currentRenderId !== this.renderId)
      return;
    this.tagContainer.empty();
    const pinned = /* @__PURE__ */ new Map();
    const normal = /* @__PURE__ */ new Map();
    const pinnedSet = new Set((_a = this.plugin.settings.pinnedTags) != null ? _a : []);
    filteredTags.forEach((count, tag) => {
      if (pinnedSet.has(tag))
        pinned.set(tag, count);
      else
        normal.set(tag, count);
    });
    if (pinned.size > 0) {
      const pinContainer = this.tagContainer.createDiv({ cls: "flat-tag-pinned-section" });
      const pinnedIcon = pinContainer.createSpan({ cls: "flat-tag-letter" });
      (0, import_obsidian.setIcon)(pinnedIcon, "pin");
      Array.from(pinned.entries()).sort((a, b) => a[0].localeCompare(b[0], "pl")).forEach(([tag, count]) => this.createTagElement(tag, count, pinContainer));
      this.tagContainer.createDiv({ cls: "flat-tag-separator" });
    }
    let sortedTags = Array.from(normal.entries());
    if (this.currentSort === "az") {
      const collator = new Intl.Collator("pl", { numeric: true, sensitivity: "base" });
      sortedTags.sort((a, b) => {
        const charA = Array.from(a[0])[0] || "";
        const charB = Array.from(b[0])[0] || "";
        const isLetterA = /^\p{L}$/u.test(charA);
        const isLetterB = /^\p{L}$/u.test(charB);
        if (!isLetterA && isLetterB)
          return -1;
        if (isLetterA && !isLetterB)
          return 1;
        return collator.compare(a[0], b[0]);
      });
      let currentHeader = "";
      for (const [tag, count] of sortedTags) {
        const firstChar = (Array.from(tag)[0] || "").toUpperCase();
        const isLetter = /^\p{L}$/u.test(firstChar);
        const headerToUse = isLetter ? firstChar : "OTHER";
        if (headerToUse !== currentHeader) {
          currentHeader = headerToUse;
          if (currentHeader !== "OTHER") {
            const letterEl = this.tagContainer.createSpan({ cls: "flat-tag-letter" });
            letterEl.setText(currentHeader);
          }
        }
        this.createTagElement(tag, count, this.tagContainer);
      }
    } else {
      sortedTags.sort((a, b) => {
        if (b[1] !== a[1])
          return b[1] - a[1];
        return a[0].localeCompare(b[0], "pl");
      });
      sortedTags.forEach(([tag, count]) => this.createTagElement(tag, count, this.tagContainer));
    }
  }
  createTagElement(tag, count, parentEl) {
    var _a;
    const tagEl = parentEl.createSpan({ cls: "flat-tag" });
    if (this.selectedTags.has(tag))
      tagEl.addClass("flat-tag-selected");
    else if (this.excludedTags.has(tag))
      tagEl.addClass("flat-tag-excluded");
    if (((_a = this.plugin.settings.pinnedTags) != null ? _a : []).includes(tag))
      tagEl.addClass("flat-tag-pinned");
    tagEl.setText(`#${tag} (${count})`);
    tagEl.style.userSelect = "none";
    tagEl.style.webkitUserSelect = "none";
    const handleTagInteraction = async (isMultiSelect, isExclude, isPin) => {
      var _a2;
      if (isPin) {
        const list = (_a2 = this.plugin.settings.pinnedTags) != null ? _a2 : [];
        this.plugin.settings.pinnedTags = list.includes(tag) ? list.filter((t) => t !== tag) : [...list, tag];
        await this.plugin.saveSettings();
        this.renderTags();
        return;
      }
      if (isExclude) {
        if (this.excludedTags.has(tag))
          this.excludedTags.delete(tag);
        else {
          this.excludedTags.add(tag);
          this.selectedTags.delete(tag);
        }
      } else if (isMultiSelect) {
        if (this.selectedTags.has(tag))
          this.selectedTags.delete(tag);
        else {
          this.selectedTags.add(tag);
          this.excludedTags.delete(tag);
        }
      } else {
        if (this.selectedTags.size === 1 && this.selectedTags.has(tag))
          this.selectedTags.clear();
        else {
          this.selectedTags.clear();
          this.excludedTags.clear();
          this.selectedTags.add(tag);
        }
      }
      if (this.selectedTags.has(tag)) {
        tagEl.addClass("flat-tag-selected");
        tagEl.removeClass("flat-tag-excluded");
      } else if (this.excludedTags.has(tag)) {
        tagEl.addClass("flat-tag-excluded");
        tagEl.removeClass("flat-tag-selected");
      } else {
        tagEl.removeClass("flat-tag-selected");
        tagEl.removeClass("flat-tag-excluded");
      }
      this.renderTags();
      void this.updateSearch();
    };
    let touchHandled = false;
    let touchStartX = 0;
    let touchStartY = 0;
    let isSwiping = false;
    let longPressTriggered = false;
    tagEl.addEventListener("click", (e) => {
      if (touchHandled) {
        touchHandled = false;
        return;
      }
      e.preventDefault();
      void handleTagInteraction(!!(e.ctrlKey || e.metaKey), !!e.shiftKey, !!e.altKey);
    });
    tagEl.addEventListener("contextmenu", (e) => {
      if (import_obsidian.Platform.isMobile) {
        e.preventDefault();
        return;
      }
      e.preventDefault();
      const menu = new import_obsidian.Menu();
      const isMuted = tag.startsWith("%");
      const actionName = isMuted ? "Global Un-Mute" : "Global Mute";
      const targetTag = isMuted ? tag.slice(1) : `%${tag}`;
      menu.addItem((item) => {
        item.setTitle(`${actionName} to #${targetTag}`).setIcon("alert-triangle").onClick(() => {
          new GlobalMuteConfirmModal(this.app, tag, async () => {
            await this.executeGlobalMute(tag);
          }).open();
        });
      });
      menu.showAtMouseEvent(e);
    });
    tagEl.addEventListener("touchstart", (e) => {
      const touch = e.touches[0];
      touchStartX = touch.clientX;
      touchStartY = touch.clientY;
      isSwiping = false;
      longPressTriggered = false;
      touchHandled = false;
      if (this.touchTimer)
        window.clearTimeout(this.touchTimer);
      this.touchTimer = window.setTimeout(() => {
        this.touchTimer = null;
        if (!isSwiping) {
          longPressTriggered = true;
          touchHandled = true;
          void handleTagInteraction(true, false, false);
        }
      }, 500);
    }, { passive: true });
    tagEl.addEventListener("touchmove", (e) => {
      const touch = e.touches[0];
      const dx = touch.clientX - touchStartX;
      const dy = touch.clientY - touchStartY;
      if (!isSwiping) {
        if (Math.abs(dx) > 10 && Math.abs(dx) > Math.abs(dy)) {
          if (this.touchTimer) {
            window.clearTimeout(this.touchTimer);
            this.touchTimer = null;
          }
          isSwiping = true;
        } else if (Math.abs(dy) > 10) {
          if (this.touchTimer) {
            window.clearTimeout(this.touchTimer);
            this.touchTimer = null;
          }
          return;
        }
      }
      if (isSwiping && dx < 0) {
        e.preventDefault();
        const capped = Math.max(dx, -90);
        tagEl.style.transform = `translateX(${capped}px)`;
        tagEl.style.opacity = String(0.5 + Math.abs(capped) / 90 * 0.5);
      }
    }, { passive: false });
    tagEl.addEventListener("touchend", (e) => {
      const touch = e.changedTouches[0];
      const dx = touch.clientX - touchStartX;
      tagEl.style.transition = "transform 0.2s ease, opacity 0.2s ease";
      tagEl.style.transform = "";
      tagEl.style.opacity = "";
      setTimeout(() => {
        tagEl.style.transition = "";
      }, 220);
      if (isSwiping) {
        isSwiping = false;
        touchHandled = true;
        if (dx <= -60)
          void handleTagInteraction(false, false, true);
        return;
      }
      if (longPressTriggered) {
        longPressTriggered = false;
        return;
      }
      if (this.touchTimer) {
        window.clearTimeout(this.touchTimer);
        this.touchTimer = null;
      }
    }, { passive: true });
    tagEl.addEventListener("touchcancel", () => {
      isSwiping = false;
      longPressTriggered = false;
      touchHandled = false;
      if (this.touchTimer) {
        window.clearTimeout(this.touchTimer);
        this.touchTimer = null;
      }
      tagEl.style.transition = "transform 0.2s ease, opacity 0.2s ease";
      tagEl.style.transform = "";
      tagEl.style.opacity = "";
      setTimeout(() => {
        tagEl.style.transition = "";
      }, 220);
    }, { passive: true });
  }
  // ── Execute Global Mute logic ───────────────────────────────────────────
  async executeGlobalMute(tag) {
    const isCurrentlyMuted = tag.startsWith("%");
    const targetTagWord = isCurrentlyMuted ? tag.slice(1) : `%${tag}`;
    const escapedTag = tag.replace(/[.*+?^${}()|[\]\\]/g, "\\$&");
    const tagRegex = new RegExp(`#${escapedTag}(?![\\p{L}\\p{N}_\\-%])`, "gu");
    let filesModified = 0;
    const filesToProcess = [];
    this.tagsByFile.forEach((tagsArr, filePath) => {
      if (tagsArr.includes(tag)) {
        filesToProcess.push(filePath);
      }
    });
    new import_obsidian.Notice(`Globally replacing #${tag}...`);
    for (const filePath of filesToProcess) {
      const file = this.app.vault.getAbstractFileByPath(filePath);
      if (file instanceof import_obsidian.TFile) {
        await this.app.vault.process(file, (data) => {
          const newData = data.replace(tagRegex, `#${targetTagWord}`);
          if (data !== newData)
            filesModified++;
          return newData;
        });
      }
    }
    new import_obsidian.Notice(`Success: Replaced #${tag} with #${targetTagWord} in ${filesModified} file(s).`);
    this.selectedTags.delete(tag);
    this.excludedTags.delete(tag);
    this.renderTags();
    void this.updateSearch();
  }
  // ─────────────────────────────────────────────────────────────────────────────
  async getFilteredTagsAsync() {
    var _a, _b, _c;
    let filtered = /* @__PURE__ */ new Map();
    if (this.selectedTags.size === 0) {
      filtered = new Map(this.allTags);
    } else {
      const selectedArr = Array.from(this.selectedTags);
      const matchingFiles = [];
      this.tagsByFile.forEach((tagsArr, filePath) => {
        if (selectedArr.every((t) => tagsArr.includes(t)))
          matchingFiles.push(filePath);
      });
      if (this.searchMode === "note") {
        for (const filePath of matchingFiles) {
          const tags = this.tagsByFile.get(filePath);
          if (!tags)
            continue;
          for (const t of tags)
            filtered.set(t, (filtered.get(t) || 0) + 1);
        }
      } else {
        for (const filePath of matchingFiles) {
          const file = this.app.vault.getAbstractFileByPath(filePath);
          if (!(file instanceof import_obsidian.TFile))
            continue;
          const content = await this.app.vault.cachedRead(file);
          const lines = content.split(/\r?\n/);
          for (const line of lines) {
            const lower = line.toLowerCase();
            if (this.searchMode === "task" && !lower.includes("- ["))
              continue;
            if (this.searchMode === "task-todo" && !lower.includes("- [ ]"))
              continue;
            if (this.searchMode === "task-done" && !lower.includes("- [x"))
              continue;
            const lineTags = /* @__PURE__ */ new Set();
            const tagRegex = /#(?!%)([^\s#]+)/g;
            let m;
            while ((m = tagRegex.exec(lower)) !== null)
              lineTags.add(m[1]);
            const hasAll = selectedArr.every(
              (sel) => Array.from(lineTags).some((t) => t.toLowerCase() === sel.toLowerCase())
            );
            if (!hasAll)
              continue;
            for (const t of lineTags)
              filtered.set(t, (filtered.get(t) || 0) + 1);
          }
        }
      }
    }
    for (const t of this.selectedTags)
      if (!filtered.has(t))
        filtered.set(t, this.allTags.get(t) || 0);
    for (const t of this.excludedTags)
      if (!filtered.has(t))
        filtered.set(t, this.allTags.get(t) || 0);
    const cutoffEnabled = (_a = this.plugin.settings.frequencyCutoffEnabled) != null ? _a : false;
    const cutoff = cutoffEnabled ? (_b = this.plugin.settings.frequencyCutoff) != null ? _b : 0 : 0;
    const pinned = new Set((_c = this.plugin.settings.pinnedTags) != null ? _c : []);
    if (cutoff > 0) {
      const next = /* @__PURE__ */ new Map();
      filtered.forEach((count, tag) => {
        if (count >= cutoff || this.selectedTags.has(tag) || pinned.has(tag))
          next.set(tag, count);
      });
      filtered = next;
    }
    if (this.tagSearchText) {
      const q = this.tagSearchText.toLowerCase();
      const next = /* @__PURE__ */ new Map();
      filtered.forEach((count, tag) => {
        if (tag.toLowerCase().includes(q) || this.selectedTags.has(tag) || this.excludedTags.has(tag))
          next.set(tag, count);
      });
      filtered = next;
    }
    return filtered;
  }
  async updateSearch(options) {
    var _a, _b, _c;
    const workspace = this.app.workspace;
    const prevLeaf = workspace.activeLeaf;
    const isTouchContext = import_obsidian.Platform.isMobile || this.lastInteractionWasTouch;
    const revealSearch = (_a = options == null ? void 0 : options.revealSearch) != null ? _a : !isTouchContext;
    const createIfMissing = (_b = options == null ? void 0 : options.createIfMissing) != null ? _b : !isTouchContext;
    let searchLeaf = workspace.getLeavesOfType("search")[0];
    if (!searchLeaf && createIfMissing) {
      const rightLeaf = workspace.getRightLeaf(true);
      if (rightLeaf) {
        searchLeaf = rightLeaf;
        await searchLeaf.setViewState({ type: "search", active: false });
      }
    }
    if (searchLeaf && revealSearch)
      workspace.revealLeaf(searchLeaf);
    if (prevLeaf)
      workspace.setActiveLeaf(prevLeaf, { focus: true });
    this.lastInteractionWasTouch = false;
    if (!searchLeaf)
      return;
    const selected = Array.from(this.selectedTags);
    const excluded = Array.from(this.excludedTags);
    const searchView = searchLeaf.view;
    if (selected.length === 0 && excluded.length === 0) {
      const clearBtn = (_c = searchView == null ? void 0 : searchView.containerEl) == null ? void 0 : _c.querySelector(".search-input-clear-button");
      if (clearBtn)
        clearBtn.dispatchEvent(new MouseEvent("click", { bubbles: true, cancelable: false }));
      else if (typeof (searchView == null ? void 0 : searchView.setQuery) === "function")
        searchView.setQuery("");
      return;
    }
    let query = "";
    if (this.searchMode === "note") {
      query = [
        ...selected.map((t) => `tag:#${t}`),
        ...excluded.map((t) => `-tag:#${t}`)
      ].join(" ");
    } else {
      const prefix = this.searchMode === "line" ? "line:(" : this.searchMode === "task" ? "task:(" : this.searchMode === "task-todo" ? "task-todo:(" : "task-done:(";
      const body = [
        ...selected.map((t) => `#${t}`),
        ...excluded.map((t) => `-#${t}`)
      ].join(" ");
      query = `${prefix}${body})`;
    }
    if (typeof (searchView == null ? void 0 : searchView.setQuery) === "function") {
      searchView.setQuery(query);
      setTimeout(() => searchView.setQuery(query), 150);
    }
  }
  getFileTags(file) {
    var _a;
    const cache = this.app.metadataCache.getFileCache(file);
    if (!cache)
      return [];
    const tags = [];
    if (cache.tags)
      cache.tags.forEach((t) => tags.push(t.tag.replace(/^#/, "")));
    const fm = (_a = cache.frontmatter) == null ? void 0 : _a.tags;
    if (typeof fm === "string") {
      fm.split(",").map((s) => s.trim()).filter(Boolean).forEach((t) => tags.push(t.replace(/^#/, "")));
    } else if (Array.isArray(fm)) {
      fm.forEach((t) => {
        if (t)
          tags.push(String(t).replace(/^#/, ""));
      });
    }
    return Array.from(new Set(tags));
  }
  syncCutoffControlsFromSettings() {
    var _a, _b;
    const enabled = (_a = this.plugin.settings.frequencyCutoffEnabled) != null ? _a : false;
    const cutoff = (_b = this.plugin.settings.frequencyCutoff) != null ? _b : 0;
    this.cutoffInput.value = String(cutoff);
    this.cutoffInput.disabled = !enabled;
    this.cutoffToggleBtn.toggleClass("is-enabled", enabled);
    this.cutoffToggleBtn.toggleClass("is-disabled", !enabled);
    (0, import_obsidian.setIcon)(this.cutoffToggleBtn, enabled ? "eye" : "eye-off");
  }
  updateModeUI(skipSearch = false) {
    this.sortAzBtn.toggleClass("is-active", this.currentSort === "az");
    this.sortCountBtn.toggleClass("is-active", this.currentSort === "count");
    this.scopeBtn.removeClass("is-active");
    this.taskBtn.removeClass("is-active");
    if (this.searchMode === "note") {
      this.scopeBtn.setText("NOTE");
      this.scopeBtn.addClass("is-active");
    } else if (this.searchMode === "line") {
      this.scopeBtn.setText("LINE");
      this.scopeBtn.addClass("is-active");
    } else if (this.searchMode === "task") {
      this.taskBtn.setText("TASK-ALL");
      this.taskBtn.addClass("is-active");
    } else if (this.searchMode === "task-todo") {
      this.taskBtn.setText("TASK-TODO");
      this.taskBtn.addClass("is-active");
    } else if (this.searchMode === "task-done") {
      this.taskBtn.setText("TASK-DONE");
      this.taskBtn.addClass("is-active");
    }
    if (["note", "line"].includes(this.searchMode)) {
      if (!["TASK-ALL", "TASK-TODO", "TASK-DONE"].includes(this.taskBtn.innerText))
        this.taskBtn.setText("TASK-ALL");
    } else {
      if (!["NOTE", "LINE"].includes(this.scopeBtn.innerText))
        this.scopeBtn.setText("NOTE");
    }
    if (!skipSearch)
      void this.updateSearch();
    if (this.tagContainer)
      this.renderTags();
  }
  toggleScopeMode() {
    if (["note", "line"].includes(this.searchMode))
      this.searchMode = this.searchMode === "note" ? "line" : "note";
    else
      this.searchMode = this.scopeBtn.innerText === "LINE" ? "line" : "note";
    this.updateModeUI();
  }
  toggleTaskMode() {
    var _a, _b;
    if (this.searchMode === "task")
      this.searchMode = "task-todo";
    else if (this.searchMode === "task-todo")
      this.searchMode = "task-done";
    else if (this.searchMode === "task-done")
      this.searchMode = "task";
    else {
      const label = (_b = (_a = this.taskBtn) == null ? void 0 : _a.innerText) != null ? _b : "TASK-ALL";
      this.searchMode = label === "TASK-TODO" ? "task-todo" : label === "TASK-DONE" ? "task-done" : "task";
    }
    this.updateModeUI();
  }
  toggleSort() {
    this.currentSort = this.currentSort === "az" ? "count" : "az";
    this.updateModeUI(true);
  }
  clearTagSelections() {
    this.selectedTags.clear();
    this.excludedTags.clear();
    this.renderTags();
    void this.updateSearch({ revealSearch: false, createIfMissing: false });
  }
  clearSearchBox() {
    const searchBox = this.contentEl.querySelector(".flat-tag-search-input");
    if (searchBox)
      searchBox.value = "";
    this.tagSearchText = "";
    this.renderTags();
  }
  selectSingleTag(tag) {
    this.selectedTags.clear();
    this.excludedTags.clear();
    const cleanTag = tag.replace(/^#/, "");
    this.selectedTags.add(cleanTag);
    this.renderTags();
    void this.updateSearch({ revealSearch: true, createIfMissing: true });
  }
};

// styles.ts
var getStyles = () => {
  return `
.workspace-split.mod-root .view-content.flat-tag-view {
	display: flex;
	flex-direction: column;
	justify-content: flex-start;
	align-items: stretch;
	height: 100%;
	padding: 0;
	margin: 0;
}

.flat-tag-container {
	display: flex;
	flex-direction: column;
	align-items: flex-start;
	justify-content: flex-start;
	width: 100%;
	height: 100%;
	box-sizing: border-box;
	padding: 0;
	margin: 0;
}

.flat-tag-sort-container {
	display: flex;
	justify-content: space-between;
	align-items: center;
	flex-shrink: 0;
	padding: 8px;
	background-color: var(--background-primary);
	border-bottom: 1px solid var(--background-modifier-border);
	width: 100%;
	flex-wrap: wrap;
	gap: 8px;
}

.flat-tag-buttons-section {
	display: flex;
	gap: 6px;
	align-items: center;
	flex-wrap: wrap;
}

.flat-tag-mode-button {
	cursor: pointer;
	padding: 4px 10px;
	font-size: 0.8em;
	font-weight: 500;
	border-radius: var(--radius-s);
	color: var(--text-muted);
	background-color: var(--background-modifier-form-field);
	border: 1px solid var(--background-modifier-border);
	transition: all 0.15s ease-in-out;
	user-select: none;
	display: flex;
	align-items: center;
	justify-content: center;
	min-width: 65px;
}

.flat-tag-mode-button:hover {
	color: var(--text-normal);
	background-color: var(--background-modifier-hover);
	border-color: var(--background-modifier-border-hover);
}

.flat-tag-mode-button.is-active {
	background-color: var(--interactive-accent);
	color: var(--text-on-accent);
	border-color: var(--interactive-accent);
	box-shadow: inset 0 1px 3px rgba(0, 0, 0, 0.2);
}

.flat-tag-mode-button.is-active:hover {
	background-color: var(--interactive-accent-hover);
	border-color: var(--interactive-accent-hover);
}

.flat-tag-search-section {
	display: flex;
	align-items: center;
	gap: 4px;
	margin-left: auto;
	background-color: var(--background-secondary);
	border-radius: 4px;
	padding: 2px 8px;
	flex-grow: 1;
	max-width: 220px;
}

.flat-tag-search-input {
	background: transparent;
	border: none;
	color: var(--text-normal);
	width: 100%;
	height: 24px;
	font-size: 0.9em;
}

.flat-tag-search-input:focus {
	outline: none;
	box-shadow: none;
}

.flat-tag-search-clear-button {
	cursor: pointer;
	color: var(--text-muted);
	display: flex;
	align-items: center;
	justify-content: center;
	font-size: 0.8em;
}

.flat-tag-search-clear-button:hover {
	color: var(--text-normal);
}

.flat-tag-sort-button,
.flat-tag-clear-button {
	cursor: pointer;
	padding: 4px;
	border-radius: 4px;
	display: flex;
	align-items: center;
	justify-content: center;
}

.flat-tag-sort-button:hover,
.flat-tag-clear-button:hover {
	background-color: var(--interactive-hover);
}

.flat-tag-sort-button.is-active {
	background-color: var(--interactive-accent);
	color: var(--text-on-accent);
	box-shadow: inset 0 1px 3px rgba(0, 0, 0, 0.2);
}

.flat-tag-sort-button.is-active:hover {
	background-color: var(--interactive-accent-hover);
}

/* Cutoff controls */
.flat-tag-cutoff-spacer {
	flex: 0 0 8px;
	width: 8px;
	height: 1px;
}

.flat-tag-cutoff-section {
	display: flex;
	align-items: center;
	gap: 6px;
	padding: 2px 8px;
	border-radius: var(--radius-s);
	border: 1px solid var(--background-modifier-border);
	background: linear-gradient(180deg, var(--background-secondary) 0%, var(--background-primary) 100%);
	box-shadow: inset 0 1px 0 rgba(255, 255, 255, 0.04);
	height: 28px;
}

.flat-tag-cutoff-toggle {
	cursor: pointer;
	display: inline-flex;
	align-items: center;
	justify-content: center;
	color: var(--text-muted);
	padding: 2px;
	border-radius: var(--radius-s);
}

.flat-tag-cutoff-toggle:hover {
	color: var(--text-normal);
	background-color: var(--background-modifier-hover);
}

.flat-tag-cutoff-toggle.is-enabled {
	color: var(--interactive-accent);
}

.flat-tag-cutoff-toggle.is-disabled {
	opacity: 0.7;
}

.flat-tag-cutoff-input {
	width: 52px;
	height: 22px;
	border: none;
	background: transparent;
	padding: 0;
	margin: 0;
	text-align: center;
	font-size: 0.9em;
	color: var(--text-normal);
}

.flat-tag-cutoff-input:focus {
	outline: none;
	box-shadow: none;
}

.flat-tag-cutoff-input:disabled {
	color: var(--text-faint);
	cursor: not-allowed;
}

.flat-tag-list {
	display: flex;
	flex-wrap: wrap;
	align-content: flex-start;
	overflow-y: auto;
	flex: 1;
	line-height: 1.5em;
	padding: 8px;
	width: 100%;
}

.flat-tag {
	display: inline-block;
	padding: 2px 6px;
	margin: 2px;
	border-radius: 4px;
	cursor: pointer;
	background-color: var(--tag-background);
	color: var(--tag-color);
	transition: background-color 0.1s;
}

.flat-tag:hover {
	background-color: var(--tag-background-hover);
}

.flat-tag-selected {
	font-weight: bold;
	background-color: var(--interactive-accent);
	color: var(--text-on-accent);
}

.flat-tag-excluded {
	font-weight: bold;
	background-color: var(--color-red);
	color: var(--text-on-accent);
}

.flat-tag-letter {
	display: inline-flex;
	font-weight: bold;
	font-size: 1.2em;
	margin: 2px;
	padding: 2px 6px;
	border-radius: 4px;
	background-color: var(--background-secondary);
	color: var(--text-normal);
	align-items: center;
	justify-content: center;
	min-width: 24px;
}

.flat-tag-pinned-section {
	position: sticky;
  	top: 0;
  	z-index: 5;
	width: 100%;
	display: flex;
	flex-wrap: wrap;
	align-items: center;
	background-color: color-mix(in srgb, var(--interactive-accent) 10%, var(--background-primary));
	border: 1px solid color-mix(in srgb, var(--interactive-accent) 25%, transparent);
	padding: 4px;
	border-radius: var(--radius-s);
	margin-bottom: 4px;
}

.flat-tag-separator {
	width: 100%;
	height: 1px;
	background-color: var(--background-modifier-border);
	margin: 4px 0 8px 0;
}

.flat-tag-pinned {
	border: 1px solid var(--interactive-accent);
}


/* Glow reminder when list is filtered:
   input is not focused and not empty (placeholder not shown). */
.flat-tag-search-input:not(:focus):not(:placeholder-shown) {
  border-color: var(--interactive-accent);
  box-shadow:
    0 0 0 2px color-mix(in srgb, var(--interactive-accent) 35%, transparent),
    0 0 14px color-mix(in srgb, var(--interactive-accent) 25%, transparent);
  animation: ftv-search-pulse 2.2s ease-in-out infinite;
}

@keyframes ftv-search-pulse {
  0%, 100% {
    box-shadow:
      0 0 0 2px color-mix(in srgb, var(--interactive-accent) 28%, transparent),
      0 0 10px color-mix(in srgb, var(--interactive-accent) 18%, transparent);
  }
  50% {
    box-shadow:
      0 0 0 2px color-mix(in srgb, var(--interactive-accent) 45%, transparent),
      0 0 18px color-mix(in srgb, var(--interactive-accent) 35%, transparent);
  }
}

/* Theme tuning */
body.theme-light .flat-tag-search-input:not(:focus):not(:placeholder-shown) {
  animation-duration: 2.6s;
}

body.theme-dark .flat-tag-search-input:not(:focus):not(:placeholder-shown) {
  animation-duration: 2.0s;
}

/* Respect reduced motion */
@media (prefers-reduced-motion: reduce) {
  .flat-tag-search-input:not(:focus):not(:placeholder-shown) {
    animation: none;
  }
}

`;
};

// settings.ts
var import_obsidian2 = require("obsidian");
var DEFAULT_SETTINGS = {
  pinnedTags: [],
  frequencyCutoff: 0,
  frequencyCutoffEnabled: false,
  altClickTagMode: "start-line",
  showPlacementInStatusBar: true,
  mobileLongPressEnabled: true,
  mobileLongPressMs: 1e3
};
var FlatTagSettingTab = class extends import_obsidian2.PluginSettingTab {
  constructor(app, plugin) {
    super(app, plugin);
    this.plugin = plugin;
  }
  display() {
    const { containerEl } = this;
    containerEl.empty();
    new import_obsidian2.Setting(containerEl).setName("Alt-click tag placement").setDesc("When creating a tag, where it should go.").addDropdown(
      (dd) => dd.addOption("start-line", "Put tag at start of line").addOption("in-place", "Turn word into tag in place").addOption("end-line", "Put tag at end of line").setValue(this.plugin.settings.altClickTagMode).onChange(async (value) => {
        this.plugin.settings.altClickTagMode = value;
        await this.plugin.saveSettings();
      })
    );
    new import_obsidian2.Setting(containerEl).setName("Show placement of newly created tags in status bar").setDesc("Displays SOL / INP / EOL in the Obsidian status bar.").addToggle(
      (t) => t.setValue(this.plugin.settings.showPlacementInStatusBar).onChange(async (val) => {
        this.plugin.settings.showPlacementInStatusBar = val;
        await this.plugin.saveSettings();
      })
    );
    new import_obsidian2.Setting(containerEl).setName("Frequency cutoff").setDesc("Hide tags that appear fewer times than this number in the vault.").addToggle(
      (toggle) => toggle.setValue(this.plugin.settings.frequencyCutoffEnabled).onChange(async (value) => {
        this.plugin.settings.frequencyCutoffEnabled = value;
        await this.plugin.saveSettings();
      })
    ).addText(
      (text) => text.setPlaceholder("0").setValue(this.plugin.settings.frequencyCutoff.toString()).onChange(async (value) => {
        const parsed = parseInt(value, 10);
        if (!isNaN(parsed) && parsed >= 0) {
          this.plugin.settings.frequencyCutoff = parsed;
          await this.plugin.saveSettings();
        }
      })
    );
    new import_obsidian2.Setting(containerEl).setName("Clear pinned tags").setDesc("Removes all pinned tags from the top of the flat tag list.").addButton(
      (btn) => btn.setButtonText("Clear pinned").onClick(async () => {
        this.plugin.settings.pinnedTags = [];
        await this.plugin.saveSettings();
      })
    );
  }
};

// main.ts
var FlatTagPlugin = class extends import_obsidian3.Plugin {
  constructor() {
    super(...arguments);
    this.statusBarEl = null;
  }
  async onload() {
    await this.loadSettings();
    this.registerView(VIEW_TYPE, (leaf) => new FlatTagView(leaf, this));
    this.addRibbonIcon("tag", "Open Flat Tags", () => void this.activateView());
    this.addSettingTab(new FlatTagSettingTab(this.app, this));
    this.addCommand({
      id: "open-flat-tags",
      name: "Open Flat Tags",
      callback: () => void this.activateView()
    });
    this.addCommand({
      id: "toggle-flat-tag-sort",
      name: "Toggle Flat Tag Sort (A-Z/Usage)",
      callback: () => {
        var _a;
        const view = (_a = this.app.workspace.getLeavesOfType(VIEW_TYPE)[0]) == null ? void 0 : _a.view;
        if (view && typeof view.toggleSort === "function")
          view.toggleSort();
      }
    });
    this.addCommand({
      id: "clear-flat-tag-selections",
      name: "Clear Flat Tag Selections",
      callback: () => {
        var _a;
        const view = (_a = this.app.workspace.getLeavesOfType(VIEW_TYPE)[0]) == null ? void 0 : _a.view;
        if (view && typeof view.clearTagSelections === "function")
          view.clearTagSelections();
      }
    });
    this.addCommand({
      id: "toggle-flat-tag-frequency-cutoff",
      name: "Toggle Frequency Cutoff",
      callback: async () => {
        this.settings.frequencyCutoffEnabled = !this.settings.frequencyCutoffEnabled;
        await this.saveSettings();
      }
    });
    this.addCommand({
      id: "clear-flat-tag-search",
      name: "Clear Flat Tag Search Box",
      callback: () => {
        var _a;
        const view = (_a = this.app.workspace.getLeavesOfType(VIEW_TYPE)[0]) == null ? void 0 : _a.view;
        if (view && typeof view.clearSearchBox === "function")
          view.clearSearchBox();
      }
    });
    this.addCommand({
      id: "toggle-flat-tag-scope-mode",
      name: "Toggle Flat Tag Mode (Note/Line)",
      callback: () => {
        var _a;
        const view = (_a = this.app.workspace.getLeavesOfType(VIEW_TYPE)[0]) == null ? void 0 : _a.view;
        if (view && typeof view.toggleScopeMode === "function")
          view.toggleScopeMode();
      }
    });
    this.addCommand({
      id: "toggle-flat-tag-task-mode",
      name: "Cycle Flat Tag Task Mode (All/Todo/Done)",
      callback: () => {
        var _a;
        const view = (_a = this.app.workspace.getLeavesOfType(VIEW_TYPE)[0]) == null ? void 0 : _a.view;
        if (view && typeof view.toggleTaskMode === "function")
          view.toggleTaskMode();
      }
    });
    this.addCommand({
      id: "cycle-flat-tag-placement",
      name: "Cycle Tag Placement (SOL / INP / EOL)",
      callback: () => void this.cycleTagPlacement()
    });
    this.addCommand({
      id: "set-flat-tag-placement-sol",
      name: "Set Tag Placement to Start of Line (SOL)",
      callback: async () => {
        this.settings.altClickTagMode = "start-line";
        await this.saveSettings();
        new import_obsidian3.Notice("Tag placement: Start of line");
      }
    });
    this.addCommand({
      id: "set-flat-tag-placement-inp",
      name: "Set Tag Placement to In Place (INP)",
      callback: async () => {
        this.settings.altClickTagMode = "in-place";
        await this.saveSettings();
        new import_obsidian3.Notice("Tag placement: In place");
      }
    });
    this.addCommand({
      id: "set-flat-tag-placement-eol",
      name: "Set Tag Placement to End of Line (EOL)",
      callback: async () => {
        this.settings.altClickTagMode = "end-line";
        await this.saveSettings();
        new import_obsidian3.Notice("Tag placement: End of line");
      }
    });
    this.addStyle();
    this.statusBarEl = this.addStatusBarItem();
    this.updateStatusBar();
    this.statusBarEl.addClass("mod-clickable");
    this.statusBarEl.addEventListener("click", () => void this.cycleTagPlacement());
    this.registerDomEvent(document, "click", (evt) => {
      if (!evt.altKey)
        return;
      if (evt.shiftKey && (evt.ctrlKey || evt.metaKey)) {
        evt.preventDefault();
        evt.stopPropagation();
        void this.handleEditorTrigger({ kind: "local-mute", mouseEvent: evt });
        return;
      }
      if (evt.shiftKey && !evt.ctrlKey && !evt.metaKey) {
        evt.preventDefault();
        evt.stopPropagation();
        void this.handleEditorTrigger({ kind: "strip-hash", mouseEvent: evt });
        return;
      }
      if (!evt.shiftKey && (evt.ctrlKey || evt.metaKey)) {
        evt.preventDefault();
        evt.stopPropagation();
        void this.handleEditorTrigger({ kind: "drill-down", mouseEvent: evt });
        return;
      }
      if (!evt.shiftKey && !evt.ctrlKey && !evt.metaKey) {
        evt.preventDefault();
        void this.handleEditorTrigger({ kind: "alt-click", mouseEvent: evt });
        return;
      }
    }, { capture: true });
    this.registerMobileLongPress();
  }
  onunload() {
    this.app.workspace.detachLeavesOfType(VIEW_TYPE);
    if (this.statusBarEl) {
      this.statusBarEl.remove();
      this.statusBarEl = null;
    }
  }
  async cycleTagPlacement() {
    const modes = ["start-line", "in-place", "end-line"];
    const current = this.settings.altClickTagMode;
    const next = modes[(modes.indexOf(current) + 1) % modes.length];
    this.settings.altClickTagMode = next;
    await this.saveSettings();
    const labels = {
      "start-line": "Start of line",
      "in-place": "In place",
      "end-line": "End of line"
    };
    new import_obsidian3.Notice(`Tag placement: ${labels[next]}`);
  }
  // ── Status bar ──────────────────────────────────────────────────────────────
  updateStatusBar() {
    var _a, _b;
    if (!this.statusBarEl)
      return;
    const show = (_a = this.settings.showPlacementInStatusBar) != null ? _a : true;
    if (!show) {
      this.statusBarEl.setText("");
      this.statusBarEl.style.display = "none";
      return;
    }
    const labels = {
      "start-line": "SOL",
      "in-place": "INP",
      "end-line": "EOL"
    };
    const modeLabel = (_b = labels[this.settings.altClickTagMode]) != null ? _b : "SOL";
    this.statusBarEl.setText(`#>${modeLabel}`);
    this.statusBarEl.style.display = "";
  }
  // ── Mobile long press ────────────────────────────────────────────────────────
  registerMobileLongPress() {
    if (!import_obsidian3.Platform.isMobile)
      return;
    let timer = null;
    let startX = 0;
    let startY = 0;
    let cancelled = false;
    let longPressArmed = false;
    const clear = () => {
      if (timer)
        window.clearTimeout(timer);
      timer = null;
      longPressArmed = false;
    };
    this.registerDomEvent(
      document,
      "touchstart",
      (evt) => {
        var _a;
        if (!this.settings.mobileLongPressEnabled)
          return;
        if (evt.touches.length !== 1)
          return;
        cancelled = false;
        longPressArmed = false;
        const t = evt.touches[0];
        startX = t.clientX;
        startY = t.clientY;
        clear();
        const ms = Math.max(250, Math.min(5e3, (_a = this.settings.mobileLongPressMs) != null ? _a : 1e3));
        timer = window.setTimeout(() => {
          timer = null;
          if (cancelled)
            return;
          longPressArmed = true;
        }, ms);
      },
      { passive: true }
    );
    this.registerDomEvent(
      document,
      "touchmove",
      (evt) => {
        if (!timer)
          return;
        const t = evt.touches[0];
        const dx = Math.abs(t.clientX - startX);
        const dy = Math.abs(t.clientY - startY);
        if (dx > 12 || dy > 12) {
          cancelled = true;
          clear();
        }
      },
      { passive: true }
    );
    this.registerDomEvent(
      document,
      "touchend",
      () => {
        const shouldFire = longPressArmed && !cancelled;
        clear();
        if (!shouldFire)
          return;
        void this.handleEditorTrigger({ kind: "mobile-long-press" });
      },
      { passive: true }
    );
    this.registerDomEvent(
      document,
      "touchcancel",
      () => {
        cancelled = true;
        clear();
      },
      { passive: true }
    );
  }
  // ── Trigger entry-point ──────────────────────────────────────────────────────
  async handleEditorTrigger(trigger) {
    var _a;
    const view = this.app.workspace.getActiveViewOfType(import_obsidian3.MarkdownView);
    if (!view)
      return;
    const isSourceMode = view.getMode && typeof view.getMode === "function" && view.getMode() === "source";
    if (!isSourceMode) {
      if ("kind" in trigger && trigger.kind === "drill-down" && trigger.mouseEvent) {
        const target = trigger.mouseEvent.target;
        const tagEl = target == null ? void 0 : target.closest(".tag");
        const tagText = (_a = tagEl == null ? void 0 : tagEl.textContent) == null ? void 0 : _a.trim();
        if (tagText && tagText.startsWith("#") && !tagText.startsWith("#%")) {
          await this.activateView();
          setTimeout(() => {
            const ftvLeaf = this.app.workspace.getLeavesOfType(VIEW_TYPE)[0];
            if (ftvLeaf && ftvLeaf.view instanceof FlatTagView) {
              ftvLeaf.view.selectSingleTag(tagText);
            }
          }, 50);
        }
      }
      return;
    }
    const editor = view.editor;
    if (!editor)
      return;
    if (trigger.kind === "mobile-long-press") {
      const sel = editor.getSelection();
      if (!sel || !sel.trim())
        return;
    }
    const candidate = this.getCandidateWithRange(editor, { preferSelection: import_obsidian3.Platform.isMobile });
    if (!candidate)
      return;
    if (trigger.kind === "drill-down") {
      if (candidate.raw.startsWith("#") && !candidate.raw.startsWith("#%")) {
        await this.activateView();
        setTimeout(() => {
          const ftvLeaf = this.app.workspace.getLeavesOfType(VIEW_TYPE)[0];
          if (ftvLeaf && ftvLeaf.view instanceof FlatTagView) {
            ftvLeaf.view.selectSingleTag(candidate.raw);
          }
        }, 50);
      }
      return;
    }
    if (trigger.kind === "local-mute") {
      if (candidate.raw.startsWith("#") && candidate.range) {
        const currentTag = candidate.raw;
        let newTag = "";
        if (currentTag.startsWith("#%")) {
          newTag = "#" + currentTag.slice(2);
        } else {
          newTag = "#%" + currentTag.slice(1);
        }
        editor.replaceRange(newTag, candidate.range.from, candidate.range.to);
      }
      return;
    }
    if (trigger.kind === "strip-hash") {
      if (candidate.raw.startsWith("#%"))
        return;
      if (!candidate.raw.startsWith("#"))
        return;
      await this.stripHashFromTag(editor, candidate);
      return;
    }
    if (trigger.kind === "alt-click" || trigger.kind === "mobile-long-press") {
      if (candidate.raw.startsWith("#%")) {
        return;
      }
      if (candidate.raw.startsWith("#")) {
        await this.removeTag(editor, candidate);
      } else {
        await this.createTag(editor, this.settings.altClickTagMode, candidate);
      }
    }
  }
  // ── Candidate resolution ─────────────────────────────────────────────────────
  getSelectionRange(editor) {
    var _a, _b;
    const anyEditor = editor;
    const from = (_a = anyEditor.getCursor) == null ? void 0 : _a.call(anyEditor, "from");
    const to = (_b = anyEditor.getCursor) == null ? void 0 : _b.call(anyEditor, "to");
    if (!from || !to)
      return null;
    if (from.line === to.line && from.ch === to.ch)
      return null;
    if (from.line > to.line || from.line === to.line && from.ch > to.ch)
      return { from: to, to: from };
    return { from, to };
  }
  buildSelCandidate(editor, sel, r) {
    const raw = sel.trim();
    if (!raw.startsWith("#") && r.from.ch > 0) {
      const lineText = editor.getLine(r.from.line);
      if (lineText.charAt(r.from.ch - 1) === "#") {
        return {
          raw: "#" + raw,
          range: { from: { line: r.from.line, ch: r.from.ch - 1 }, to: r.to }
        };
      }
    }
    return { raw, range: r };
  }
  getCandidateWithRange(editor, opts) {
    var _a;
    const preferSelection = (_a = opts == null ? void 0 : opts.preferSelection) != null ? _a : true;
    const sel = editor.getSelection();
    const selRange = this.getSelectionRange(editor);
    if (preferSelection && sel && sel.trim() && !/[\r\n]/.test(sel) && selRange) {
      return this.buildSelCandidate(editor, sel, selRange);
    }
    const token = this.getTokenAtCursor(editor);
    if (token)
      return token;
    if (!preferSelection && sel && sel.trim() && !/[\r\n]/.test(sel) && selRange) {
      return this.buildSelCandidate(editor, sel, selRange);
    }
    return null;
  }
  getTokenAtCursor(editor) {
    var _a;
    const cursor = editor.getCursor();
    const lineText = (_a = editor.getLine(cursor.line)) != null ? _a : "";
    if (!lineText)
      return null;
    const isBodyChar = (ch) => /[^\s"'`\]\[{}()=+\\|,<.>!?:;*&^@$#]/u.test(ch);
    let i = cursor.ch;
    if (i >= lineText.length)
      i = lineText.length - 1;
    if (i < 0)
      return null;
    const cur = lineText.charAt(i);
    if (cur === "#") {
      let end = i + 1;
      while (end < lineText.length && isBodyChar(lineText.charAt(end)))
        end++;
      if (end === i + 1)
        return null;
      return {
        raw: lineText.slice(i, end),
        range: { from: { line: cursor.line, ch: i }, to: { line: cursor.line, ch: end } }
      };
    }
    if (isBodyChar(cur)) {
      return this.wordRangeAt(cursor.line, lineText, i);
    }
    if (i > 0 && isBodyChar(lineText.charAt(i - 1))) {
      return this.wordRangeAt(cursor.line, lineText, i - 1);
    }
    return null;
  }
  wordRangeAt(line, lineText, i) {
    const isBodyChar = (ch) => /[^\s"'`\]\[{}()=+\\|,<.>!?:;*&^@$#]/u.test(ch);
    let start = i;
    while (start > 0 && isBodyChar(lineText.charAt(start - 1)))
      start--;
    const hashStart = start > 0 && lineText.charAt(start - 1) === "#" ? start - 1 : start;
    let end = i + 1;
    while (end < lineText.length && isBodyChar(lineText.charAt(end)))
      end++;
    const raw = lineText.slice(hashStart, end);
    if (!raw.trim())
      return null;
    return {
      raw,
      range: { from: { line, ch: hashStart }, to: { line, ch: end } }
    };
  }
  // ── Validation ───────────────────────────────────────────────────────────────
  hasForbiddenChars(raw) {
    const s = raw.trim();
    if (!s)
      return true;
    const body = s.startsWith("#") ? s.slice(1) : s;
    if (body.includes("#"))
      return true;
    return /[!@$^&*()+= <>,.?`~]/.test(body);
  }
  normalizeCandidate(raw) {
    let t = raw.trim();
    if (!t)
      return null;
    if (this.hasForbiddenChars(t))
      return null;
    if (t.startsWith("#"))
      t = t.slice(1);
    if (!t)
      return null;
    if (/^\d+$/.test(t) || t === "%")
      return null;
    if (/\s/.test(t))
      return null;
    return t;
  }
  // ── Tag helpers ──────────────────────────────────────────────────────────────
  tagTokenForPlacement(candidate, mode) {
    const text = mode === "start-line" || mode === "end-line" ? candidate.toLowerCase() : candidate;
    return `#${text}`;
  }
  sortTags(tokens) {
    const uniq = [];
    const seen = /* @__PURE__ */ new Set();
    for (const t of tokens) {
      const key = t.replace(/^#/, "").toLowerCase();
      if (seen.has(key))
        continue;
      seen.add(key);
      uniq.push(t);
    }
    return uniq.sort((a, b) => a.toLowerCase().localeCompare(b.toLowerCase(), "pl"));
  }
  // ── Line parsing ─────────────────────────────────────────────────────────────
  parseLeadingTags(lineText) {
    var _a, _b, _c;
    const indent = ((_a = lineText.match(/^\s*/)) != null ? _a : [""])[0];
    const rest = lineText.slice(indent.length);
    const m = rest.match(/^((?:#[^\s#]+\s+)*)/);
    const tagBlock = (_b = m == null ? void 0 : m[1]) != null ? _b : "";
    const tags = (_c = tagBlock.match(/#[^\s#]+/g)) != null ? _c : [];
    const after = rest.slice(tagBlock.length);
    return { indent, tagBlock, tags, after };
  }
  splitBlockIdSuffix(lineText) {
    var _a;
    const trailingWs = ((_a = lineText.match(/\s*$/)) != null ? _a : [""])[0];
    const noTrail = lineText.slice(0, lineText.length - trailingWs.length);
    const m = noTrail.match(/(\s\^[\p{L}\p{N}_-]+)$/u);
    if (!m)
      return { core: noTrail, blockId: "", trailingWs };
    const blockWithSpace = m[1];
    const core = noTrail.slice(0, noTrail.length - blockWithSpace.length);
    const blockId = blockWithSpace.trim();
    return { core, blockId, trailingWs };
  }
  parseTrailingTags(coreText) {
    var _a;
    const m = coreText.match(/(\s+(?:#[^\s#]+\s*)+)$/);
    if (!m)
      return { before: coreText, tags: [] };
    const tagBlock = m[1];
    const tags = (_a = tagBlock.match(/#[^\s#]+/g)) != null ? _a : [];
    const before = coreText.slice(0, coreText.length - tagBlock.length);
    return { before, tags };
  }
  buildLineWithLeading(indent, tags, after) {
    const afterClean = after.replace(/^\s+/, "");
    const tagBlock = tags.join(" ");
    const body = tagBlock ? afterClean ? `${tagBlock} ${afterClean}` : tagBlock : afterClean;
    return `${indent}${body}`;
  }
  buildLineWithTrailing(before, tags, blockId, trailingWs) {
    const beforeClean = before.replace(/\s+$/, "");
    const tagBlock = tags.join(" ");
    const parts = [];
    if (beforeClean)
      parts.push(beforeClean);
    if (tagBlock)
      parts.push(tagBlock);
    if (blockId)
      parts.push(blockId);
    return `${parts.join(" ")}${trailingWs}`;
  }
  // ── Create / Remove ─────────────────────────────────────────────────────────
  async createTag(editor, mode, candidate) {
    const normalized = this.normalizeCandidate(candidate.raw);
    if (!normalized)
      return;
    const tagToken = this.tagTokenForPlacement(normalized, mode);
    if (mode === "in-place") {
      if (candidate.range)
        editor.replaceRange(tagToken, candidate.range.from, candidate.range.to);
      else
        editor.replaceSelection(tagToken);
      return;
    }
    const line = editor.getCursor().line;
    const lineText = editor.getLine(line);
    if (mode === "start-line") {
      const lead = this.parseLeadingTags(lineText);
      const next2 = this.sortTags([...lead.tags, tagToken]);
      const newLine2 = this.buildLineWithLeading(lead.indent, next2, lead.after);
      editor.replaceRange(newLine2, { line, ch: 0 }, { line, ch: lineText.length });
      return;
    }
    const split = this.splitBlockIdSuffix(lineText);
    const trail = this.parseTrailingTags(split.core);
    const next = this.sortTags([...trail.tags, tagToken]);
    const newLine = this.buildLineWithTrailing(trail.before, next, split.blockId, split.trailingWs);
    editor.replaceRange(newLine, { line, ch: 0 }, { line, ch: lineText.length });
  }
  async stripHashFromTag(editor, candidate) {
    if (!candidate.range)
      return;
    const line = candidate.range.from.line;
    if (candidate.range.to.line !== line)
      return;
    const lineText = editor.getLine(line);
    const fromCh = candidate.range.from.ch;
    const toCh = candidate.range.to.ch;
    const selected = editor.getRange(candidate.range.from, candidate.range.to);
    if (!selected || !selected.startsWith("#"))
      return;
    const beforeTag = lineText.slice(0, fromCh);
    const afterTag = lineText.slice(toCh);
    if (beforeTag.endsWith("[") && afterTag.startsWith(`](${selected})`)) {
      let expandedFrom = fromCh - 1;
      let expandedTo = toCh + 3 + selected.length;
      if (expandedTo < lineText.length && lineText.charAt(expandedTo) === " ")
        expandedTo++;
      else if (expandedFrom > 0 && lineText.charAt(expandedFrom - 1) === " ")
        expandedFrom--;
      editor.replaceRange(selected.slice(1), { line, ch: expandedFrom }, { line, ch: expandedTo });
      return;
    }
    editor.replaceRange(selected.slice(1), candidate.range.from, candidate.range.to);
  }
  async removeTag(editor, candidate) {
    var _a, _b, _c, _d, _e, _f;
    const normalized = this.normalizeCandidate(candidate.raw);
    if (!normalized)
      return;
    const key = normalized.toLowerCase();
    const cursor = editor.getCursor();
    const line = (_c = (_b = (_a = candidate.range) == null ? void 0 : _a.from) == null ? void 0 : _b.line) != null ? _c : cursor.line;
    if (candidate.range && (candidate.range.from.line !== line || candidate.range.to.line !== line))
      return;
    const lineText = editor.getLine(line);
    const ch = (_f = (_e = (_d = candidate.range) == null ? void 0 : _d.from) == null ? void 0 : _e.ch) != null ? _f : cursor.ch;
    const lead = this.parseLeadingTags(lineText);
    const split = this.splitBlockIdSuffix(lineText);
    const trail = this.parseTrailingTags(split.core);
    const leadStart = 0;
    const leadEnd = lead.indent.length + lead.tagBlock.length;
    const trailStart = trail.before.length;
    const trailEnd = split.core.length;
    const inLeading = ch >= leadStart && ch < leadEnd;
    const inTrailing = ch >= trailStart && ch < trailEnd;
    if (inLeading) {
      const leadHas = lead.tags.some((t) => t.replace(/^#/, "").toLowerCase() === key);
      if (leadHas) {
        const kept = lead.tags.filter((t) => t.replace(/^#/, "").toLowerCase() !== key);
        const newLine = this.buildLineWithLeading(lead.indent, kept, lead.after);
        editor.replaceRange(newLine, { line, ch: 0 }, { line, ch: lineText.length });
        return;
      }
    }
    if (inTrailing) {
      const trailHas = trail.tags.some((t) => t.replace(/^#/, "").toLowerCase() === key);
      if (trailHas) {
        const kept = trail.tags.filter((t) => t.replace(/^#/, "").toLowerCase() !== key);
        const newLine = this.buildLineWithTrailing(trail.before, kept, split.blockId, split.trailingWs);
        editor.replaceRange(newLine, { line, ch: 0 }, { line, ch: lineText.length });
        return;
      }
    }
    if (candidate.range) {
      const fromCh = candidate.range.from.ch;
      const toCh = candidate.range.to.ch;
      const selected = editor.getRange(candidate.range.from, candidate.range.to);
      if (selected && selected.startsWith("#")) {
        const beforeTag = lineText.slice(0, fromCh);
        const afterTag = lineText.slice(toCh);
        if (beforeTag.endsWith("[") && afterTag.startsWith(`](${selected})`)) {
          let expandedFrom = fromCh - 1;
          let expandedTo = toCh + 3 + selected.length;
          if (expandedTo < lineText.length && lineText.charAt(expandedTo) === " ") {
            expandedTo++;
          } else if (expandedFrom > 0 && lineText.charAt(expandedFrom - 1) === " ") {
            expandedFrom--;
          }
          editor.replaceRange("", { line, ch: expandedFrom }, { line, ch: expandedTo });
        } else {
          editor.replaceRange(selected.slice(1), candidate.range.from, candidate.range.to);
        }
      }
    }
  }
  // ── Settings ────────────────────────────────────────────────────────────────
  async loadSettings() {
    var _a;
    const loaded = (_a = await this.loadData()) != null ? _a : {};
    const anyLoaded = loaded;
    const mode = anyLoaded.altClickTagMode;
    this.settings = {
      pinnedTags: Array.isArray(anyLoaded.pinnedTags) ? anyLoaded.pinnedTags.filter((t) => typeof t === "string") : DEFAULT_SETTINGS.pinnedTags,
      frequencyCutoff: typeof anyLoaded.frequencyCutoff === "number" && !isNaN(anyLoaded.frequencyCutoff) ? Math.max(0, Math.floor(anyLoaded.frequencyCutoff)) : DEFAULT_SETTINGS.frequencyCutoff,
      frequencyCutoffEnabled: typeof anyLoaded.frequencyCutoffEnabled === "boolean" ? anyLoaded.frequencyCutoffEnabled : DEFAULT_SETTINGS.frequencyCutoffEnabled,
      altClickTagMode: mode === "start-line" || mode === "in-place" || mode === "end-line" ? mode : DEFAULT_SETTINGS.altClickTagMode,
      mobileLongPressEnabled: typeof anyLoaded.mobileLongPressEnabled === "boolean" ? anyLoaded.mobileLongPressEnabled : DEFAULT_SETTINGS.mobileLongPressEnabled,
      mobileLongPressMs: typeof anyLoaded.mobileLongPressMs === "number" && !isNaN(anyLoaded.mobileLongPressMs) ? Math.max(250, Math.min(5e3, Math.floor(anyLoaded.mobileLongPressMs))) : DEFAULT_SETTINGS.mobileLongPressMs,
      showPlacementInStatusBar: typeof anyLoaded.showPlacementInStatusBar === "boolean" ? anyLoaded.showPlacementInStatusBar : DEFAULT_SETTINGS.showPlacementInStatusBar
    };
    await this.saveData(this.settings);
  }
  async saveSettings() {
    await this.saveData(this.settings);
    this.app.workspace.trigger("flat-tag-view:settings-updated");
    this.updateStatusBar();
  }
  // ── View activation / style ────────────────────────────────────────────────
  async activateView() {
    const workspace = this.app.workspace;
    let leaf = workspace.getLeavesOfType(VIEW_TYPE)[0];
    if (!leaf) {
      const rightLeaf = workspace.getRightLeaf(false);
      if (!rightLeaf)
        return;
      leaf = rightLeaf;
      await leaf.setViewState({ type: VIEW_TYPE });
    }
    workspace.revealLeaf(leaf);
  }
  addStyle() {
    const styleEl = document.createElement("style");
    styleEl.innerHTML = getStyles();
    document.head.appendChild(styleEl);
  }
};
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsibWFpbi50cyIsICJjb25zdGFudHMudHMiLCAiZmxhdFRhZ1ZpZXcudHMiLCAic3R5bGVzLnRzIiwgInNldHRpbmdzLnRzIl0sCiAgInNvdXJjZXNDb250ZW50IjogWyJpbXBvcnQgeyBFZGl0b3IsIEVkaXRvclBvc2l0aW9uLCBNYXJrZG93blZpZXcsIE5vdGljZSwgUGxhdGZvcm0sIFBsdWdpbiwgV29ya3NwYWNlTGVhZiB9IGZyb20gXCJvYnNpZGlhblwiO1xuXG5pbXBvcnQgeyBWSUVXX1RZUEUgfSBmcm9tIFwiLi9jb25zdGFudHNcIjtcbmltcG9ydCB7IEZsYXRUYWdWaWV3IH0gZnJvbSBcIi4vZmxhdFRhZ1ZpZXdcIjtcbmltcG9ydCB7IGdldFN0eWxlcyB9IGZyb20gXCIuL3N0eWxlc1wiO1xuaW1wb3J0IHsgQWx0Q2xpY2tUYWdNb2RlLCBERUZBVUxUX1NFVFRJTkdTLCBGbGF0VGFnUGx1Z2luU2V0dGluZ3MsIEZsYXRUYWdTZXR0aW5nVGFiIH0gZnJvbSBcIi4vc2V0dGluZ3NcIjtcblxudHlwZSBFZGl0b3JSYW5nZSA9IHsgZnJvbTogRWRpdG9yUG9zaXRpb247IHRvOiBFZGl0b3JQb3NpdGlvbiB9O1xudHlwZSBDYW5kaWRhdGUgPSB7IHJhdzogc3RyaW5nOyByYW5nZT86IEVkaXRvclJhbmdlIH07XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIEZsYXRUYWdQbHVnaW4gZXh0ZW5kcyBQbHVnaW4ge1xuICAgIHNldHRpbmdzOiBGbGF0VGFnUGx1Z2luU2V0dGluZ3M7XG4gICAgcHJpdmF0ZSBzdGF0dXNCYXJFbDogSFRNTEVsZW1lbnQgfCBudWxsID0gbnVsbDtcblxuICAgIGFzeW5jIG9ubG9hZCgpIHtcbiAgICAgICAgYXdhaXQgdGhpcy5sb2FkU2V0dGluZ3MoKTtcblxuICAgICAgICB0aGlzLnJlZ2lzdGVyVmlldyhWSUVXX1RZUEUsIChsZWFmOiBXb3Jrc3BhY2VMZWFmKSA9PiBuZXcgRmxhdFRhZ1ZpZXcobGVhZiwgdGhpcykpO1xuICAgICAgICB0aGlzLmFkZFJpYmJvbkljb24oXCJ0YWdcIiwgXCJPcGVuIEZsYXQgVGFnc1wiLCAoKSA9PiB2b2lkIHRoaXMuYWN0aXZhdGVWaWV3KCkpO1xuICAgICAgICB0aGlzLmFkZFNldHRpbmdUYWIobmV3IEZsYXRUYWdTZXR0aW5nVGFiKHRoaXMuYXBwLCB0aGlzKSk7XG5cbiAgICAgICAgdGhpcy5hZGRDb21tYW5kKHtcbiAgICAgICAgICAgIGlkOiBcIm9wZW4tZmxhdC10YWdzXCIsXG4gICAgICAgICAgICBuYW1lOiBcIk9wZW4gRmxhdCBUYWdzXCIsXG4gICAgICAgICAgICBjYWxsYmFjazogKCkgPT4gdm9pZCB0aGlzLmFjdGl2YXRlVmlldygpLFxuICAgICAgICB9KTtcblxuICAgICAgICB0aGlzLmFkZENvbW1hbmQoe1xuICAgICAgICAgICAgaWQ6IFwidG9nZ2xlLWZsYXQtdGFnLXNvcnRcIixcbiAgICAgICAgICAgIG5hbWU6IFwiVG9nZ2xlIEZsYXQgVGFnIFNvcnQgKEEtWi9Vc2FnZSlcIixcbiAgICAgICAgICAgIGNhbGxiYWNrOiAoKSA9PiB7XG4gICAgICAgICAgICAgICAgY29uc3QgdmlldyA9IHRoaXMuYXBwLndvcmtzcGFjZS5nZXRMZWF2ZXNPZlR5cGUoVklFV19UWVBFKVswXT8udmlldyBhcyBGbGF0VGFnVmlldztcbiAgICAgICAgICAgICAgICBpZiAodmlldyAmJiB0eXBlb2Ygdmlldy50b2dnbGVTb3J0ID09PSBcImZ1bmN0aW9uXCIpIHZpZXcudG9nZ2xlU29ydCgpO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgfSk7XG5cbiAgICAgICAgdGhpcy5hZGRDb21tYW5kKHtcbiAgICAgICAgICAgIGlkOiBcImNsZWFyLWZsYXQtdGFnLXNlbGVjdGlvbnNcIixcbiAgICAgICAgICAgIG5hbWU6IFwiQ2xlYXIgRmxhdCBUYWcgU2VsZWN0aW9uc1wiLFxuICAgICAgICAgICAgY2FsbGJhY2s6ICgpID0+IHtcbiAgICAgICAgICAgICAgICBjb25zdCB2aWV3ID0gdGhpcy5hcHAud29ya3NwYWNlLmdldExlYXZlc09mVHlwZShWSUVXX1RZUEUpWzBdPy52aWV3IGFzIEZsYXRUYWdWaWV3O1xuICAgICAgICAgICAgICAgIGlmICh2aWV3ICYmIHR5cGVvZiB2aWV3LmNsZWFyVGFnU2VsZWN0aW9ucyA9PT0gXCJmdW5jdGlvblwiKSB2aWV3LmNsZWFyVGFnU2VsZWN0aW9ucygpO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgfSk7XG5cbiAgICAgICAgdGhpcy5hZGRDb21tYW5kKHtcbiAgICAgICAgICAgIGlkOiBcInRvZ2dsZS1mbGF0LXRhZy1mcmVxdWVuY3ktY3V0b2ZmXCIsXG4gICAgICAgICAgICBuYW1lOiBcIlRvZ2dsZSBGcmVxdWVuY3kgQ3V0b2ZmXCIsXG4gICAgICAgICAgICBjYWxsYmFjazogYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMuc2V0dGluZ3MuZnJlcXVlbmN5Q3V0b2ZmRW5hYmxlZCA9ICF0aGlzLnNldHRpbmdzLmZyZXF1ZW5jeUN1dG9mZkVuYWJsZWQ7XG4gICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5zYXZlU2V0dGluZ3MoKTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgIH0pO1xuXG4gICAgICAgIHRoaXMuYWRkQ29tbWFuZCh7XG4gICAgICAgICAgICBpZDogXCJjbGVhci1mbGF0LXRhZy1zZWFyY2hcIixcbiAgICAgICAgICAgIG5hbWU6IFwiQ2xlYXIgRmxhdCBUYWcgU2VhcmNoIEJveFwiLFxuICAgICAgICAgICAgY2FsbGJhY2s6ICgpID0+IHtcbiAgICAgICAgICAgICAgICBjb25zdCB2aWV3ID0gdGhpcy5hcHAud29ya3NwYWNlLmdldExlYXZlc09mVHlwZShWSUVXX1RZUEUpWzBdPy52aWV3IGFzIEZsYXRUYWdWaWV3O1xuICAgICAgICAgICAgICAgIGlmICh2aWV3ICYmIHR5cGVvZiB2aWV3LmNsZWFyU2VhcmNoQm94ID09PSBcImZ1bmN0aW9uXCIpIHZpZXcuY2xlYXJTZWFyY2hCb3goKTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgIH0pO1xuXG4gICAgICAgIHRoaXMuYWRkQ29tbWFuZCh7XG4gICAgICAgICAgICBpZDogXCJ0b2dnbGUtZmxhdC10YWctc2NvcGUtbW9kZVwiLFxuICAgICAgICAgICAgbmFtZTogXCJUb2dnbGUgRmxhdCBUYWcgTW9kZSAoTm90ZS9MaW5lKVwiLFxuICAgICAgICAgICAgY2FsbGJhY2s6ICgpID0+IHtcbiAgICAgICAgICAgICAgICBjb25zdCB2aWV3ID0gdGhpcy5hcHAud29ya3NwYWNlLmdldExlYXZlc09mVHlwZShWSUVXX1RZUEUpWzBdPy52aWV3IGFzIEZsYXRUYWdWaWV3O1xuICAgICAgICAgICAgICAgIGlmICh2aWV3ICYmIHR5cGVvZiB2aWV3LnRvZ2dsZVNjb3BlTW9kZSA9PT0gXCJmdW5jdGlvblwiKSB2aWV3LnRvZ2dsZVNjb3BlTW9kZSgpO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgfSk7XG5cbiAgICAgICAgdGhpcy5hZGRDb21tYW5kKHtcbiAgICAgICAgICAgIGlkOiBcInRvZ2dsZS1mbGF0LXRhZy10YXNrLW1vZGVcIixcbiAgICAgICAgICAgIG5hbWU6IFwiQ3ljbGUgRmxhdCBUYWcgVGFzayBNb2RlIChBbGwvVG9kby9Eb25lKVwiLFxuICAgICAgICAgICAgY2FsbGJhY2s6ICgpID0+IHtcbiAgICAgICAgICAgICAgICBjb25zdCB2aWV3ID0gdGhpcy5hcHAud29ya3NwYWNlLmdldExlYXZlc09mVHlwZShWSUVXX1RZUEUpWzBdPy52aWV3IGFzIEZsYXRUYWdWaWV3O1xuICAgICAgICAgICAgICAgIGlmICh2aWV3ICYmIHR5cGVvZiB2aWV3LnRvZ2dsZVRhc2tNb2RlID09PSBcImZ1bmN0aW9uXCIpIHZpZXcudG9nZ2xlVGFza01vZGUoKTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgIH0pO1xuXG4gICAgICAgIHRoaXMuYWRkQ29tbWFuZCh7XG4gICAgICAgICAgICBpZDogXCJjeWNsZS1mbGF0LXRhZy1wbGFjZW1lbnRcIixcbiAgICAgICAgICAgIG5hbWU6IFwiQ3ljbGUgVGFnIFBsYWNlbWVudCAoU09MIC8gSU5QIC8gRU9MKVwiLFxuICAgICAgICAgICAgY2FsbGJhY2s6ICgpID0+IHZvaWQgdGhpcy5jeWNsZVRhZ1BsYWNlbWVudCgpLFxuICAgICAgICB9KTtcblxuICAgICAgICB0aGlzLmFkZENvbW1hbmQoe1xuICAgICAgICAgICAgaWQ6IFwic2V0LWZsYXQtdGFnLXBsYWNlbWVudC1zb2xcIixcbiAgICAgICAgICAgIG5hbWU6IFwiU2V0IFRhZyBQbGFjZW1lbnQgdG8gU3RhcnQgb2YgTGluZSAoU09MKVwiLFxuICAgICAgICAgICAgY2FsbGJhY2s6IGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLnNldHRpbmdzLmFsdENsaWNrVGFnTW9kZSA9IFwic3RhcnQtbGluZVwiO1xuICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMuc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgICAgICAgICAgbmV3IE5vdGljZShcIlRhZyBwbGFjZW1lbnQ6IFN0YXJ0IG9mIGxpbmVcIik7XG4gICAgICAgICAgICB9LFxuICAgICAgICB9KTtcblxuICAgICAgICB0aGlzLmFkZENvbW1hbmQoe1xuICAgICAgICAgICAgaWQ6IFwic2V0LWZsYXQtdGFnLXBsYWNlbWVudC1pbnBcIixcbiAgICAgICAgICAgIG5hbWU6IFwiU2V0IFRhZyBQbGFjZW1lbnQgdG8gSW4gUGxhY2UgKElOUClcIixcbiAgICAgICAgICAgIGNhbGxiYWNrOiBhc3luYyAoKSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5zZXR0aW5ncy5hbHRDbGlja1RhZ01vZGUgPSBcImluLXBsYWNlXCI7XG4gICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5zYXZlU2V0dGluZ3MoKTtcbiAgICAgICAgICAgICAgICBuZXcgTm90aWNlKFwiVGFnIHBsYWNlbWVudDogSW4gcGxhY2VcIik7XG4gICAgICAgICAgICB9LFxuICAgICAgICB9KTtcblxuICAgICAgICB0aGlzLmFkZENvbW1hbmQoe1xuICAgICAgICAgICAgaWQ6IFwic2V0LWZsYXQtdGFnLXBsYWNlbWVudC1lb2xcIixcbiAgICAgICAgICAgIG5hbWU6IFwiU2V0IFRhZyBQbGFjZW1lbnQgdG8gRW5kIG9mIExpbmUgKEVPTClcIixcbiAgICAgICAgICAgIGNhbGxiYWNrOiBhc3luYyAoKSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5zZXR0aW5ncy5hbHRDbGlja1RhZ01vZGUgPSBcImVuZC1saW5lXCI7XG4gICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5zYXZlU2V0dGluZ3MoKTtcbiAgICAgICAgICAgICAgICBuZXcgTm90aWNlKFwiVGFnIHBsYWNlbWVudDogRW5kIG9mIGxpbmVcIik7XG4gICAgICAgICAgICB9LFxuICAgICAgICB9KTtcblxuXG4gICAgICAgIHRoaXMuYWRkU3R5bGUoKTtcblxuICAgICAgICAvLyBTdGF0dXMgYmFyIHBsYWNlbWVudCBpbmRpY2F0b3JcbiAgICAgICAgdGhpcy5zdGF0dXNCYXJFbCA9IHRoaXMuYWRkU3RhdHVzQmFySXRlbSgpO1xuICAgICAgICB0aGlzLnVwZGF0ZVN0YXR1c0JhcigpO1xuICAgICAgICB0aGlzLnN0YXR1c0JhckVsLmFkZENsYXNzKFwibW9kLWNsaWNrYWJsZVwiKTtcbiAgICAgICAgdGhpcy5zdGF0dXNCYXJFbC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4gdm9pZCB0aGlzLmN5Y2xlVGFnUGxhY2VtZW50KCkpO1xuICAgICAgICBcbiAgICAgICAgLy8gRGVza3RvcDogSW50ZXJjZXB0IGVkaXRvciBjbGlja3Mgd2l0aCBjYXB0dXJlIHRvIHByZXZlbnQgT2JzaWRpYW4gaGlqYWNraW5nIHRoZW1cbiAgICAgICAgdGhpcy5yZWdpc3RlckRvbUV2ZW50KGRvY3VtZW50LCBcImNsaWNrXCIsIChldnQ6IE1vdXNlRXZlbnQpID0+IHtcbiAgICAgICAgICAgIGlmICghZXZ0LmFsdEtleSkgcmV0dXJuO1xuXG4gICAgICAgICAgICAvLyAxLiBDdHJsICsgQWx0ICsgU2hpZnQgKyBDbGljayAtPiBMb2NhbCBNdXRlIC8gVW5tdXRlIHRhZ1xuICAgICAgICAgICAgaWYgKGV2dC5zaGlmdEtleSAmJiAoZXZ0LmN0cmxLZXkgfHwgZXZ0Lm1ldGFLZXkpKSB7XG4gICAgICAgICAgICAgICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICAgICAgZXZ0LnN0b3BQcm9wYWdhdGlvbigpO1xuICAgICAgICAgICAgICAgIHZvaWQgdGhpcy5oYW5kbGVFZGl0b3JUcmlnZ2VyKHsga2luZDogXCJsb2NhbC1tdXRlXCIsIG1vdXNlRXZlbnQ6IGV2dCB9KTtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIDFiLiBTaGlmdCArIEFsdCArIENsaWNrIC0+IHN0cmlwIGxlYWRpbmcgJyMnIGJ1dCBrZWVwIHRoZSBleHByZXNzaW9uIHRleHRcbiAgICAgICAgICAgICAgICBpZiAoZXZ0LnNoaWZ0S2V5ICYmICFldnQuY3RybEtleSAmJiAhZXZ0Lm1ldGFLZXkpIHtcbiAgICAgICAgICAgICAgICAgICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICAgICAgICAgIGV2dC5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICAgICAgICAgICAgICAgICAgdm9pZCB0aGlzLmhhbmRsZUVkaXRvclRyaWdnZXIoeyBraW5kOiBcInN0cmlwLWhhc2hcIiwgbW91c2VFdmVudDogZXZ0IH0pO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgLy8gMi4gQ3RybCArIEFsdCArIENsaWNrIC0+IEZUViBEcmlsbCBEb3duXG4gICAgICAgICAgICBpZiAoIWV2dC5zaGlmdEtleSAmJiAoZXZ0LmN0cmxLZXkgfHwgZXZ0Lm1ldGFLZXkpKSB7XG4gICAgICAgICAgICAgICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICAgICAgZXZ0LnN0b3BQcm9wYWdhdGlvbigpO1xuICAgICAgICAgICAgICAgIHZvaWQgdGhpcy5oYW5kbGVFZGl0b3JUcmlnZ2VyKHsga2luZDogXCJkcmlsbC1kb3duXCIsIG1vdXNlRXZlbnQ6IGV2dCB9KTtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIDMuIEFsdCArIENsaWNrIChvbmx5IEFsdCkgLT4gQ3JlYXRlL1JlbW92ZSB0YWdcbiAgICAgICAgICAgIGlmICghZXZ0LnNoaWZ0S2V5ICYmICFldnQuY3RybEtleSAmJiAhZXZ0Lm1ldGFLZXkpIHtcbiAgICAgICAgICAgICAgICBldnQucHJldmVudERlZmF1bHQoKTsgXG4gICAgICAgICAgICAgICAgdm9pZCB0aGlzLmhhbmRsZUVkaXRvclRyaWdnZXIoeyBraW5kOiBcImFsdC1jbGlja1wiLCBtb3VzZUV2ZW50OiBldnQgfSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LCB7IGNhcHR1cmU6IHRydWUgfSk7XG5cbiAgICAgICAgLy8gTW9iaWxlOiBsb25nIHByZXNzXG4gICAgICAgIHRoaXMucmVnaXN0ZXJNb2JpbGVMb25nUHJlc3MoKTtcbiAgICB9XG5cbiAgICBvbnVubG9hZCgpIHtcbiAgICAgICAgdGhpcy5hcHAud29ya3NwYWNlLmRldGFjaExlYXZlc09mVHlwZShWSUVXX1RZUEUpO1xuICAgICAgICBpZiAodGhpcy5zdGF0dXNCYXJFbCkge1xuICAgICAgICAgICAgdGhpcy5zdGF0dXNCYXJFbC5yZW1vdmUoKTtcbiAgICAgICAgICAgIHRoaXMuc3RhdHVzQmFyRWwgPSBudWxsO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHVibGljIGFzeW5jIGN5Y2xlVGFnUGxhY2VtZW50KCkge1xuICAgICAgICBjb25zdCBtb2RlczogQWx0Q2xpY2tUYWdNb2RlW10gPSBbXCJzdGFydC1saW5lXCIsIFwiaW4tcGxhY2VcIiwgXCJlbmQtbGluZVwiXTtcbiAgICAgICAgY29uc3QgY3VycmVudCA9IHRoaXMuc2V0dGluZ3MuYWx0Q2xpY2tUYWdNb2RlO1xuICAgICAgICBjb25zdCBuZXh0ID0gbW9kZXNbKG1vZGVzLmluZGV4T2YoY3VycmVudCkgKyAxKSAlIG1vZGVzLmxlbmd0aF07XG5cbiAgICAgICAgdGhpcy5zZXR0aW5ncy5hbHRDbGlja1RhZ01vZGUgPSBuZXh0O1xuICAgICAgICBhd2FpdCB0aGlzLnNhdmVTZXR0aW5ncygpO1xuXG4gICAgICAgIGNvbnN0IGxhYmVsczogUmVjb3JkPEFsdENsaWNrVGFnTW9kZSwgc3RyaW5nPiA9IHtcbiAgICAgICAgICAgIFwic3RhcnQtbGluZVwiOiBcIlN0YXJ0IG9mIGxpbmVcIixcbiAgICAgICAgICAgIFwiaW4tcGxhY2VcIjogXCJJbiBwbGFjZVwiLFxuICAgICAgICAgICAgXCJlbmQtbGluZVwiOiBcIkVuZCBvZiBsaW5lXCIsXG4gICAgICAgIH07XG4gICAgICAgIG5ldyBOb3RpY2UoYFRhZyBwbGFjZW1lbnQ6ICR7bGFiZWxzW25leHRdfWApO1xuICAgIH1cblxuICAgIC8vIFx1MjUwMFx1MjUwMCBTdGF0dXMgYmFyIFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFxuXG4gICAgdXBkYXRlU3RhdHVzQmFyKCkge1xuICAgICAgICBpZiAoIXRoaXMuc3RhdHVzQmFyRWwpIHJldHVybjtcblxuICAgICAgICBjb25zdCBzaG93ID0gdGhpcy5zZXR0aW5ncy5zaG93UGxhY2VtZW50SW5TdGF0dXNCYXIgPz8gdHJ1ZTtcblxuICAgICAgICBpZiAoIXNob3cpIHtcbiAgICAgICAgICAgIHRoaXMuc3RhdHVzQmFyRWwuc2V0VGV4dChcIlwiKTtcbiAgICAgICAgICAgIHRoaXMuc3RhdHVzQmFyRWwuc3R5bGUuZGlzcGxheSA9IFwibm9uZVwiO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgbGFiZWxzOiBSZWNvcmQ8QWx0Q2xpY2tUYWdNb2RlLCBzdHJpbmc+ID0ge1xuICAgICAgICAgICAgXCJzdGFydC1saW5lXCI6IFwiU09MXCIsXG4gICAgICAgICAgICBcImluLXBsYWNlXCI6IFwiSU5QXCIsXG4gICAgICAgICAgICBcImVuZC1saW5lXCI6IFwiRU9MXCIsXG4gICAgICAgIH07XG5cbiAgICAgICAgY29uc3QgbW9kZUxhYmVsID0gbGFiZWxzW3RoaXMuc2V0dGluZ3MuYWx0Q2xpY2tUYWdNb2RlXSA/PyBcIlNPTFwiO1xuICAgICAgICB0aGlzLnN0YXR1c0JhckVsLnNldFRleHQoYCM+JHttb2RlTGFiZWx9YCk7XG4gICAgICAgIHRoaXMuc3RhdHVzQmFyRWwuc3R5bGUuZGlzcGxheSA9IFwiXCI7XG4gICAgfVxuXG4gICAgLy8gXHUyNTAwXHUyNTAwIE1vYmlsZSBsb25nIHByZXNzIFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFxuXG4gICAgcHJpdmF0ZSByZWdpc3Rlck1vYmlsZUxvbmdQcmVzcygpIHtcbiAgICAgICAgaWYgKCFQbGF0Zm9ybS5pc01vYmlsZSkgcmV0dXJuO1xuXG4gICAgICAgIGxldCB0aW1lcjogbnVtYmVyIHwgbnVsbCA9IG51bGw7XG4gICAgICAgIGxldCBzdGFydFggPSAwO1xuICAgICAgICBsZXQgc3RhcnRZID0gMDtcbiAgICAgICAgbGV0IGNhbmNlbGxlZCA9IGZhbHNlO1xuICAgICAgICBsZXQgbG9uZ1ByZXNzQXJtZWQgPSBmYWxzZTtcblxuICAgICAgICBjb25zdCBjbGVhciA9ICgpID0+IHtcbiAgICAgICAgICAgIGlmICh0aW1lcikgd2luZG93LmNsZWFyVGltZW91dCh0aW1lcik7XG4gICAgICAgICAgICB0aW1lciA9IG51bGw7XG4gICAgICAgICAgICBsb25nUHJlc3NBcm1lZCA9IGZhbHNlO1xuICAgICAgICB9O1xuXG4gICAgICAgIHRoaXMucmVnaXN0ZXJEb21FdmVudChcbiAgICAgICAgICAgIGRvY3VtZW50LFxuICAgICAgICAgICAgXCJ0b3VjaHN0YXJ0XCIsXG4gICAgICAgICAgICAoZXZ0OiBUb3VjaEV2ZW50KSA9PiB7XG4gICAgICAgICAgICAgICAgaWYgKCF0aGlzLnNldHRpbmdzLm1vYmlsZUxvbmdQcmVzc0VuYWJsZWQpIHJldHVybjtcbiAgICAgICAgICAgICAgICBpZiAoZXZ0LnRvdWNoZXMubGVuZ3RoICE9PSAxKSByZXR1cm47XG4gICAgICAgICAgICAgICAgY2FuY2VsbGVkID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgbG9uZ1ByZXNzQXJtZWQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICBjb25zdCB0ID0gZXZ0LnRvdWNoZXNbMF07XG4gICAgICAgICAgICAgICAgc3RhcnRYID0gdC5jbGllbnRYO1xuICAgICAgICAgICAgICAgIHN0YXJ0WSA9IHQuY2xpZW50WTtcbiAgICAgICAgICAgICAgICBjbGVhcigpO1xuICAgICAgICAgICAgICAgIGNvbnN0IG1zID0gTWF0aC5tYXgoMjUwLCBNYXRoLm1pbig1MDAwLCB0aGlzLnNldHRpbmdzLm1vYmlsZUxvbmdQcmVzc01zID8/IDEwMDApKTtcbiAgICAgICAgICAgICAgICB0aW1lciA9IHdpbmRvdy5zZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgdGltZXIgPSBudWxsO1xuICAgICAgICAgICAgICAgICAgICBpZiAoY2FuY2VsbGVkKSByZXR1cm47XG4gICAgICAgICAgICAgICAgICAgIC8vIEFybTsgZmlyZSBvbiB0b3VjaGVuZCBhZnRlciBPUyBzZWxlY3Rpb24gaXMgZXN0YWJsaXNoZWQuXG4gICAgICAgICAgICAgICAgICAgIGxvbmdQcmVzc0FybWVkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB9LCBtcyk7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgeyBwYXNzaXZlOiB0cnVlIH1cbiAgICAgICAgKTtcblxuICAgICAgICB0aGlzLnJlZ2lzdGVyRG9tRXZlbnQoXG4gICAgICAgICAgICBkb2N1bWVudCxcbiAgICAgICAgICAgIFwidG91Y2htb3ZlXCIsXG4gICAgICAgICAgICAoZXZ0OiBUb3VjaEV2ZW50KSA9PiB7XG4gICAgICAgICAgICAgICAgaWYgKCF0aW1lcikgcmV0dXJuO1xuICAgICAgICAgICAgICAgIGNvbnN0IHQgPSBldnQudG91Y2hlc1swXTtcbiAgICAgICAgICAgICAgICBjb25zdCBkeCA9IE1hdGguYWJzKHQuY2xpZW50WCAtIHN0YXJ0WCk7XG4gICAgICAgICAgICAgICAgY29uc3QgZHkgPSBNYXRoLmFicyh0LmNsaWVudFkgLSBzdGFydFkpO1xuICAgICAgICAgICAgICAgIGlmIChkeCA+IDEyIHx8IGR5ID4gMTIpIHsgY2FuY2VsbGVkID0gdHJ1ZTsgY2xlYXIoKTsgfVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHsgcGFzc2l2ZTogdHJ1ZSB9XG4gICAgICAgICk7XG5cbiAgICAgICAgdGhpcy5yZWdpc3RlckRvbUV2ZW50KFxuICAgICAgICAgICAgZG9jdW1lbnQsXG4gICAgICAgICAgICBcInRvdWNoZW5kXCIsXG4gICAgICAgICAgICAoKSA9PiB7XG4gICAgICAgICAgICAgICAgY29uc3Qgc2hvdWxkRmlyZSA9IGxvbmdQcmVzc0FybWVkICYmICFjYW5jZWxsZWQ7XG4gICAgICAgICAgICAgICAgY2xlYXIoKTtcbiAgICAgICAgICAgICAgICBpZiAoIXNob3VsZEZpcmUpIHJldHVybjtcbiAgICAgICAgICAgICAgICB2b2lkIHRoaXMuaGFuZGxlRWRpdG9yVHJpZ2dlcih7IGtpbmQ6IFwibW9iaWxlLWxvbmctcHJlc3NcIiB9KTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB7IHBhc3NpdmU6IHRydWUgfVxuICAgICAgICApO1xuXG4gICAgICAgIHRoaXMucmVnaXN0ZXJEb21FdmVudChcbiAgICAgICAgICAgIGRvY3VtZW50LFxuICAgICAgICAgICAgXCJ0b3VjaGNhbmNlbFwiLFxuICAgICAgICAgICAgKCkgPT4geyBjYW5jZWxsZWQgPSB0cnVlOyBjbGVhcigpOyB9LFxuICAgICAgICAgICAgeyBwYXNzaXZlOiB0cnVlIH1cbiAgICAgICAgKTtcbiAgICB9XG5cbiAgICAvLyBcdTI1MDBcdTI1MDAgVHJpZ2dlciBlbnRyeS1wb2ludCBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcblxuICAgIHByaXZhdGUgYXN5bmMgaGFuZGxlRWRpdG9yVHJpZ2dlcihcbiAgICAgICAgdHJpZ2dlcjogeyBraW5kOiBcImFsdC1jbGlja1wiIHwgXCJkcmlsbC1kb3duXCIgfCBcImxvY2FsLW11dGVcIiB8IFwic3RyaXAtaGFzaFwiOyBtb3VzZUV2ZW50PzogTW91c2VFdmVudCB9IHwgeyBraW5kOiBcIm1vYmlsZS1sb25nLXByZXNzXCIgfVxuICAgICkge1xuICAgICAgICAvLyBjb25zdCB2aWV3ID0gdGhpcy5hcHAud29ya3NwYWNlLmdldEFjdGl2ZVZpZXdPZlR5cGUoTWFya2Rvd25WaWV3KTtcbiAgICAgICAgLy8gaWYgKCF2aWV3KSByZXR1cm47XG5cbiAgICAgICAgLy8gLy8gU291cmNlIC8gZWRpdG9yIG1vZGUgb25seVxuICAgICAgICAvLyBjb25zdCBhbnlWaWV3ID0gdmlldyBhcyBhbnk7XG4gICAgICAgIC8vIGlmICh0eXBlb2YgYW55Vmlldy5nZXRNb2RlID09PSBcImZ1bmN0aW9uXCIgJiYgYW55Vmlldy5nZXRNb2RlKCkgIT09IFwic291cmNlXCIpIHJldHVybjtcblxuICAgICAgICAvLyBjb25zdCBlZGl0b3IgPSB2aWV3LmVkaXRvcjtcbiAgICAgICAgLy8gaWYgKCFlZGl0b3IpIHJldHVybjtcblxuICAgICAgICBjb25zdCB2aWV3ID0gdGhpcy5hcHAud29ya3NwYWNlLmdldEFjdGl2ZVZpZXdPZlR5cGUoTWFya2Rvd25WaWV3KTtcbiAgICAgICAgaWYgKCF2aWV3KSByZXR1cm47XG5cbiAgICAgICAgLy8gRGV0ZXJtaW5lIGlmIHdlIGFyZSBpbiBzb3VyY2UgbW9kZVxuICAgICAgICBjb25zdCBpc1NvdXJjZU1vZGUgPVxuICAgICAgICAodmlldyBhcyBhbnkpLmdldE1vZGUgJiZcbiAgICAgICAgdHlwZW9mICh2aWV3IGFzIGFueSkuZ2V0TW9kZSA9PT0gXCJmdW5jdGlvblwiICYmXG4gICAgICAgICh2aWV3IGFzIGFueSkuZ2V0TW9kZSgpID09PSBcInNvdXJjZVwiO1xuXG4gICAgICAgIGlmICghaXNTb3VyY2VNb2RlKSB7XG4gICAgICAgIC8vIFJlYWRpbmcvUHJldmlldyBtb2RlOlxuICAgICAgICAvLyBTdXBwb3J0IE9OTFkgQ3RybCtBbHQrQ2xpY2sgZHJpbGwtZG93biBvbiByZW5kZXJlZCB0YWdzXG4gICAgICAgIGlmIChcImtpbmRcIiBpbiB0cmlnZ2VyICYmIHRyaWdnZXIua2luZCA9PT0gXCJkcmlsbC1kb3duXCIgJiYgdHJpZ2dlci5tb3VzZUV2ZW50KSB7XG4gICAgICAgICAgICBjb25zdCB0YXJnZXQgPSB0cmlnZ2VyLm1vdXNlRXZlbnQudGFyZ2V0IGFzIEhUTUxFbGVtZW50O1xuICAgICAgICAgICAgY29uc3QgdGFnRWwgPSB0YXJnZXQ/LmNsb3Nlc3QoXCIudGFnXCIpO1xuICAgICAgICAgICAgY29uc3QgdGFnVGV4dCA9IHRhZ0VsPy50ZXh0Q29udGVudD8udHJpbSgpO1xuXG4gICAgICAgICAgICBpZiAodGFnVGV4dCAmJiB0YWdUZXh0LnN0YXJ0c1dpdGgoXCIjXCIpICYmICF0YWdUZXh0LnN0YXJ0c1dpdGgoXCIjJVwiKSkge1xuICAgICAgICAgICAgYXdhaXQgdGhpcy5hY3RpdmF0ZVZpZXcoKTtcbiAgICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IGZ0dkxlYWYgPSB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0TGVhdmVzT2ZUeXBlKFZJRVdfVFlQRSlbMF07XG4gICAgICAgICAgICAgICAgaWYgKGZ0dkxlYWYgJiYgZnR2TGVhZi52aWV3IGluc3RhbmNlb2YgRmxhdFRhZ1ZpZXcpIHtcbiAgICAgICAgICAgICAgICBmdHZMZWFmLnZpZXcuc2VsZWN0U2luZ2xlVGFnKHRhZ1RleHQpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIDUwKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCBlZGl0b3IgPSB2aWV3LmVkaXRvcjtcbiAgICAgICAgaWYgKCFlZGl0b3IpIHJldHVybjtcblxuICAgICAgICAvLyBNb2JpbGU6IHJlcXVpcmUgYSByZWFsIHNlbGVjdGlvbiB0byBhdm9pZCBhY2NpZGVudGFsIHRyaWdnZXJzXG4gICAgICAgIGlmICh0cmlnZ2VyLmtpbmQgPT09IFwibW9iaWxlLWxvbmctcHJlc3NcIikge1xuICAgICAgICAgICAgY29uc3Qgc2VsID0gZWRpdG9yLmdldFNlbGVjdGlvbigpO1xuICAgICAgICAgICAgaWYgKCFzZWwgfHwgIXNlbC50cmltKCkpIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IGNhbmRpZGF0ZSA9IHRoaXMuZ2V0Q2FuZGlkYXRlV2l0aFJhbmdlKGVkaXRvciwgeyBwcmVmZXJTZWxlY3Rpb246IFBsYXRmb3JtLmlzTW9iaWxlIH0pO1xuICAgICAgICBpZiAoIWNhbmRpZGF0ZSkgcmV0dXJuO1xuXG4gICAgICAgIC8vIDEuIERyaWxsIGRvd24gYWN0aW9uXG4gICAgICAgIGlmICh0cmlnZ2VyLmtpbmQgPT09IFwiZHJpbGwtZG93blwiKSB7XG4gICAgICAgICAgICBpZiAoY2FuZGlkYXRlLnJhdy5zdGFydHNXaXRoKFwiI1wiKSAmJiAhY2FuZGlkYXRlLnJhdy5zdGFydHNXaXRoKFwiIyVcIikpIHtcbiAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLmFjdGl2YXRlVmlldygpO1xuICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBmdHZMZWFmID0gdGhpcy5hcHAud29ya3NwYWNlLmdldExlYXZlc09mVHlwZShWSUVXX1RZUEUpWzBdO1xuICAgICAgICAgICAgICAgICAgICBpZiAoZnR2TGVhZiAmJiBmdHZMZWFmLnZpZXcgaW5zdGFuY2VvZiBGbGF0VGFnVmlldykge1xuICAgICAgICAgICAgICAgICAgICAgICAgZnR2TGVhZi52aWV3LnNlbGVjdFNpbmdsZVRhZyhjYW5kaWRhdGUucmF3KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0sIDUwKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIDIuIExvY2FsIE11dGUgYWN0aW9uXG4gICAgICAgIGlmICh0cmlnZ2VyLmtpbmQgPT09IFwibG9jYWwtbXV0ZVwiKSB7XG4gICAgICAgICAgICBpZiAoY2FuZGlkYXRlLnJhdy5zdGFydHNXaXRoKFwiI1wiKSAmJiBjYW5kaWRhdGUucmFuZ2UpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBjdXJyZW50VGFnID0gY2FuZGlkYXRlLnJhdztcbiAgICAgICAgICAgICAgICBsZXQgbmV3VGFnID0gXCJcIjtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICBpZiAoY3VycmVudFRhZy5zdGFydHNXaXRoKFwiIyVcIikpIHtcbiAgICAgICAgICAgICAgICAgICAgbmV3VGFnID0gXCIjXCIgKyBjdXJyZW50VGFnLnNsaWNlKDIpOyAvLyBSZW1vdmUgJVxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIG5ld1RhZyA9IFwiIyVcIiArIGN1cnJlbnRUYWcuc2xpY2UoMSk7IC8vIEFkZCAlXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIGVkaXRvci5yZXBsYWNlUmFuZ2UobmV3VGFnLCBjYW5kaWRhdGUucmFuZ2UuZnJvbSwgY2FuZGlkYXRlLnJhbmdlLnRvKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIDJiLiBTdHJpcC1oYXNoIGFjdGlvbiAoYWx3YXlzIGxlYXZlIGV4cHJlc3Npb24gdGV4dClcbiAgICAgICAgaWYgKHRyaWdnZXIua2luZCA9PT0gXCJzdHJpcC1oYXNoXCIpIHtcbiAgICAgICAgICAgIGlmIChjYW5kaWRhdGUucmF3LnN0YXJ0c1dpdGgoXCIjJVwiKSkgcmV0dXJuO1xuICAgICAgICAgICAgaWYgKCFjYW5kaWRhdGUucmF3LnN0YXJ0c1dpdGgoXCIjXCIpKSByZXR1cm47XG5cbiAgICAgICAgICAgIGF3YWl0IHRoaXMuc3RyaXBIYXNoRnJvbVRhZyhlZGl0b3IsIGNhbmRpZGF0ZSk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICAvLyAzLiBBbHQtY2xpY2sgKGRlZmF1bHQgY3JlYXRlL3JlbW92ZSlcbiAgICAgICAgaWYgKHRyaWdnZXIua2luZCA9PT0gXCJhbHQtY2xpY2tcIiB8fCB0cmlnZ2VyLmtpbmQgPT09IFwibW9iaWxlLWxvbmctcHJlc3NcIikge1xuICAgICAgICAgICAgLy8gQ29tcGxldGVseSBpZ25vcmUgQWx0LWNsaWNrcyBvbiBtdXRlZCB0YWdzXG4gICAgICAgICAgICBpZiAoY2FuZGlkYXRlLnJhdy5zdGFydHNXaXRoKFwiIyVcIikpIHtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmIChjYW5kaWRhdGUucmF3LnN0YXJ0c1dpdGgoXCIjXCIpKSB7XG4gICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5yZW1vdmVUYWcoZWRpdG9yLCBjYW5kaWRhdGUpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLmNyZWF0ZVRhZyhlZGl0b3IsIHRoaXMuc2V0dGluZ3MuYWx0Q2xpY2tUYWdNb2RlLCBjYW5kaWRhdGUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgLy8gXHUyNTAwXHUyNTAwIENhbmRpZGF0ZSByZXNvbHV0aW9uIFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFxuXG4gICAgcHJpdmF0ZSBnZXRTZWxlY3Rpb25SYW5nZShlZGl0b3I6IEVkaXRvcik6IEVkaXRvclJhbmdlIHwgbnVsbCB7XG4gICAgICAgIGNvbnN0IGFueUVkaXRvciA9IGVkaXRvciBhcyBhbnk7XG4gICAgICAgIGNvbnN0IGZyb20gPSBhbnlFZGl0b3IuZ2V0Q3Vyc29yPy4oXCJmcm9tXCIpIGFzIEVkaXRvclBvc2l0aW9uIHwgdW5kZWZpbmVkO1xuICAgICAgICBjb25zdCB0byA9IGFueUVkaXRvci5nZXRDdXJzb3I/LihcInRvXCIpIGFzIEVkaXRvclBvc2l0aW9uIHwgdW5kZWZpbmVkO1xuICAgICAgICBpZiAoIWZyb20gfHwgIXRvKSByZXR1cm4gbnVsbDtcbiAgICAgICAgaWYgKGZyb20ubGluZSA9PT0gdG8ubGluZSAmJiBmcm9tLmNoID09PSB0by5jaCkgcmV0dXJuIG51bGw7XG4gICAgICAgIGlmIChmcm9tLmxpbmUgPiB0by5saW5lIHx8IChmcm9tLmxpbmUgPT09IHRvLmxpbmUgJiYgZnJvbS5jaCA+IHRvLmNoKSkgcmV0dXJuIHsgZnJvbTogdG8sIHRvOiBmcm9tIH07XG4gICAgICAgIHJldHVybiB7IGZyb20sIHRvIH07XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBidWlsZFNlbENhbmRpZGF0ZShlZGl0b3I6IEVkaXRvciwgc2VsOiBzdHJpbmcsIHI6IEVkaXRvclJhbmdlKTogQ2FuZGlkYXRlIHtcbiAgICAgICAgY29uc3QgcmF3ID0gc2VsLnRyaW0oKTtcbiAgICAgICAgaWYgKCFyYXcuc3RhcnRzV2l0aChcIiNcIikgJiYgci5mcm9tLmNoID4gMCkge1xuICAgICAgICAgICAgY29uc3QgbGluZVRleHQgPSBlZGl0b3IuZ2V0TGluZShyLmZyb20ubGluZSk7XG4gICAgICAgICAgICBpZiAobGluZVRleHQuY2hhckF0KHIuZnJvbS5jaCAtIDEpID09PSBcIiNcIikge1xuICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgIHJhdzogXCIjXCIgKyByYXcsXG4gICAgICAgICAgICAgICAgICAgIHJhbmdlOiB7IGZyb206IHsgbGluZTogci5mcm9tLmxpbmUsIGNoOiByLmZyb20uY2ggLSAxIH0sIHRvOiByLnRvIH0sXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4geyByYXcsIHJhbmdlOiByIH07XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBnZXRDYW5kaWRhdGVXaXRoUmFuZ2UoZWRpdG9yOiBFZGl0b3IsIG9wdHM/OiB7IHByZWZlclNlbGVjdGlvbj86IGJvb2xlYW4gfSk6IENhbmRpZGF0ZSB8IG51bGwge1xuICAgICAgICBjb25zdCBwcmVmZXJTZWxlY3Rpb24gPSBvcHRzPy5wcmVmZXJTZWxlY3Rpb24gPz8gdHJ1ZTtcblxuICAgICAgICBjb25zdCBzZWwgPSBlZGl0b3IuZ2V0U2VsZWN0aW9uKCk7XG4gICAgICAgIGNvbnN0IHNlbFJhbmdlID0gdGhpcy5nZXRTZWxlY3Rpb25SYW5nZShlZGl0b3IpO1xuXG4gICAgICAgIGlmIChwcmVmZXJTZWxlY3Rpb24gJiYgc2VsICYmIHNlbC50cmltKCkgJiYgIS9bXFxyXFxuXS8udGVzdChzZWwpICYmIHNlbFJhbmdlKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5idWlsZFNlbENhbmRpZGF0ZShlZGl0b3IsIHNlbCwgc2VsUmFuZ2UpO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgdG9rZW4gPSB0aGlzLmdldFRva2VuQXRDdXJzb3IoZWRpdG9yKTtcbiAgICAgICAgaWYgKHRva2VuKSByZXR1cm4gdG9rZW47XG5cbiAgICAgICAgaWYgKCFwcmVmZXJTZWxlY3Rpb24gJiYgc2VsICYmIHNlbC50cmltKCkgJiYgIS9bXFxyXFxuXS8udGVzdChzZWwpICYmIHNlbFJhbmdlKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5idWlsZFNlbENhbmRpZGF0ZShlZGl0b3IsIHNlbCwgc2VsUmFuZ2UpO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBnZXRUb2tlbkF0Q3Vyc29yKGVkaXRvcjogRWRpdG9yKTogQ2FuZGlkYXRlIHwgbnVsbCB7XG4gICAgICAgIGNvbnN0IGN1cnNvciA9IGVkaXRvci5nZXRDdXJzb3IoKTtcbiAgICAgICAgY29uc3QgbGluZVRleHQgPSBlZGl0b3IuZ2V0TGluZShjdXJzb3IubGluZSkgPz8gXCJcIjtcbiAgICAgICAgaWYgKCFsaW5lVGV4dCkgcmV0dXJuIG51bGw7XG5cbiAgICAgICAgY29uc3QgaXNCb2R5Q2hhciA9IChjaDogc3RyaW5nKSA9PiAvW15cXHNcIidgXFxdXFxbe30oKT0rXFxcXHwsPC4+IT86OyomXkAkI10vdS50ZXN0KGNoKTtcblxuICAgICAgICBsZXQgaSA9IGN1cnNvci5jaDtcbiAgICAgICAgaWYgKGkgPj0gbGluZVRleHQubGVuZ3RoKSBpID0gbGluZVRleHQubGVuZ3RoIC0gMTtcbiAgICAgICAgaWYgKGkgPCAwKSByZXR1cm4gbnVsbDtcblxuICAgICAgICBjb25zdCBjdXIgPSBsaW5lVGV4dC5jaGFyQXQoaSk7XG5cbiAgICAgICAgLy8gQ2FzZSAxOiBjdXJzb3IgZGlyZWN0bHkgb24gJyMnXG4gICAgICAgIGlmIChjdXIgPT09IFwiI1wiKSB7XG4gICAgICAgICAgICBsZXQgZW5kID0gaSArIDE7XG4gICAgICAgICAgICB3aGlsZSAoZW5kIDwgbGluZVRleHQubGVuZ3RoICYmIGlzQm9keUNoYXIobGluZVRleHQuY2hhckF0KGVuZCkpKSBlbmQrKztcbiAgICAgICAgICAgIGlmIChlbmQgPT09IGkgKyAxKSByZXR1cm4gbnVsbDtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgcmF3OiBsaW5lVGV4dC5zbGljZShpLCBlbmQpLFxuICAgICAgICAgICAgICAgIHJhbmdlOiB7IGZyb206IHsgbGluZTogY3Vyc29yLmxpbmUsIGNoOiBpIH0sIHRvOiB7IGxpbmU6IGN1cnNvci5saW5lLCBjaDogZW5kIH0gfSxcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cblxuICAgICAgICAvLyBDYXNlIDI6IGN1cnNvciBvbiBhIGJvZHkgY2hhcmFjdGVyXG4gICAgICAgIGlmIChpc0JvZHlDaGFyKGN1cikpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLndvcmRSYW5nZUF0KGN1cnNvci5saW5lLCBsaW5lVGV4dCwgaSk7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBDYXNlIDM6IGN1cnNvciBqdXN0IGFmdGVyIGEgYm9keSBjaGFyYWN0ZXJcbiAgICAgICAgaWYgKGkgPiAwICYmIGlzQm9keUNoYXIobGluZVRleHQuY2hhckF0KGkgLSAxKSkpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLndvcmRSYW5nZUF0KGN1cnNvci5saW5lLCBsaW5lVGV4dCwgaSAtIDEpO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSB3b3JkUmFuZ2VBdChsaW5lOiBudW1iZXIsIGxpbmVUZXh0OiBzdHJpbmcsIGk6IG51bWJlcik6IENhbmRpZGF0ZSB8IG51bGwge1xuICAgICAgICBjb25zdCBpc0JvZHlDaGFyID0gKGNoOiBzdHJpbmcpID0+IC9bXlxcc1wiJ2BcXF1cXFt7fSgpPStcXFxcfCw8Lj4hPzo7KiZeQCQjXS91LnRlc3QoY2gpO1xuXG4gICAgICAgIGxldCBzdGFydCA9IGk7XG4gICAgICAgIHdoaWxlIChzdGFydCA+IDAgJiYgaXNCb2R5Q2hhcihsaW5lVGV4dC5jaGFyQXQoc3RhcnQgLSAxKSkpIHN0YXJ0LS07XG5cbiAgICAgICAgY29uc3QgaGFzaFN0YXJ0ID0gKHN0YXJ0ID4gMCAmJiBsaW5lVGV4dC5jaGFyQXQoc3RhcnQgLSAxKSA9PT0gXCIjXCIpID8gc3RhcnQgLSAxIDogc3RhcnQ7XG5cbiAgICAgICAgbGV0IGVuZCA9IGkgKyAxO1xuICAgICAgICB3aGlsZSAoZW5kIDwgbGluZVRleHQubGVuZ3RoICYmIGlzQm9keUNoYXIobGluZVRleHQuY2hhckF0KGVuZCkpKSBlbmQrKztcblxuICAgICAgICBjb25zdCByYXcgPSBsaW5lVGV4dC5zbGljZShoYXNoU3RhcnQsIGVuZCk7XG4gICAgICAgIGlmICghcmF3LnRyaW0oKSkgcmV0dXJuIG51bGw7XG5cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHJhdyxcbiAgICAgICAgICAgIHJhbmdlOiB7IGZyb206IHsgbGluZSwgY2g6IGhhc2hTdGFydCB9LCB0bzogeyBsaW5lLCBjaDogZW5kIH0gfSxcbiAgICAgICAgfTtcbiAgICB9XG5cbiAgICAvLyBcdTI1MDBcdTI1MDAgVmFsaWRhdGlvbiBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcblxuICAgIHByaXZhdGUgaGFzRm9yYmlkZGVuQ2hhcnMocmF3OiBzdHJpbmcpOiBib29sZWFuIHtcbiAgICAgICAgY29uc3QgcyA9IHJhdy50cmltKCk7XG4gICAgICAgIGlmICghcykgcmV0dXJuIHRydWU7XG5cbiAgICAgICAgY29uc3QgYm9keSA9IHMuc3RhcnRzV2l0aChcIiNcIikgPyBzLnNsaWNlKDEpIDogcztcbiAgICAgICAgaWYgKGJvZHkuaW5jbHVkZXMoXCIjXCIpKSByZXR1cm4gdHJ1ZTtcblxuICAgICAgICByZXR1cm4gL1shQCReJiooKSs9IDw+LC4/YH5dLy50ZXN0KGJvZHkpO1xuICAgIH1cblxuICAgIHByaXZhdGUgbm9ybWFsaXplQ2FuZGlkYXRlKHJhdzogc3RyaW5nKTogc3RyaW5nIHwgbnVsbCB7XG4gICAgICAgIGxldCB0ID0gcmF3LnRyaW0oKTtcbiAgICAgICAgaWYgKCF0KSByZXR1cm4gbnVsbDtcbiAgICAgICAgaWYgKHRoaXMuaGFzRm9yYmlkZGVuQ2hhcnModCkpIHJldHVybiBudWxsO1xuXG4gICAgICAgIGlmICh0LnN0YXJ0c1dpdGgoXCIjXCIpKSB0ID0gdC5zbGljZSgxKTtcbiAgICAgICAgaWYgKCF0KSByZXR1cm4gbnVsbDtcblxuICAgICAgICBpZiAoL15cXGQrJC8udGVzdCh0KSB8fCB0ID09PSBcIiVcIikgcmV0dXJuIG51bGw7XG4gICAgICAgIGlmICgvXFxzLy50ZXN0KHQpKSByZXR1cm4gbnVsbDtcblxuICAgICAgICByZXR1cm4gdDtcbiAgICB9XG5cbiAgICAvLyBcdTI1MDBcdTI1MDAgVGFnIGhlbHBlcnMgXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXG5cbiAgICBwcml2YXRlIHRhZ1Rva2VuRm9yUGxhY2VtZW50KGNhbmRpZGF0ZTogc3RyaW5nLCBtb2RlOiBBbHRDbGlja1RhZ01vZGUpOiBzdHJpbmcge1xuICAgICAgICBjb25zdCB0ZXh0ID0gKG1vZGUgPT09IFwic3RhcnQtbGluZVwiIHx8IG1vZGUgPT09IFwiZW5kLWxpbmVcIikgPyBjYW5kaWRhdGUudG9Mb3dlckNhc2UoKSA6IGNhbmRpZGF0ZTtcbiAgICAgICAgcmV0dXJuIGAjJHt0ZXh0fWA7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBzb3J0VGFncyh0b2tlbnM6IHN0cmluZ1tdKTogc3RyaW5nW10ge1xuICAgICAgICBjb25zdCB1bmlxOiBzdHJpbmdbXSA9IFtdO1xuICAgICAgICBjb25zdCBzZWVuID0gbmV3IFNldDxzdHJpbmc+KCk7XG4gICAgICAgIGZvciAoY29uc3QgdCBvZiB0b2tlbnMpIHtcbiAgICAgICAgICAgIGNvbnN0IGtleSA9IHQucmVwbGFjZSgvXiMvLCBcIlwiKS50b0xvd2VyQ2FzZSgpO1xuICAgICAgICAgICAgaWYgKHNlZW4uaGFzKGtleSkpIGNvbnRpbnVlO1xuICAgICAgICAgICAgc2Vlbi5hZGQoa2V5KTtcbiAgICAgICAgICAgIHVuaXEucHVzaCh0KTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdW5pcS5zb3J0KChhLCBiKSA9PiBhLnRvTG93ZXJDYXNlKCkubG9jYWxlQ29tcGFyZShiLnRvTG93ZXJDYXNlKCksIFwicGxcIikpO1xuICAgIH1cblxuICAgIC8vIFx1MjUwMFx1MjUwMCBMaW5lIHBhcnNpbmcgXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXG5cbiAgICBwcml2YXRlIHBhcnNlTGVhZGluZ1RhZ3MobGluZVRleHQ6IHN0cmluZyk6IHsgaW5kZW50OiBzdHJpbmc7IHRhZ0Jsb2NrOiBzdHJpbmc7IHRhZ3M6IHN0cmluZ1tdOyBhZnRlcjogc3RyaW5nIH0ge1xuICAgICAgICBjb25zdCBpbmRlbnQgPSAobGluZVRleHQubWF0Y2goL15cXHMqLykgPz8gW1wiXCJdKVswXTtcbiAgICAgICAgY29uc3QgcmVzdCA9IGxpbmVUZXh0LnNsaWNlKGluZGVudC5sZW5ndGgpO1xuICAgICAgICBjb25zdCBtID0gcmVzdC5tYXRjaCgvXigoPzojW15cXHMjXStcXHMrKSopLyk7XG4gICAgICAgIGNvbnN0IHRhZ0Jsb2NrID0gbT8uWzFdID8/IFwiXCI7XG4gICAgICAgIGNvbnN0IHRhZ3MgPSB0YWdCbG9jay5tYXRjaCgvI1teXFxzI10rL2cpID8/IFtdO1xuICAgICAgICBjb25zdCBhZnRlciA9IHJlc3Quc2xpY2UodGFnQmxvY2subGVuZ3RoKTtcbiAgICAgICAgcmV0dXJuIHsgaW5kZW50LCB0YWdCbG9jaywgdGFncywgYWZ0ZXIgfTtcbiAgICB9XG5cbiAgICBwcml2YXRlIHNwbGl0QmxvY2tJZFN1ZmZpeChsaW5lVGV4dDogc3RyaW5nKTogeyBjb3JlOiBzdHJpbmc7IGJsb2NrSWQ6IHN0cmluZzsgdHJhaWxpbmdXczogc3RyaW5nIH0ge1xuICAgICAgICBjb25zdCB0cmFpbGluZ1dzID0gKGxpbmVUZXh0Lm1hdGNoKC9cXHMqJC8pID8/IFtcIlwiXSlbMF07XG4gICAgICAgIGNvbnN0IG5vVHJhaWwgPSBsaW5lVGV4dC5zbGljZSgwLCBsaW5lVGV4dC5sZW5ndGggLSB0cmFpbGluZ1dzLmxlbmd0aCk7XG5cbiAgICAgICAgY29uc3QgbSA9IG5vVHJhaWwubWF0Y2goLyhcXHNcXF5bXFxwe0x9XFxwe059Xy1dKykkL3UpO1xuICAgICAgICBpZiAoIW0pIHJldHVybiB7IGNvcmU6IG5vVHJhaWwsIGJsb2NrSWQ6IFwiXCIsIHRyYWlsaW5nV3MgfTtcblxuICAgICAgICBjb25zdCBibG9ja1dpdGhTcGFjZSA9IG1bMV07XG4gICAgICAgIGNvbnN0IGNvcmUgPSBub1RyYWlsLnNsaWNlKDAsIG5vVHJhaWwubGVuZ3RoIC0gYmxvY2tXaXRoU3BhY2UubGVuZ3RoKTtcbiAgICAgICAgY29uc3QgYmxvY2tJZCA9IGJsb2NrV2l0aFNwYWNlLnRyaW0oKTtcblxuICAgICAgICByZXR1cm4geyBjb3JlLCBibG9ja0lkLCB0cmFpbGluZ1dzIH07XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBwYXJzZVRyYWlsaW5nVGFncyhjb3JlVGV4dDogc3RyaW5nKTogeyBiZWZvcmU6IHN0cmluZzsgdGFnczogc3RyaW5nW10gfSB7XG4gICAgICAgIGNvbnN0IG0gPSBjb3JlVGV4dC5tYXRjaCgvKFxccysoPzojW15cXHMjXStcXHMqKSspJC8pO1xuICAgICAgICBpZiAoIW0pIHJldHVybiB7IGJlZm9yZTogY29yZVRleHQsIHRhZ3M6IFtdIH07XG5cbiAgICAgICAgY29uc3QgdGFnQmxvY2sgPSBtWzFdO1xuICAgICAgICBjb25zdCB0YWdzID0gdGFnQmxvY2subWF0Y2goLyNbXlxccyNdKy9nKSA/PyBbXTtcbiAgICAgICAgY29uc3QgYmVmb3JlID0gY29yZVRleHQuc2xpY2UoMCwgY29yZVRleHQubGVuZ3RoIC0gdGFnQmxvY2subGVuZ3RoKTtcbiAgICAgICAgcmV0dXJuIHsgYmVmb3JlLCB0YWdzIH07XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBidWlsZExpbmVXaXRoTGVhZGluZyhpbmRlbnQ6IHN0cmluZywgdGFnczogc3RyaW5nW10sIGFmdGVyOiBzdHJpbmcpOiBzdHJpbmcge1xuICAgICAgICBjb25zdCBhZnRlckNsZWFuID0gYWZ0ZXIucmVwbGFjZSgvXlxccysvLCBcIlwiKTtcbiAgICAgICAgY29uc3QgdGFnQmxvY2sgPSB0YWdzLmpvaW4oXCIgXCIpO1xuICAgICAgICBjb25zdCBib2R5ID0gdGFnQmxvY2sgPyAoYWZ0ZXJDbGVhbiA/IGAke3RhZ0Jsb2NrfSAke2FmdGVyQ2xlYW59YCA6IHRhZ0Jsb2NrKSA6IGFmdGVyQ2xlYW47XG4gICAgICAgIHJldHVybiBgJHtpbmRlbnR9JHtib2R5fWA7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBidWlsZExpbmVXaXRoVHJhaWxpbmcoYmVmb3JlOiBzdHJpbmcsIHRhZ3M6IHN0cmluZ1tdLCBibG9ja0lkOiBzdHJpbmcsIHRyYWlsaW5nV3M6IHN0cmluZyk6IHN0cmluZyB7XG4gICAgICAgIGNvbnN0IGJlZm9yZUNsZWFuID0gYmVmb3JlLnJlcGxhY2UoL1xccyskLywgXCJcIik7XG4gICAgICAgIGNvbnN0IHRhZ0Jsb2NrID0gdGFncy5qb2luKFwiIFwiKTtcbiAgICAgICAgY29uc3QgcGFydHM6IHN0cmluZ1tdID0gW107XG4gICAgICAgIGlmIChiZWZvcmVDbGVhbikgcGFydHMucHVzaChiZWZvcmVDbGVhbik7XG4gICAgICAgIGlmICh0YWdCbG9jaykgcGFydHMucHVzaCh0YWdCbG9jayk7XG4gICAgICAgIGlmIChibG9ja0lkKSBwYXJ0cy5wdXNoKGJsb2NrSWQpO1xuICAgICAgICByZXR1cm4gYCR7cGFydHMuam9pbihcIiBcIil9JHt0cmFpbGluZ1dzfWA7XG4gICAgfVxuXG4gICAgLy8gXHUyNTAwXHUyNTAwIENyZWF0ZSAvIFJlbW92ZSBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcblxuICAgIHByaXZhdGUgYXN5bmMgY3JlYXRlVGFnKGVkaXRvcjogRWRpdG9yLCBtb2RlOiBBbHRDbGlja1RhZ01vZGUsIGNhbmRpZGF0ZTogQ2FuZGlkYXRlKSB7XG4gICAgICAgIGNvbnN0IG5vcm1hbGl6ZWQgPSB0aGlzLm5vcm1hbGl6ZUNhbmRpZGF0ZShjYW5kaWRhdGUucmF3KTtcbiAgICAgICAgaWYgKCFub3JtYWxpemVkKSByZXR1cm47XG5cbiAgICAgICAgY29uc3QgdGFnVG9rZW4gPSB0aGlzLnRhZ1Rva2VuRm9yUGxhY2VtZW50KG5vcm1hbGl6ZWQsIG1vZGUpO1xuXG4gICAgICAgIGlmIChtb2RlID09PSBcImluLXBsYWNlXCIpIHtcbiAgICAgICAgICAgIGlmIChjYW5kaWRhdGUucmFuZ2UpIGVkaXRvci5yZXBsYWNlUmFuZ2UodGFnVG9rZW4sIGNhbmRpZGF0ZS5yYW5nZS5mcm9tLCBjYW5kaWRhdGUucmFuZ2UudG8pO1xuICAgICAgICAgICAgZWxzZSBlZGl0b3IucmVwbGFjZVNlbGVjdGlvbih0YWdUb2tlbik7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCBsaW5lID0gZWRpdG9yLmdldEN1cnNvcigpLmxpbmU7XG4gICAgICAgIGNvbnN0IGxpbmVUZXh0ID0gZWRpdG9yLmdldExpbmUobGluZSk7XG5cbiAgICAgICAgaWYgKG1vZGUgPT09IFwic3RhcnQtbGluZVwiKSB7XG4gICAgICAgICAgICBjb25zdCBsZWFkID0gdGhpcy5wYXJzZUxlYWRpbmdUYWdzKGxpbmVUZXh0KTtcbiAgICAgICAgICAgIGNvbnN0IG5leHQgPSB0aGlzLnNvcnRUYWdzKFsuLi5sZWFkLnRhZ3MsIHRhZ1Rva2VuXSk7XG4gICAgICAgICAgICBjb25zdCBuZXdMaW5lID0gdGhpcy5idWlsZExpbmVXaXRoTGVhZGluZyhsZWFkLmluZGVudCwgbmV4dCwgbGVhZC5hZnRlcik7XG4gICAgICAgICAgICBlZGl0b3IucmVwbGFjZVJhbmdlKG5ld0xpbmUsIHsgbGluZSwgY2g6IDAgfSwgeyBsaW5lLCBjaDogbGluZVRleHQubGVuZ3RoIH0pO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gZW5kLWxpbmU6IGluc2VydCBCRUZPUkUgdGhlIF5ibG9jay1pZCBzdWZmaXggKGlmIGFueSlcbiAgICAgICAgY29uc3Qgc3BsaXQgPSB0aGlzLnNwbGl0QmxvY2tJZFN1ZmZpeChsaW5lVGV4dCk7XG4gICAgICAgIGNvbnN0IHRyYWlsID0gdGhpcy5wYXJzZVRyYWlsaW5nVGFncyhzcGxpdC5jb3JlKTtcbiAgICAgICAgY29uc3QgbmV4dCA9IHRoaXMuc29ydFRhZ3MoWy4uLnRyYWlsLnRhZ3MsIHRhZ1Rva2VuXSk7XG4gICAgICAgIGNvbnN0IG5ld0xpbmUgPSB0aGlzLmJ1aWxkTGluZVdpdGhUcmFpbGluZyh0cmFpbC5iZWZvcmUsIG5leHQsIHNwbGl0LmJsb2NrSWQsIHNwbGl0LnRyYWlsaW5nV3MpO1xuICAgICAgICBlZGl0b3IucmVwbGFjZVJhbmdlKG5ld0xpbmUsIHsgbGluZSwgY2g6IDAgfSwgeyBsaW5lLCBjaDogbGluZVRleHQubGVuZ3RoIH0pO1xuICAgIH1cblxuICAgIHByaXZhdGUgYXN5bmMgc3RyaXBIYXNoRnJvbVRhZyhlZGl0b3I6IEVkaXRvciwgY2FuZGlkYXRlOiBDYW5kaWRhdGUpIHtcbiAgICAgICAgaWYgKCFjYW5kaWRhdGUucmFuZ2UpIHJldHVybjtcblxuICAgICAgICBjb25zdCBsaW5lID0gY2FuZGlkYXRlLnJhbmdlLmZyb20ubGluZTtcbiAgICAgICAgaWYgKGNhbmRpZGF0ZS5yYW5nZS50by5saW5lICE9PSBsaW5lKSByZXR1cm47XG5cbiAgICAgICAgY29uc3QgbGluZVRleHQgPSBlZGl0b3IuZ2V0TGluZShsaW5lKTtcbiAgICAgICAgY29uc3QgZnJvbUNoID0gY2FuZGlkYXRlLnJhbmdlLmZyb20uY2g7XG4gICAgICAgIGNvbnN0IHRvQ2ggPSBjYW5kaWRhdGUucmFuZ2UudG8uY2g7XG5cbiAgICAgICAgY29uc3Qgc2VsZWN0ZWQgPSBlZGl0b3IuZ2V0UmFuZ2UoY2FuZGlkYXRlLnJhbmdlLmZyb20sIGNhbmRpZGF0ZS5yYW5nZS50byk7XG4gICAgICAgIGlmICghc2VsZWN0ZWQgfHwgIXNlbGVjdGVkLnN0YXJ0c1dpdGgoXCIjXCIpKSByZXR1cm47XG5cbiAgICAgICAgY29uc3QgYmVmb3JlVGFnID0gbGluZVRleHQuc2xpY2UoMCwgZnJvbUNoKTtcbiAgICAgICAgY29uc3QgYWZ0ZXJUYWcgPSBsaW5lVGV4dC5zbGljZSh0b0NoKTtcblxuICAgICAgICBpZiAoYmVmb3JlVGFnLmVuZHNXaXRoKFwiW1wiKSAmJiBhZnRlclRhZy5zdGFydHNXaXRoKGBdKCR7c2VsZWN0ZWR9KWApKSB7XG4gICAgICAgICAgICBsZXQgZXhwYW5kZWRGcm9tID0gZnJvbUNoIC0gMTsgXG4gICAgICAgICAgICBsZXQgZXhwYW5kZWRUbyA9IHRvQ2ggKyAzICsgc2VsZWN0ZWQubGVuZ3RoOyBcblxuICAgICAgICAgICAgaWYgKGV4cGFuZGVkVG8gPCBsaW5lVGV4dC5sZW5ndGggJiYgbGluZVRleHQuY2hhckF0KGV4cGFuZGVkVG8pID09PSBcIiBcIikgZXhwYW5kZWRUbysrO1xuICAgICAgICAgICAgZWxzZSBpZiAoZXhwYW5kZWRGcm9tID4gMCAmJiBsaW5lVGV4dC5jaGFyQXQoZXhwYW5kZWRGcm9tIC0gMSkgPT09IFwiIFwiKSBleHBhbmRlZEZyb20tLTtcblxuICAgICAgICAgICAgZWRpdG9yLnJlcGxhY2VSYW5nZShzZWxlY3RlZC5zbGljZSgxKSwgeyBsaW5lLCBjaDogZXhwYW5kZWRGcm9tIH0sIHsgbGluZSwgY2g6IGV4cGFuZGVkVG8gfSk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICBlZGl0b3IucmVwbGFjZVJhbmdlKHNlbGVjdGVkLnNsaWNlKDEpLCBjYW5kaWRhdGUucmFuZ2UuZnJvbSwgY2FuZGlkYXRlLnJhbmdlLnRvKTtcbiAgICB9XG5cbiAgICBwcml2YXRlIGFzeW5jIHJlbW92ZVRhZyhlZGl0b3I6IEVkaXRvciwgY2FuZGlkYXRlOiBDYW5kaWRhdGUpIHtcbiAgICAgICAgY29uc3Qgbm9ybWFsaXplZCA9IHRoaXMubm9ybWFsaXplQ2FuZGlkYXRlKGNhbmRpZGF0ZS5yYXcpO1xuICAgICAgICBpZiAoIW5vcm1hbGl6ZWQpIHJldHVybjtcblxuICAgICAgICBjb25zdCBrZXkgPSBub3JtYWxpemVkLnRvTG93ZXJDYXNlKCk7XG4gICAgICAgIGNvbnN0IGN1cnNvciA9IGVkaXRvci5nZXRDdXJzb3IoKTtcbiAgICAgICAgY29uc3QgbGluZSA9IGNhbmRpZGF0ZS5yYW5nZT8uZnJvbT8ubGluZSA/PyBjdXJzb3IubGluZTtcblxuICAgICAgICBpZiAoY2FuZGlkYXRlLnJhbmdlICYmIChjYW5kaWRhdGUucmFuZ2UuZnJvbS5saW5lICE9PSBsaW5lIHx8IGNhbmRpZGF0ZS5yYW5nZS50by5saW5lICE9PSBsaW5lKSkgcmV0dXJuO1xuXG4gICAgICAgIGNvbnN0IGxpbmVUZXh0ID0gZWRpdG9yLmdldExpbmUobGluZSk7XG4gICAgICAgIGNvbnN0IGNoID0gY2FuZGlkYXRlLnJhbmdlPy5mcm9tPy5jaCA/PyBjdXJzb3IuY2g7XG5cbiAgICAgICAgY29uc3QgbGVhZCA9IHRoaXMucGFyc2VMZWFkaW5nVGFncyhsaW5lVGV4dCk7XG4gICAgICAgIGNvbnN0IHNwbGl0ID0gdGhpcy5zcGxpdEJsb2NrSWRTdWZmaXgobGluZVRleHQpO1xuICAgICAgICBjb25zdCB0cmFpbCA9IHRoaXMucGFyc2VUcmFpbGluZ1RhZ3Moc3BsaXQuY29yZSk7XG5cbiAgICAgICAgY29uc3QgbGVhZFN0YXJ0ID0gMDtcbiAgICAgICAgY29uc3QgbGVhZEVuZCA9IGxlYWQuaW5kZW50Lmxlbmd0aCArIGxlYWQudGFnQmxvY2subGVuZ3RoO1xuICAgICAgICBjb25zdCB0cmFpbFN0YXJ0ID0gdHJhaWwuYmVmb3JlLmxlbmd0aDtcbiAgICAgICAgY29uc3QgdHJhaWxFbmQgPSBzcGxpdC5jb3JlLmxlbmd0aDtcblxuICAgICAgICBjb25zdCBpbkxlYWRpbmcgPSBjaCA+PSBsZWFkU3RhcnQgJiYgY2ggPCBsZWFkRW5kO1xuICAgICAgICBjb25zdCBpblRyYWlsaW5nID0gY2ggPj0gdHJhaWxTdGFydCAmJiBjaCA8IHRyYWlsRW5kO1xuXG4gICAgICAgIC8vIDEuIFJlbW92ZSBmcm9tIGxlYWRpbmcgYmxvY2sgT05MWSBpZiBjbGlja2VkIGluc2lkZSBpdFxuICAgICAgICBpZiAoaW5MZWFkaW5nKSB7XG4gICAgICAgICAgICBjb25zdCBsZWFkSGFzID0gbGVhZC50YWdzLnNvbWUodCA9PiB0LnJlcGxhY2UoL14jLywgXCJcIikudG9Mb3dlckNhc2UoKSA9PT0ga2V5KTtcbiAgICAgICAgICAgIGlmIChsZWFkSGFzKSB7XG4gICAgICAgICAgICAgICAgY29uc3Qga2VwdCA9IGxlYWQudGFncy5maWx0ZXIodCA9PiB0LnJlcGxhY2UoL14jLywgXCJcIikudG9Mb3dlckNhc2UoKSAhPT0ga2V5KTtcbiAgICAgICAgICAgICAgICBjb25zdCBuZXdMaW5lID0gdGhpcy5idWlsZExpbmVXaXRoTGVhZGluZyhsZWFkLmluZGVudCwga2VwdCwgbGVhZC5hZnRlcik7XG4gICAgICAgICAgICAgICAgZWRpdG9yLnJlcGxhY2VSYW5nZShuZXdMaW5lLCB7IGxpbmUsIGNoOiAwIH0sIHsgbGluZSwgY2g6IGxpbmVUZXh0Lmxlbmd0aCB9KTtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICAvLyAyLiBSZW1vdmUgZnJvbSB0cmFpbGluZyBibG9jayBPTkxZIGlmIGNsaWNrZWQgaW5zaWRlIGl0XG4gICAgICAgIGlmIChpblRyYWlsaW5nKSB7XG4gICAgICAgICAgICBjb25zdCB0cmFpbEhhcyA9IHRyYWlsLnRhZ3Muc29tZSh0ID0+IHQucmVwbGFjZSgvXiMvLCBcIlwiKS50b0xvd2VyQ2FzZSgpID09PSBrZXkpO1xuICAgICAgICAgICAgaWYgKHRyYWlsSGFzKSB7XG4gICAgICAgICAgICAgICAgY29uc3Qga2VwdCA9IHRyYWlsLnRhZ3MuZmlsdGVyKHQgPT4gdC5yZXBsYWNlKC9eIy8sIFwiXCIpLnRvTG93ZXJDYXNlKCkgIT09IGtleSk7XG4gICAgICAgICAgICAgICAgY29uc3QgbmV3TGluZSA9IHRoaXMuYnVpbGRMaW5lV2l0aFRyYWlsaW5nKHRyYWlsLmJlZm9yZSwga2VwdCwgc3BsaXQuYmxvY2tJZCwgc3BsaXQudHJhaWxpbmdXcyk7XG4gICAgICAgICAgICAgICAgZWRpdG9yLnJlcGxhY2VSYW5nZShuZXdMaW5lLCB7IGxpbmUsIGNoOiAwIH0sIHsgbGluZSwgY2g6IGxpbmVUZXh0Lmxlbmd0aCB9KTtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICAvLyAzLiBJbmxpbmUgdGFnIG9yIG1hcmtkb3duLWxpbmsgdGFnIHJlbW92YWxcbiAgICAgICAgaWYgKGNhbmRpZGF0ZS5yYW5nZSkge1xuICAgICAgICAgICAgY29uc3QgZnJvbUNoID0gY2FuZGlkYXRlLnJhbmdlLmZyb20uY2g7XG4gICAgICAgICAgICBjb25zdCB0b0NoID0gY2FuZGlkYXRlLnJhbmdlLnRvLmNoO1xuICAgICAgICAgICAgY29uc3Qgc2VsZWN0ZWQgPSBlZGl0b3IuZ2V0UmFuZ2UoY2FuZGlkYXRlLnJhbmdlLmZyb20sIGNhbmRpZGF0ZS5yYW5nZS50byk7XG5cbiAgICAgICAgICAgIGlmIChzZWxlY3RlZCAmJiBzZWxlY3RlZC5zdGFydHNXaXRoKFwiI1wiKSkge1xuICAgICAgICAgICAgICAgIGNvbnN0IGJlZm9yZVRhZyA9IGxpbmVUZXh0LnNsaWNlKDAsIGZyb21DaCk7XG4gICAgICAgICAgICAgICAgY29uc3QgYWZ0ZXJUYWcgPSBsaW5lVGV4dC5zbGljZSh0b0NoKTtcblxuICAgICAgICAgICAgICAgIC8vIEVkZ2UgY2FzZTogVXNlciB3YW50cyB0byByZW1vdmUgYSB0YWcgZm9ybWF0dGVkIGFzIGEgbWFya2Rvd24gbGluayBgWyN0YWddKCN0YWcpYFxuICAgICAgICAgICAgICAgIGlmIChiZWZvcmVUYWcuZW5kc1dpdGgoXCJbXCIpICYmIGFmdGVyVGFnLnN0YXJ0c1dpdGgoYF0oJHtzZWxlY3RlZH0pYCkpIHtcbiAgICAgICAgICAgICAgICAgICAgbGV0IGV4cGFuZGVkRnJvbSA9IGZyb21DaCAtIDE7XG4gICAgICAgICAgICAgICAgICAgIGxldCBleHBhbmRlZFRvID0gdG9DaCArIDMgKyBzZWxlY3RlZC5sZW5ndGg7IC8vIGxlbmd0aCBvZiBgXShgICsgdGFnICsgYClgXG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICBpZiAoZXhwYW5kZWRUbyA8IGxpbmVUZXh0Lmxlbmd0aCAmJiBsaW5lVGV4dC5jaGFyQXQoZXhwYW5kZWRUbykgPT09ICcgJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgZXhwYW5kZWRUbysrO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGV4cGFuZGVkRnJvbSA+IDAgJiYgbGluZVRleHQuY2hhckF0KGV4cGFuZGVkRnJvbSAtIDEpID09PSAnICcpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGV4cGFuZGVkRnJvbS0tO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICBlZGl0b3IucmVwbGFjZVJhbmdlKFwiXCIsIHsgbGluZSwgY2g6IGV4cGFuZGVkRnJvbSB9LCB7IGxpbmUsIGNoOiBleHBhbmRlZFRvIH0pO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIFN0YW5kYXJkIGlubGluZSB0YWc6IHN0cmlwIHRoZSAnIydcbiAgICAgICAgICAgICAgICAgICAgZWRpdG9yLnJlcGxhY2VSYW5nZShzZWxlY3RlZC5zbGljZSgxKSwgY2FuZGlkYXRlLnJhbmdlLmZyb20sIGNhbmRpZGF0ZS5yYW5nZS50byk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgLy8gXHUyNTAwXHUyNTAwIFNldHRpbmdzIFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFxuXG4gICAgYXN5bmMgbG9hZFNldHRpbmdzKCkge1xuICAgICAgICBjb25zdCBsb2FkZWQgPSAoYXdhaXQgdGhpcy5sb2FkRGF0YSgpKSA/PyB7fTtcbiAgICAgICAgY29uc3QgYW55TG9hZGVkID0gbG9hZGVkIGFzIFBhcnRpYWw8RmxhdFRhZ1BsdWdpblNldHRpbmdzPiAmIFJlY29yZDxzdHJpbmcsIHVua25vd24+O1xuXG4gICAgICAgIGNvbnN0IG1vZGUgPSBhbnlMb2FkZWQuYWx0Q2xpY2tUYWdNb2RlO1xuXG4gICAgICAgIHRoaXMuc2V0dGluZ3MgPSB7XG4gICAgICAgICAgICBwaW5uZWRUYWdzOiBBcnJheS5pc0FycmF5KGFueUxvYWRlZC5waW5uZWRUYWdzKVxuICAgICAgICAgICAgICAgID8gKGFueUxvYWRlZC5waW5uZWRUYWdzIGFzIHVua25vd25bXSkuZmlsdGVyKCh0KTogdCBpcyBzdHJpbmcgPT4gdHlwZW9mIHQgPT09IFwic3RyaW5nXCIpXG4gICAgICAgICAgICAgICAgOiBERUZBVUxUX1NFVFRJTkdTLnBpbm5lZFRhZ3MsXG5cbiAgICAgICAgICAgIGZyZXF1ZW5jeUN1dG9mZjogKHR5cGVvZiBhbnlMb2FkZWQuZnJlcXVlbmN5Q3V0b2ZmID09PSBcIm51bWJlclwiICYmICFpc05hTihhbnlMb2FkZWQuZnJlcXVlbmN5Q3V0b2ZmKSlcbiAgICAgICAgICAgICAgICA/IE1hdGgubWF4KDAsIE1hdGguZmxvb3IoYW55TG9hZGVkLmZyZXF1ZW5jeUN1dG9mZikpXG4gICAgICAgICAgICAgICAgOiBERUZBVUxUX1NFVFRJTkdTLmZyZXF1ZW5jeUN1dG9mZixcblxuICAgICAgICAgICAgZnJlcXVlbmN5Q3V0b2ZmRW5hYmxlZDogdHlwZW9mIGFueUxvYWRlZC5mcmVxdWVuY3lDdXRvZmZFbmFibGVkID09PSBcImJvb2xlYW5cIlxuICAgICAgICAgICAgICAgID8gYW55TG9hZGVkLmZyZXF1ZW5jeUN1dG9mZkVuYWJsZWRcbiAgICAgICAgICAgICAgICA6IERFRkFVTFRfU0VUVElOR1MuZnJlcXVlbmN5Q3V0b2ZmRW5hYmxlZCxcblxuICAgICAgICAgICAgYWx0Q2xpY2tUYWdNb2RlOiAobW9kZSA9PT0gXCJzdGFydC1saW5lXCIgfHwgbW9kZSA9PT0gXCJpbi1wbGFjZVwiIHx8IG1vZGUgPT09IFwiZW5kLWxpbmVcIilcbiAgICAgICAgICAgICAgICA/IG1vZGVcbiAgICAgICAgICAgICAgICA6IERFRkFVTFRfU0VUVElOR1MuYWx0Q2xpY2tUYWdNb2RlLFxuXG4gICAgICAgICAgICBtb2JpbGVMb25nUHJlc3NFbmFibGVkOiB0eXBlb2YgYW55TG9hZGVkLm1vYmlsZUxvbmdQcmVzc0VuYWJsZWQgPT09IFwiYm9vbGVhblwiXG4gICAgICAgICAgICAgICAgPyBhbnlMb2FkZWQubW9iaWxlTG9uZ1ByZXNzRW5hYmxlZFxuICAgICAgICAgICAgICAgIDogREVGQVVMVF9TRVRUSU5HUy5tb2JpbGVMb25nUHJlc3NFbmFibGVkLFxuXG4gICAgICAgICAgICBtb2JpbGVMb25nUHJlc3NNczogKHR5cGVvZiBhbnlMb2FkZWQubW9iaWxlTG9uZ1ByZXNzTXMgPT09IFwibnVtYmVyXCIgJiYgIWlzTmFOKGFueUxvYWRlZC5tb2JpbGVMb25nUHJlc3NNcykpXG4gICAgICAgICAgICAgICAgPyBNYXRoLm1heCgyNTAsIE1hdGgubWluKDUwMDAsIE1hdGguZmxvb3IoYW55TG9hZGVkLm1vYmlsZUxvbmdQcmVzc01zKSkpXG4gICAgICAgICAgICAgICAgOiBERUZBVUxUX1NFVFRJTkdTLm1vYmlsZUxvbmdQcmVzc01zLFxuXG4gICAgICAgICAgICBzaG93UGxhY2VtZW50SW5TdGF0dXNCYXI6IHR5cGVvZiBhbnlMb2FkZWQuc2hvd1BsYWNlbWVudEluU3RhdHVzQmFyID09PSBcImJvb2xlYW5cIlxuICAgICAgICAgICAgICAgID8gYW55TG9hZGVkLnNob3dQbGFjZW1lbnRJblN0YXR1c0JhclxuICAgICAgICAgICAgICAgIDogREVGQVVMVF9TRVRUSU5HUy5zaG93UGxhY2VtZW50SW5TdGF0dXNCYXIsXG4gICAgICAgIH0gYXMgRmxhdFRhZ1BsdWdpblNldHRpbmdzO1xuXG4gICAgICAgIC8vIFBlcnNpc3QgaW1tZWRpYXRlbHkgdG8gZHJvcCBzdGFsZSBrZXlzIGFuZCBiYWNrZmlsbCBuZXcgZGVmYXVsdHNcbiAgICAgICAgYXdhaXQgdGhpcy5zYXZlRGF0YSh0aGlzLnNldHRpbmdzKTtcbiAgICB9XG5cbiAgICBhc3luYyBzYXZlU2V0dGluZ3MoKSB7XG4gICAgICAgIGF3YWl0IHRoaXMuc2F2ZURhdGEodGhpcy5zZXR0aW5ncyk7XG4gICAgICAgIHRoaXMuYXBwLndvcmtzcGFjZS50cmlnZ2VyKFwiZmxhdC10YWctdmlldzpzZXR0aW5ncy11cGRhdGVkXCIpO1xuICAgICAgICB0aGlzLnVwZGF0ZVN0YXR1c0JhcigpO1xuICAgIH1cblxuICAgIC8vIFx1MjUwMFx1MjUwMCBWaWV3IGFjdGl2YXRpb24gLyBzdHlsZSBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcblxuICAgIGFzeW5jIGFjdGl2YXRlVmlldygpIHtcbiAgICAgICAgY29uc3Qgd29ya3NwYWNlID0gdGhpcy5hcHAud29ya3NwYWNlO1xuICAgICAgICBsZXQgbGVhZiA9IHdvcmtzcGFjZS5nZXRMZWF2ZXNPZlR5cGUoVklFV19UWVBFKVswXTtcblxuICAgICAgICBpZiAoIWxlYWYpIHtcbiAgICAgICAgICAgIGNvbnN0IHJpZ2h0TGVhZiA9IHdvcmtzcGFjZS5nZXRSaWdodExlYWYoZmFsc2UpO1xuICAgICAgICAgICAgaWYgKCFyaWdodExlYWYpIHJldHVybjtcbiAgICAgICAgICAgIGxlYWYgPSByaWdodExlYWY7XG4gICAgICAgICAgICBhd2FpdCBsZWFmLnNldFZpZXdTdGF0ZSh7IHR5cGU6IFZJRVdfVFlQRSB9KTtcbiAgICAgICAgfVxuXG4gICAgICAgIHdvcmtzcGFjZS5yZXZlYWxMZWFmKGxlYWYpO1xuICAgIH1cblxuICAgIHByaXZhdGUgYWRkU3R5bGUoKSB7XG4gICAgICAgIGNvbnN0IHN0eWxlRWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwic3R5bGVcIik7XG4gICAgICAgIHN0eWxlRWwuaW5uZXJIVE1MID0gZ2V0U3R5bGVzKCk7XG4gICAgICAgIGRvY3VtZW50LmhlYWQuYXBwZW5kQ2hpbGQoc3R5bGVFbCk7XG4gICAgfVxufSIsICJleHBvcnQgY29uc3QgVklFV19UWVBFID0gXCJmbGF0LXRhZy12aWV3XCI7XG4iLCAiaW1wb3J0IHsgSXRlbVZpZXcsIFBsYXRmb3JtLCBzZXRJY29uLCBURmlsZSwgV29ya3NwYWNlTGVhZiwgTm90aWNlLCBNb2RhbCwgQXBwLCBTZXR0aW5nLCBCdXR0b25Db21wb25lbnQsIE1lbnUgfSBmcm9tIFwib2JzaWRpYW5cIjtcbmltcG9ydCB7IFZJRVdfVFlQRSB9IGZyb20gXCIuL2NvbnN0YW50c1wiO1xuaW1wb3J0IEZsYXRUYWdQbHVnaW4gZnJvbSBcIi4vbWFpblwiO1xuXG50eXBlIFNvcnRNb2RlID0gXCJhelwiIHwgXCJjb3VudFwiO1xudHlwZSBTZWFyY2hNb2RlID0gXCJub3RlXCIgfCBcImxpbmVcIiB8IFwidGFza1wiIHwgXCJ0YXNrLXRvZG9cIiB8IFwidGFzay1kb25lXCI7XG5cbi8vIFx1MjUwMFx1MjUwMCBHbG9iYWwgTXV0ZSBDb25maXJtYXRpb24gTW9kYWwgXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXG5jbGFzcyBHbG9iYWxNdXRlQ29uZmlybU1vZGFsIGV4dGVuZHMgTW9kYWwge1xuXHR0YWdUb011dGU6IHN0cmluZztcblx0b25Db25maXJtOiAoKSA9PiB2b2lkO1xuXG5cdGNvbnN0cnVjdG9yKGFwcDogQXBwLCB0YWdUb011dGU6IHN0cmluZywgb25Db25maXJtOiAoKSA9PiB2b2lkKSB7XG5cdFx0c3VwZXIoYXBwKTtcblx0XHR0aGlzLnRhZ1RvTXV0ZSA9IHRhZ1RvTXV0ZTtcblx0XHR0aGlzLm9uQ29uZmlybSA9IG9uQ29uZmlybTtcblx0fVxuXG5cdG9uT3BlbigpIHtcblx0XHRjb25zdCB7IGNvbnRlbnRFbCB9ID0gdGhpcztcblx0XHRjb250ZW50RWwuZW1wdHkoKTtcblx0XHRjb250ZW50RWwuY3JlYXRlRWwoXCJoMlwiLCB7IHRleHQ6IFwiR2xvYmFsIE11dGUgVGFnXCIgfSk7XG5cdFx0XG5cdFx0Y29uc3QgaXNDdXJyZW50bHlNdXRlZCA9IHRoaXMudGFnVG9NdXRlLnN0YXJ0c1dpdGgoXCIlXCIpO1xuXHRcdGNvbnN0IHRhcmdldFN0YXRlID0gaXNDdXJyZW50bHlNdXRlZCA/IFwiVU4tTVVURVwiIDogXCJNVVRFXCI7XG5cdFx0Y29uc3QgcmVzdWx0aW5nVGFnID0gaXNDdXJyZW50bHlNdXRlZCBcblx0XHRcdD8gYCMke3RoaXMudGFnVG9NdXRlLnNsaWNlKDEpfWAgXG5cdFx0XHQ6IGAjJSR7dGhpcy50YWdUb011dGV9YDtcblxuXHRcdGNvbnRlbnRFbC5jcmVhdGVFbChcInBcIiwgeyBcblx0XHRcdHRleHQ6IGBBcmUgeW91IHN1cmUgeW91IHdhbnQgdG8gZ2xvYmFsbHkgJHt0YXJnZXRTdGF0ZX0gdGhlIHRhZyAjJHt0aGlzLnRhZ1RvTXV0ZX0/YFxuXHRcdH0pO1xuXHRcdGNvbnRlbnRFbC5jcmVhdGVFbChcInBcIiwgeyBcblx0XHRcdHRleHQ6IGBUaGlzIHdpbGwgc2VhcmNoIHlvdXIgZW50aXJlIHZhdWx0IGFuZCBjaGFuZ2UgZXZlcnkgaW5zdGFuY2UgdG8gJHtyZXN1bHRpbmdUYWd9LiBUaGlzIGFjdGlvbiBtb2RpZmllcyB5b3VyIGZpbGVzIGFuZCBjYW5ub3QgYmUgZWFzaWx5IHVuZG9uZS5gIFxuXHRcdH0pO1xuXG5cdFx0bmV3IFNldHRpbmcoY29udGVudEVsKVxuXHRcdFx0LmFkZEJ1dHRvbigoYnRuOiBCdXR0b25Db21wb25lbnQpID0+XG5cdFx0XHRcdGJ0blxuXHRcdFx0XHRcdC5zZXRCdXR0b25UZXh0KFwiQ2FuY2VsXCIpXG5cdFx0XHRcdFx0Lm9uQ2xpY2soKCkgPT4gdGhpcy5jbG9zZSgpKVxuXHRcdFx0KVxuXHRcdFx0LmFkZEJ1dHRvbigoYnRuOiBCdXR0b25Db21wb25lbnQpID0+XG5cdFx0XHRcdGJ0blxuXHRcdFx0XHRcdC5zZXRCdXR0b25UZXh0KGBZZXMsICR7dGFyZ2V0U3RhdGV9IEdsb2JhbGx5YClcblx0XHRcdFx0XHQuc2V0Q3RhKClcblx0XHRcdFx0XHQub25DbGljaygoKSA9PiB7XG5cdFx0XHRcdFx0XHR0aGlzLm9uQ29uZmlybSgpO1xuXHRcdFx0XHRcdFx0dGhpcy5jbG9zZSgpO1xuXHRcdFx0XHRcdH0pXG5cdFx0XHQpO1xuXHR9XG5cblx0b25DbG9zZSgpIHtcblx0XHRjb25zdCB7IGNvbnRlbnRFbCB9ID0gdGhpcztcblx0XHRjb250ZW50RWwuZW1wdHkoKTtcblx0fVxufVxuLy8gXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXG5cbmV4cG9ydCBjbGFzcyBGbGF0VGFnVmlldyBleHRlbmRzIEl0ZW1WaWV3IHtcblx0cHVibGljIHBsdWdpbjogRmxhdFRhZ1BsdWdpbjtcblxuXHRwcml2YXRlIGNvbnRhaW5lciE6IEhUTUxFbGVtZW50O1xuXHRwcml2YXRlIHRhZ0NvbnRhaW5lciE6IEhUTUxFbGVtZW50O1xuXG5cdHByaXZhdGUgc29ydENvbnRhaW5lciE6IEhUTUxFbGVtZW50O1xuXHRwcml2YXRlIHNvcnRBekJ0biE6IEhUTUxFbGVtZW50O1xuXHRwcml2YXRlIHNvcnRDb3VudEJ0biE6IEhUTUxFbGVtZW50O1xuXG5cdHByaXZhdGUgc2NvcGVCdG4hOiBIVE1MRWxlbWVudDtcblx0cHJpdmF0ZSB0YXNrQnRuITogSFRNTEVsZW1lbnQ7XG5cblx0cHJpdmF0ZSBjdXRvZmZUb2dnbGVCdG4hOiBIVE1MRWxlbWVudDtcblx0cHJpdmF0ZSBjdXRvZmZJbnB1dCE6IEhUTUxJbnB1dEVsZW1lbnQ7XG5cblx0cHJpdmF0ZSBzZWxlY3RlZFRhZ3M6IFNldDxzdHJpbmc+ID0gbmV3IFNldCgpO1xuXHRwcml2YXRlIGV4Y2x1ZGVkVGFnczogU2V0PHN0cmluZz4gPSBuZXcgU2V0KCk7XG5cblx0cHJpdmF0ZSBhbGxUYWdzOiBNYXA8c3RyaW5nLCBudW1iZXI+ID0gbmV3IE1hcCgpO1xuXHRwcml2YXRlIHRhZ3NCeUZpbGU6IE1hcDxzdHJpbmcsIHN0cmluZ1tdPiA9IG5ldyBNYXAoKTtcblxuXHRwcml2YXRlIGN1cnJlbnRTb3J0OiBTb3J0TW9kZSA9IFwiYXpcIjtcblx0cHJpdmF0ZSBzZWFyY2hNb2RlOiBTZWFyY2hNb2RlID0gXCJub3RlXCI7XG5cblx0cHJpdmF0ZSB0YWdTZWFyY2hUZXh0ID0gXCJcIjtcblxuXHRwcml2YXRlIHRvdWNoVGltZXI6IG51bWJlciB8IG51bGwgPSBudWxsO1xuXHRwcml2YXRlIGxhc3RJbnRlcmFjdGlvbldhc1RvdWNoID0gZmFsc2U7XG5cdHByaXZhdGUgcmVuZGVySWQgPSAwO1xuXG5cdGNvbnN0cnVjdG9yKGxlYWY6IFdvcmtzcGFjZUxlYWYsIHBsdWdpbjogRmxhdFRhZ1BsdWdpbikge1xuXHRcdHN1cGVyKGxlYWYpO1xuXHRcdHRoaXMucGx1Z2luID0gcGx1Z2luO1xuXHRcdHRoaXMuY29udGFpbmVyRWwuYWRkQ2xhc3MoXCJmbGF0LXRhZy12aWV3XCIpO1xuXHR9XG5cblx0Z2V0Vmlld1R5cGUoKTogc3RyaW5nIHsgcmV0dXJuIFZJRVdfVFlQRTsgfVxuXHRnZXREaXNwbGF5VGV4dCgpOiBzdHJpbmcgeyByZXR1cm4gXCJGbGF0IFRhZ3NcIjsgfVxuXHRnZXRJY29uKCk6IHN0cmluZyB7IHJldHVybiBcInRhZ1wiOyB9XG5cblx0YXN5bmMgb25PcGVuKCkge1xuXHRcdHRoaXMuY29udGFpbmVyID0gdGhpcy5jb250ZW50RWwuY3JlYXRlRGl2KHsgY2xzOiBcImZsYXQtdGFnLWNvbnRhaW5lclwiIH0pO1xuXG5cdFx0dGhpcy5jb250YWluZXJFbC5hZGRFdmVudExpc3RlbmVyKFwidG91Y2hzdGFydFwiLCAoKSA9PiB7XG5cdFx0XHR0aGlzLmxhc3RJbnRlcmFjdGlvbldhc1RvdWNoID0gdHJ1ZTtcblx0XHR9LCB7IHBhc3NpdmU6IHRydWUgfSk7XG5cblx0XHR0aGlzLmNvbnRhaW5lckVsLmFkZEV2ZW50TGlzdGVuZXIoXCJwb2ludGVyZG93blwiLCAoZTogUG9pbnRlckV2ZW50KSA9PiB7XG5cdFx0XHRpZiAoZS5wb2ludGVyVHlwZSAmJiBlLnBvaW50ZXJUeXBlICE9PSBcInRvdWNoXCIpIHRoaXMubGFzdEludGVyYWN0aW9uV2FzVG91Y2ggPSBmYWxzZTtcblx0XHR9LCB7IHBhc3NpdmU6IHRydWUgfSk7XG5cblx0XHR0aGlzLnNvcnRDb250YWluZXIgPSB0aGlzLmNvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6IFwiZmxhdC10YWctc29ydC1jb250YWluZXJcIiB9KTtcblx0XHRjb25zdCBidXR0b25TZWN0aW9uID0gdGhpcy5zb3J0Q29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogXCJmbGF0LXRhZy1idXR0b25zLXNlY3Rpb25cIiB9KTtcblxuXHRcdHRoaXMuc29ydEF6QnRuID0gYnV0dG9uU2VjdGlvbi5jcmVhdGVEaXYoeyBjbHM6IFwiZmxhdC10YWctc29ydC1idXR0b25cIiwgdGl0bGU6IFwiU29ydCBBLVpcIiB9KTtcblx0XHRzZXRJY29uKHRoaXMuc29ydEF6QnRuLCBcImx1Y2lkZS1zb3J0LWFzY1wiKTtcblxuXHRcdHRoaXMuc29ydENvdW50QnRuID0gYnV0dG9uU2VjdGlvbi5jcmVhdGVEaXYoeyBjbHM6IFwiZmxhdC10YWctc29ydC1idXR0b25cIiwgdGl0bGU6IFwiU29ydCBieSB1c2FnZVwiIH0pO1xuXHRcdHNldEljb24odGhpcy5zb3J0Q291bnRCdG4sIFwibHVjaWRlLWJhci1jaGFydC0yXCIpO1xuXG5cdFx0Y29uc3QgY2xlYXJCdXR0b24gPSBidXR0b25TZWN0aW9uLmNyZWF0ZURpdih7IGNsczogXCJmbGF0LXRhZy1jbGVhci1idXR0b25cIiwgdGl0bGU6IFwiQ2xlYXIgdGFnIHNlbGVjdGlvbnNcIiB9KTtcblx0XHRzZXRJY29uKGNsZWFyQnV0dG9uLCBcInhcIik7XG5cdFx0Y2xlYXJCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHRoaXMuY2xlYXJUYWdTZWxlY3Rpb25zKCkpO1xuXG5cdFx0dGhpcy5zY29wZUJ0biA9IGJ1dHRvblNlY3Rpb24uY3JlYXRlRGl2KHtcblx0XHRcdGNsczogXCJmbGF0LXRhZy1tb2RlLWJ1dHRvblwiLCB0ZXh0OiBcIk5PVEVcIiwgdGl0bGU6IFwiQ2xpY2sgdG8gY3ljbGU6IE5vdGUgLT4gTGluZVwiLFxuXHRcdH0pO1xuXHRcdHRoaXMudGFza0J0biA9IGJ1dHRvblNlY3Rpb24uY3JlYXRlRGl2KHtcblx0XHRcdGNsczogXCJmbGF0LXRhZy1tb2RlLWJ1dHRvblwiLCB0ZXh0OiBcIlRBU0stQUxMXCIsIHRpdGxlOiBcIkNsaWNrIHRvIGN5Y2xlOiBBbGwgLT4gVG9kbyAtPiBEb25lXCIsXG5cdFx0fSk7XG5cblx0XHRjb25zdCBjdXRvZmZTcGFjZXIgPSBidXR0b25TZWN0aW9uLmNyZWF0ZURpdih7IGNsczogXCJmbGF0LXRhZy1jdXRvZmYtc3BhY2VyXCIgfSk7XG5cdFx0Y3V0b2ZmU3BhY2VyLmFyaWFIaWRkZW4gPSBcInRydWVcIjtcblxuXHRcdGNvbnN0IGN1dG9mZlNlY3Rpb24gPSBidXR0b25TZWN0aW9uLmNyZWF0ZURpdih7IGNsczogXCJmbGF0LXRhZy1jdXRvZmYtc2VjdGlvblwiIH0pO1xuXHRcdHRoaXMuY3V0b2ZmVG9nZ2xlQnRuID0gY3V0b2ZmU2VjdGlvbi5jcmVhdGVEaXYoeyBjbHM6IFwiZmxhdC10YWctY3V0b2ZmLXRvZ2dsZVwiLCB0aXRsZTogXCJUb2dnbGUgZnJlcXVlbmN5IGN1dG9mZlwiIH0pO1xuXHRcdHRoaXMuY3V0b2ZmSW5wdXQgPSBjdXRvZmZTZWN0aW9uLmNyZWF0ZUVsKFwiaW5wdXRcIiwge1xuXHRcdFx0Y2xzOiBcImZsYXQtdGFnLWN1dG9mZi1pbnB1dFwiLFxuXHRcdFx0YXR0cjogeyB0eXBlOiBcIm51bWJlclwiLCBtaW46IFwiMFwiLCBzdGVwOiBcIjFcIiwgaW5wdXRtb2RlOiBcIm51bWVyaWNcIiwgcGxhY2Vob2xkZXI6IFwiMFwiIH0sXG5cdFx0fSk7XG5cblx0XHR0aGlzLmN1dG9mZlRvZ2dsZUJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgYXN5bmMgKCkgPT4ge1xuXHRcdFx0dGhpcy5wbHVnaW4uc2V0dGluZ3MuZnJlcXVlbmN5Q3V0b2ZmRW5hYmxlZCA9ICF0aGlzLnBsdWdpbi5zZXR0aW5ncy5mcmVxdWVuY3lDdXRvZmZFbmFibGVkO1xuXHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG5cdFx0XHR0aGlzLnN5bmNDdXRvZmZDb250cm9sc0Zyb21TZXR0aW5ncygpO1xuXHRcdFx0dGhpcy5yZW5kZXJUYWdzKCk7XG5cdFx0fSk7XG5cblx0XHR0aGlzLmN1dG9mZklucHV0LmFkZEV2ZW50TGlzdGVuZXIoXCJpbnB1dFwiLCBhc3luYyAoKSA9PiB7XG5cdFx0XHRjb25zdCBwYXJzZWQgPSBwYXJzZUludCh0aGlzLmN1dG9mZklucHV0LnZhbHVlLCAxMCk7XG5cdFx0XHRpZiAoIWlzTmFOKHBhcnNlZCkgJiYgcGFyc2VkID49IDApIHtcblx0XHRcdFx0dGhpcy5wbHVnaW4uc2V0dGluZ3MuZnJlcXVlbmN5Q3V0b2ZmID0gcGFyc2VkO1xuXHRcdFx0XHRhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcblx0XHRcdFx0dGhpcy5yZW5kZXJUYWdzKCk7XG5cdFx0XHR9XG5cdFx0fSk7XG5cblx0XHR0aGlzLnNvcnRBekJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuXHRcdFx0aWYgKHRoaXMuY3VycmVudFNvcnQgPT09IFwiYXpcIikge1xuXHRcdFx0XHRjb25zdCB2YXVsdE5hbWUgPSB0aGlzLmFwcC52YXVsdC5nZXROYW1lKCk7XG5cdFx0XHRcdGNvbnN0IGNvdW50ID0gT2JqZWN0LmtleXModGhpcy5hcHAubWV0YWRhdGFDYWNoZS5nZXRUYWdzKCkpLmxlbmd0aDtcblx0XHRcdFx0bmV3IE5vdGljZShgJyR7dmF1bHROYW1lfSc6ICR7Y291bnR9IHVuaXF1ZSB0YWdzYCk7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHR0aGlzLmN1cnJlbnRTb3J0ID0gXCJhelwiO1xuXHRcdFx0XHR0aGlzLnVwZGF0ZU1vZGVVSSh0cnVlKTtcblx0XHRcdH1cblx0XHR9KTtcblxuXHRcdHRoaXMuc29ydENvdW50QnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG5cdFx0XHRpZiAodGhpcy5jdXJyZW50U29ydCA9PT0gXCJjb3VudFwiKSB7XG5cdFx0XHRcdGNvbnN0IHZhdWx0TmFtZSA9IHRoaXMuYXBwLnZhdWx0LmdldE5hbWUoKTtcblx0XHRcdFx0Y29uc3QgY291bnQgPSBPYmplY3Qua2V5cyh0aGlzLmFwcC5tZXRhZGF0YUNhY2hlLmdldFRhZ3MoKSkubGVuZ3RoO1xuXHRcdFx0XHRuZXcgTm90aWNlKGAnJHt2YXVsdE5hbWV9JzogJHtjb3VudH0gdW5pcXVlIHRhZ3NgKTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdHRoaXMuY3VycmVudFNvcnQgPSBcImNvdW50XCI7XG5cdFx0XHRcdHRoaXMudXBkYXRlTW9kZVVJKHRydWUpO1xuXHRcdFx0fVxuXHRcdH0pO1xuXG5cdFx0dGhpcy5zY29wZUJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4gdGhpcy50b2dnbGVTY29wZU1vZGUoKSk7XG5cdFx0dGhpcy50YXNrQnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB0aGlzLnRvZ2dsZVRhc2tNb2RlKCkpO1xuXG5cdFx0Y29uc3Qgc2VhcmNoU2VjdGlvbiA9IHRoaXMuc29ydENvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6IFwiZmxhdC10YWctc2VhcmNoLXNlY3Rpb25cIiB9KTtcblx0XHRjb25zdCBzZWFyY2hCb3ggPSBzZWFyY2hTZWN0aW9uLmNyZWF0ZUVsKFwiaW5wdXRcIiwge1xuXHRcdFx0Y2xzOiBcImZsYXQtdGFnLXNlYXJjaC1pbnB1dFwiLFxuXHRcdFx0YXR0cjogeyB0eXBlOiBcInRleHRcIiwgcGxhY2Vob2xkZXI6IFwiU2VhcmNoIHRhZ3MuLi5cIiB9LFxuXHRcdH0pO1xuXG5cdFx0Y29uc3QgY2xlYXJTZWFyY2hCdXR0b24gPSBzZWFyY2hTZWN0aW9uLmNyZWF0ZURpdih7IGNsczogXCJmbGF0LXRhZy1zZWFyY2gtY2xlYXItYnV0dG9uXCIsIHRpdGxlOiBcIkNsZWFyIHNlYXJjaFwiIH0pO1xuXHRcdHNldEljb24oY2xlYXJTZWFyY2hCdXR0b24sIFwic3F1YXJlLXhcIik7XG5cdFx0Y2xlYXJTZWFyY2hCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHRoaXMuY2xlYXJTZWFyY2hCb3goKSk7XG5cblx0XHRzZWFyY2hCb3guYWRkRXZlbnRMaXN0ZW5lcihcImlucHV0XCIsIChlKSA9PiB7XG5cdFx0XHRjb25zdCB0YXJnZXQgPSBlLnRhcmdldCBhcyBIVE1MSW5wdXRFbGVtZW50O1xuXHRcdFx0dGhpcy50YWdTZWFyY2hUZXh0ID0gdGFyZ2V0LnZhbHVlID8/IFwiXCI7XG5cdFx0XHR0aGlzLnJlbmRlclRhZ3MoKTtcblx0XHR9KTtcblxuXHRcdHRoaXMudGFnQ29udGFpbmVyID0gdGhpcy5jb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiBcImZsYXQtdGFnLWxpc3RcIiB9KTtcblxuXHRcdHRoaXMuc3luY0N1dG9mZkNvbnRyb2xzRnJvbVNldHRpbmdzKCk7XG5cdFx0dGhpcy51cGRhdGVNb2RlVUkodHJ1ZSk7XG5cblx0XHR0aGlzLmFwcC53b3Jrc3BhY2Uub25MYXlvdXRSZWFkeShhc3luYyAoKSA9PiB7XG5cdFx0XHRhd2FpdCB0aGlzLmxvYWRUYWdzKCk7XG5cdFx0fSk7XG5cblx0XHR0aGlzLnJlZ2lzdGVyRXZlbnQodGhpcy5hcHAubWV0YWRhdGFDYWNoZS5vbihcImNoYW5nZWRcIiwgKGZpbGU6IFRGaWxlKSA9PiB7XG5cdFx0XHR0aGlzLnVwZGF0ZUZpbGVUYWdzKGZpbGUpO1xuXHRcdH0pKTtcblxuXHRcdHRoaXMucmVnaXN0ZXJFdmVudCh0aGlzLmFwcC52YXVsdC5vbihcImRlbGV0ZVwiLCAoZmlsZSkgPT4ge1xuXHRcdFx0aWYgKGZpbGUgaW5zdGFuY2VvZiBURmlsZSAmJiBmaWxlLmV4dGVuc2lvbiA9PT0gXCJtZFwiKSB7XG5cdFx0XHRcdHRoaXMucmVtb3ZlRmlsZVRhZ3MoZmlsZS5wYXRoKTtcblx0XHRcdFx0dGhpcy5yZW5kZXJUYWdzKCk7XG5cdFx0XHR9XG5cdFx0fSkpO1xuXG5cdFx0dGhpcy5yZWdpc3RlckV2ZW50KHRoaXMuYXBwLnZhdWx0Lm9uKFwicmVuYW1lXCIsIChmaWxlLCBvbGRQYXRoKSA9PiB7XG5cdFx0XHRpZiAoZmlsZSBpbnN0YW5jZW9mIFRGaWxlICYmIGZpbGUuZXh0ZW5zaW9uID09PSBcIm1kXCIpIHtcblx0XHRcdFx0Y29uc3QgdGFncyA9IHRoaXMudGFnc0J5RmlsZS5nZXQob2xkUGF0aCk7XG5cdFx0XHRcdGlmICh0YWdzKSB7XG5cdFx0XHRcdFx0dGhpcy50YWdzQnlGaWxlLnNldChmaWxlLnBhdGgsIHRhZ3MpO1xuXHRcdFx0XHRcdHRoaXMudGFnc0J5RmlsZS5kZWxldGUob2xkUGF0aCk7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9KSk7XG5cblx0XHR0aGlzLnJlZ2lzdGVyRXZlbnQodGhpcy5hcHAud29ya3NwYWNlLm9uKFwiZmxhdC10YWctdmlldzpzZXR0aW5ncy11cGRhdGVkXCIgYXMgYW55LCAoKSA9PiB7XG5cdFx0XHR0aGlzLnN5bmNDdXRvZmZDb250cm9sc0Zyb21TZXR0aW5ncygpO1xuXHRcdFx0dGhpcy5yZW5kZXJUYWdzKCk7XG5cdFx0fSkpO1xuXHR9XG5cblx0YXN5bmMgb25DbG9zZSgpIHtcblx0XHR0aGlzLmNvbnRlbnRFbC5lbXB0eSgpO1xuXHR9XG5cblx0YXN5bmMgbG9hZFRhZ3MoKSB7XG5cdFx0dGhpcy5hbGxUYWdzLmNsZWFyKCk7XG5cdFx0dGhpcy50YWdzQnlGaWxlLmNsZWFyKCk7XG5cdFx0Y29uc3QgZmlsZXMgPSB0aGlzLmFwcC52YXVsdC5nZXRNYXJrZG93bkZpbGVzKCk7XG5cdFx0Zm9yIChjb25zdCBmaWxlIG9mIGZpbGVzKSB7XG5cdFx0XHRjb25zdCBmaWxlVGFncyA9IHRoaXMuZ2V0RmlsZVRhZ3MoZmlsZSk7XG5cdFx0XHR0aGlzLnRhZ3NCeUZpbGUuc2V0KGZpbGUucGF0aCwgZmlsZVRhZ3MpO1xuXHRcdFx0ZmlsZVRhZ3MuZm9yRWFjaCh0YWcgPT4gdGhpcy5hbGxUYWdzLnNldCh0YWcsICh0aGlzLmFsbFRhZ3MuZ2V0KHRhZykgfHwgMCkgKyAxKSk7XG5cdFx0fVxuXHRcdHRoaXMucmVuZGVyVGFncygpO1xuXHR9XG5cblx0cHJpdmF0ZSB1cGRhdGVGaWxlVGFncyhmaWxlOiBURmlsZSkge1xuXHRcdGNvbnN0IG9sZFRhZ3NBcnIgPSB0aGlzLnRhZ3NCeUZpbGUuZ2V0KGZpbGUucGF0aCkgfHwgW107XG5cdFx0Y29uc3QgbmV3VGFnc0FyciA9IHRoaXMuZ2V0RmlsZVRhZ3MoZmlsZSk7XG5cdFx0Y29uc3Qgb2xkU29ydGVkID0gWy4uLm9sZFRhZ3NBcnJdLnNvcnQoKS5qb2luKFwiLFwiKTtcblx0XHRjb25zdCBuZXdTb3J0ZWQgPSBbLi4ubmV3VGFnc0Fycl0uc29ydCgpLmpvaW4oXCIsXCIpO1xuXHRcdGlmIChvbGRTb3J0ZWQgPT09IG5ld1NvcnRlZCkge1xuXHRcdFx0aWYgKHRoaXMuc2VsZWN0ZWRUYWdzLnNpemUgPiAwICYmIHRoaXMuc2VhcmNoTW9kZSAhPT0gXCJub3RlXCIpIHtcblx0XHRcdFx0Y29uc3Qgc2VsZWN0ZWRBcnIgPSBBcnJheS5mcm9tKHRoaXMuc2VsZWN0ZWRUYWdzKTtcblx0XHRcdFx0aWYgKHNlbGVjdGVkQXJyLmV2ZXJ5KHQgPT4gb2xkVGFnc0Fyci5pbmNsdWRlcyh0KSkpIHtcblx0XHRcdFx0XHR0aGlzLnJlbmRlclRhZ3MoKTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdFx0cmV0dXJuO1xuXHRcdH1cblxuXHRcdG9sZFRhZ3NBcnIuZm9yRWFjaCh0YWcgPT4ge1xuXHRcdFx0Y29uc3QgY291bnQgPSAodGhpcy5hbGxUYWdzLmdldCh0YWcpIHx8IDApIC0gMTtcblx0XHRcdGlmIChjb3VudCA8PSAwKSB0aGlzLmFsbFRhZ3MuZGVsZXRlKHRhZyk7XG5cdFx0XHRlbHNlIHRoaXMuYWxsVGFncy5zZXQodGFnLCBjb3VudCk7XG5cdFx0fSk7XG5cdFx0bmV3VGFnc0Fyci5mb3JFYWNoKHRhZyA9PiB0aGlzLmFsbFRhZ3Muc2V0KHRhZywgKHRoaXMuYWxsVGFncy5nZXQodGFnKSB8fCAwKSArIDEpKTtcblx0XHR0aGlzLnRhZ3NCeUZpbGUuc2V0KGZpbGUucGF0aCwgbmV3VGFnc0Fycik7XG5cdFx0dGhpcy5yZW5kZXJUYWdzKCk7XG5cdH1cblxuXHRwcml2YXRlIHJlbW92ZUZpbGVUYWdzKGZpbGVQYXRoOiBzdHJpbmcpIHtcblx0XHRjb25zdCBvbGRUYWdzID0gdGhpcy50YWdzQnlGaWxlLmdldChmaWxlUGF0aCk7XG5cdFx0aWYgKCFvbGRUYWdzKSByZXR1cm47XG5cdFx0b2xkVGFncy5mb3JFYWNoKHRhZyA9PiB7XG5cdFx0XHRjb25zdCBjb3VudCA9ICh0aGlzLmFsbFRhZ3MuZ2V0KHRhZykgfHwgMCkgLSAxO1xuXHRcdFx0aWYgKGNvdW50IDw9IDApIHRoaXMuYWxsVGFncy5kZWxldGUodGFnKTtcblx0XHRcdGVsc2UgdGhpcy5hbGxUYWdzLnNldCh0YWcsIGNvdW50KTtcblx0XHR9KTtcblx0XHR0aGlzLnRhZ3NCeUZpbGUuZGVsZXRlKGZpbGVQYXRoKTtcblx0fVxuXG5cdGFzeW5jIHJlbmRlclRhZ3MoKSB7XG5cdFx0dGhpcy5zb3J0QXpCdG4udG9nZ2xlQ2xhc3MoXCJpcy1hY3RpdmVcIiwgdGhpcy5jdXJyZW50U29ydCA9PT0gXCJhelwiKTtcblx0XHR0aGlzLnNvcnRDb3VudEJ0bi50b2dnbGVDbGFzcyhcImlzLWFjdGl2ZVwiLCB0aGlzLmN1cnJlbnRTb3J0ID09PSBcImNvdW50XCIpO1xuXG5cdFx0Y29uc3QgY3VycmVudFJlbmRlcklkID0gKyt0aGlzLnJlbmRlcklkO1xuXHRcdGNvbnN0IGZpbHRlcmVkVGFncyA9IGF3YWl0IHRoaXMuZ2V0RmlsdGVyZWRUYWdzQXN5bmMoKTtcblx0XHRpZiAoY3VycmVudFJlbmRlcklkICE9PSB0aGlzLnJlbmRlcklkKSByZXR1cm47XG5cblx0XHR0aGlzLnRhZ0NvbnRhaW5lci5lbXB0eSgpO1xuXG5cdFx0Y29uc3QgcGlubmVkID0gbmV3IE1hcDxzdHJpbmcsIG51bWJlcj4oKTtcblx0XHRjb25zdCBub3JtYWwgPSBuZXcgTWFwPHN0cmluZywgbnVtYmVyPigpO1xuXHRcdGNvbnN0IHBpbm5lZFNldCA9IG5ldyBTZXQodGhpcy5wbHVnaW4uc2V0dGluZ3MucGlubmVkVGFncyA/PyBbXSk7XG5cblx0XHRmaWx0ZXJlZFRhZ3MuZm9yRWFjaCgoY291bnQsIHRhZykgPT4ge1xuXHRcdFx0aWYgKHBpbm5lZFNldC5oYXModGFnKSkgcGlubmVkLnNldCh0YWcsIGNvdW50KTtcblx0XHRcdGVsc2Ugbm9ybWFsLnNldCh0YWcsIGNvdW50KTtcblx0XHR9KTtcblxuXHRcdGlmIChwaW5uZWQuc2l6ZSA+IDApIHtcblx0XHRcdGNvbnN0IHBpbkNvbnRhaW5lciA9IHRoaXMudGFnQ29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogXCJmbGF0LXRhZy1waW5uZWQtc2VjdGlvblwiIH0pO1xuXHRcdFx0Y29uc3QgcGlubmVkSWNvbiA9IHBpbkNvbnRhaW5lci5jcmVhdGVTcGFuKHsgY2xzOiBcImZsYXQtdGFnLWxldHRlclwiIH0pO1xuXHRcdFx0c2V0SWNvbihwaW5uZWRJY29uLCBcInBpblwiKTtcblx0XHRcdEFycmF5LmZyb20ocGlubmVkLmVudHJpZXMoKSlcblx0XHRcdFx0LnNvcnQoKGEsIGIpID0+IGFbMF0ubG9jYWxlQ29tcGFyZShiWzBdLCBcInBsXCIpKVxuXHRcdFx0XHQuZm9yRWFjaCgoW3RhZywgY291bnRdKSA9PiB0aGlzLmNyZWF0ZVRhZ0VsZW1lbnQodGFnLCBjb3VudCwgcGluQ29udGFpbmVyKSk7XG5cdFx0XHR0aGlzLnRhZ0NvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6IFwiZmxhdC10YWctc2VwYXJhdG9yXCIgfSk7XG5cdFx0fVxuXG5cdFx0bGV0IHNvcnRlZFRhZ3MgPSBBcnJheS5mcm9tKG5vcm1hbC5lbnRyaWVzKCkpO1xuXG5cdFx0aWYgKHRoaXMuY3VycmVudFNvcnQgPT09IFwiYXpcIikge1xuXHRcdFx0Ly8gVHJ1ZSB1bml2ZXJzYWwgc29ydGluZyAoXHUwMTA0IGFmdGVyIEEsIFx1MDEwNiBhZnRlciBDKVxuXHRcdFx0Y29uc3QgY29sbGF0b3IgPSBuZXcgSW50bC5Db2xsYXRvcihcInBsXCIsIHsgbnVtZXJpYzogdHJ1ZSwgc2Vuc2l0aXZpdHk6IFwiYmFzZVwiIH0pO1xuXHRcdFx0XG5cdFx0XHQvLyBDdXN0b20gc29ydCBmdW5jdGlvbiB0aGF0IGZvcmNlcyBlbW9qaXMsIG51bWJlcnMsIGFuZCBzeW1ib2xzIHRvIHRoZSBhYnNvbHV0ZSB0b3Bcblx0XHRcdHNvcnRlZFRhZ3Muc29ydCgoYSwgYikgPT4ge1xuXHRcdFx0XHRjb25zdCBjaGFyQSA9IEFycmF5LmZyb20oYVswXSlbMF0gfHwgXCJcIjtcblx0XHRcdFx0Y29uc3QgY2hhckIgPSBBcnJheS5mcm9tKGJbMF0pWzBdIHx8IFwiXCI7XG5cdFx0XHRcdGNvbnN0IGlzTGV0dGVyQSA9IC9eXFxwe0x9JC91LnRlc3QoY2hhckEpO1xuXHRcdFx0XHRjb25zdCBpc0xldHRlckIgPSAvXlxccHtMfSQvdS50ZXN0KGNoYXJCKTtcblxuXHRcdFx0XHQvLyBJZiBvbmUgaXMgbm90IGEgbGV0dGVyIGFuZCB0aGUgb3RoZXIgaXMsIHRoZSBub24tbGV0dGVyIHdpbnMgKGdvZXMgdG8gdG9wKVxuXHRcdFx0XHRpZiAoIWlzTGV0dGVyQSAmJiBpc0xldHRlckIpIHJldHVybiAtMTtcblx0XHRcdFx0aWYgKGlzTGV0dGVyQSAmJiAhaXNMZXR0ZXJCKSByZXR1cm4gMTtcblx0XHRcdFx0XG5cdFx0XHRcdC8vIE90aGVyd2lzZSwgdXNlIG5hdGl2ZSBQb2xpc2ggc29ydGluZ1xuXHRcdFx0XHRyZXR1cm4gY29sbGF0b3IuY29tcGFyZShhWzBdLCBiWzBdKTtcblx0XHRcdH0pO1xuXG5cdFx0XHRsZXQgY3VycmVudEhlYWRlciA9IFwiXCI7XG5cblx0XHRcdGZvciAoY29uc3QgW3RhZywgY291bnRdIG9mIHNvcnRlZFRhZ3MpIHtcblx0XHRcdFx0Y29uc3QgZmlyc3RDaGFyID0gKEFycmF5LmZyb20odGFnKVswXSB8fCBcIlwiKS50b1VwcGVyQ2FzZSgpO1xuXHRcdFx0XHRjb25zdCBpc0xldHRlciA9IC9eXFxwe0x9JC91LnRlc3QoZmlyc3RDaGFyKTtcblx0XHRcdFx0XG5cdFx0XHRcdGNvbnN0IGhlYWRlclRvVXNlID0gaXNMZXR0ZXIgPyBmaXJzdENoYXIgOiBcIk9USEVSXCI7XG5cblx0XHRcdFx0aWYgKGhlYWRlclRvVXNlICE9PSBjdXJyZW50SGVhZGVyKSB7XG5cdFx0XHRcdFx0Y3VycmVudEhlYWRlciA9IGhlYWRlclRvVXNlO1xuXHRcdFx0XHRcdGlmIChjdXJyZW50SGVhZGVyICE9PSBcIk9USEVSXCIpIHtcblx0XHRcdFx0XHRcdGNvbnN0IGxldHRlckVsID0gdGhpcy50YWdDb250YWluZXIuY3JlYXRlU3Bhbih7IGNsczogXCJmbGF0LXRhZy1sZXR0ZXJcIiB9KTtcblx0XHRcdFx0XHRcdGxldHRlckVsLnNldFRleHQoY3VycmVudEhlYWRlcik7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cblx0XHRcdFx0dGhpcy5jcmVhdGVUYWdFbGVtZW50KHRhZywgY291bnQsIHRoaXMudGFnQ29udGFpbmVyKTtcblx0XHRcdH1cblx0XHR9IGVsc2Uge1xuXHRcdFx0c29ydGVkVGFncy5zb3J0KChhLCBiKSA9PiB7XG5cdFx0XHRcdGlmIChiWzFdICE9PSBhWzFdKSByZXR1cm4gYlsxXSAtIGFbMV07XG5cdFx0XHRcdHJldHVybiBhWzBdLmxvY2FsZUNvbXBhcmUoYlswXSwgXCJwbFwiKTtcblx0XHRcdH0pO1xuXHRcdFx0c29ydGVkVGFncy5mb3JFYWNoKChbdGFnLCBjb3VudF0pID0+IHRoaXMuY3JlYXRlVGFnRWxlbWVudCh0YWcsIGNvdW50LCB0aGlzLnRhZ0NvbnRhaW5lcikpO1xuXHRcdH1cblx0fVxuXG5cdHByaXZhdGUgY3JlYXRlVGFnRWxlbWVudCh0YWc6IHN0cmluZywgY291bnQ6IG51bWJlciwgcGFyZW50RWw6IEhUTUxFbGVtZW50KSB7XG5cdFx0Y29uc3QgdGFnRWwgPSBwYXJlbnRFbC5jcmVhdGVTcGFuKHsgY2xzOiBcImZsYXQtdGFnXCIgfSk7XG5cblx0XHRpZiAodGhpcy5zZWxlY3RlZFRhZ3MuaGFzKHRhZykpIHRhZ0VsLmFkZENsYXNzKFwiZmxhdC10YWctc2VsZWN0ZWRcIik7XG5cdFx0ZWxzZSBpZiAodGhpcy5leGNsdWRlZFRhZ3MuaGFzKHRhZykpIHRhZ0VsLmFkZENsYXNzKFwiZmxhdC10YWctZXhjbHVkZWRcIik7XG5cdFx0aWYgKCh0aGlzLnBsdWdpbi5zZXR0aW5ncy5waW5uZWRUYWdzID8/IFtdKS5pbmNsdWRlcyh0YWcpKSB0YWdFbC5hZGRDbGFzcyhcImZsYXQtdGFnLXBpbm5lZFwiKTtcblxuXHRcdHRhZ0VsLnNldFRleHQoYCMke3RhZ30gKCR7Y291bnR9KWApO1xuXHRcdHRhZ0VsLnN0eWxlLnVzZXJTZWxlY3QgPSBcIm5vbmVcIjtcblx0XHQodGFnRWwuc3R5bGUgYXMgYW55KS53ZWJraXRVc2VyU2VsZWN0ID0gXCJub25lXCI7XG5cblx0XHRjb25zdCBoYW5kbGVUYWdJbnRlcmFjdGlvbiA9IGFzeW5jIChpc011bHRpU2VsZWN0OiBib29sZWFuLCBpc0V4Y2x1ZGU6IGJvb2xlYW4sIGlzUGluOiBib29sZWFuKSA9PiB7XG5cdFx0XHRpZiAoaXNQaW4pIHtcblx0XHRcdFx0Y29uc3QgbGlzdCA9IHRoaXMucGx1Z2luLnNldHRpbmdzLnBpbm5lZFRhZ3MgPz8gW107XG5cdFx0XHRcdHRoaXMucGx1Z2luLnNldHRpbmdzLnBpbm5lZFRhZ3MgPSBsaXN0LmluY2x1ZGVzKHRhZylcblx0XHRcdFx0XHQ/IGxpc3QuZmlsdGVyKHQgPT4gdCAhPT0gdGFnKVxuXHRcdFx0XHRcdDogWy4uLmxpc3QsIHRhZ107XG5cdFx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuXHRcdFx0XHR0aGlzLnJlbmRlclRhZ3MoKTtcblx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0fVxuXG5cdFx0XHRpZiAoaXNFeGNsdWRlKSB7XG5cdFx0XHRcdGlmICh0aGlzLmV4Y2x1ZGVkVGFncy5oYXModGFnKSkgdGhpcy5leGNsdWRlZFRhZ3MuZGVsZXRlKHRhZyk7XG5cdFx0XHRcdGVsc2UgeyB0aGlzLmV4Y2x1ZGVkVGFncy5hZGQodGFnKTsgdGhpcy5zZWxlY3RlZFRhZ3MuZGVsZXRlKHRhZyk7IH1cblx0XHRcdH0gZWxzZSBpZiAoaXNNdWx0aVNlbGVjdCkge1xuXHRcdFx0XHRpZiAodGhpcy5zZWxlY3RlZFRhZ3MuaGFzKHRhZykpIHRoaXMuc2VsZWN0ZWRUYWdzLmRlbGV0ZSh0YWcpO1xuXHRcdFx0XHRlbHNlIHsgdGhpcy5zZWxlY3RlZFRhZ3MuYWRkKHRhZyk7IHRoaXMuZXhjbHVkZWRUYWdzLmRlbGV0ZSh0YWcpOyB9XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRpZiAodGhpcy5zZWxlY3RlZFRhZ3Muc2l6ZSA9PT0gMSAmJiB0aGlzLnNlbGVjdGVkVGFncy5oYXModGFnKSkgdGhpcy5zZWxlY3RlZFRhZ3MuY2xlYXIoKTtcblx0XHRcdFx0ZWxzZSB7XG5cdFx0XHRcdFx0dGhpcy5zZWxlY3RlZFRhZ3MuY2xlYXIoKTtcblx0XHRcdFx0XHR0aGlzLmV4Y2x1ZGVkVGFncy5jbGVhcigpO1xuXHRcdFx0XHRcdHRoaXMuc2VsZWN0ZWRUYWdzLmFkZCh0YWcpO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cblx0XHRcdGlmICh0aGlzLnNlbGVjdGVkVGFncy5oYXModGFnKSkge1xuXHRcdFx0XHR0YWdFbC5hZGRDbGFzcyhcImZsYXQtdGFnLXNlbGVjdGVkXCIpO1xuXHRcdFx0XHR0YWdFbC5yZW1vdmVDbGFzcyhcImZsYXQtdGFnLWV4Y2x1ZGVkXCIpO1xuXHRcdFx0fSBlbHNlIGlmICh0aGlzLmV4Y2x1ZGVkVGFncy5oYXModGFnKSkge1xuXHRcdFx0XHR0YWdFbC5hZGRDbGFzcyhcImZsYXQtdGFnLWV4Y2x1ZGVkXCIpO1xuXHRcdFx0XHR0YWdFbC5yZW1vdmVDbGFzcyhcImZsYXQtdGFnLXNlbGVjdGVkXCIpO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0dGFnRWwucmVtb3ZlQ2xhc3MoXCJmbGF0LXRhZy1zZWxlY3RlZFwiKTtcblx0XHRcdFx0dGFnRWwucmVtb3ZlQ2xhc3MoXCJmbGF0LXRhZy1leGNsdWRlZFwiKTtcblx0XHRcdH1cblxuXHRcdFx0dGhpcy5yZW5kZXJUYWdzKCk7XG5cdFx0XHR2b2lkIHRoaXMudXBkYXRlU2VhcmNoKCk7XG5cdFx0fTtcblxuXHRcdGxldCB0b3VjaEhhbmRsZWQgPSBmYWxzZTtcblx0XHRsZXQgdG91Y2hTdGFydFggPSAwO1xuXHRcdGxldCB0b3VjaFN0YXJ0WSA9IDA7XG5cdFx0bGV0IGlzU3dpcGluZyA9IGZhbHNlO1xuXHRcdGxldCBsb25nUHJlc3NUcmlnZ2VyZWQgPSBmYWxzZTtcblxuXHRcdC8vIFN0YW5kYXJkIExlZnQgQ2xpY2sgKEZpbHRlciAvIFBpbilcblx0XHR0YWdFbC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGUpID0+IHtcblx0XHRcdGlmICh0b3VjaEhhbmRsZWQpIHtcblx0XHRcdFx0dG91Y2hIYW5kbGVkID0gZmFsc2U7XG5cdFx0XHRcdHJldHVybjtcblx0XHRcdH1cblx0XHRcdGUucHJldmVudERlZmF1bHQoKTtcblx0XHRcdHZvaWQgaGFuZGxlVGFnSW50ZXJhY3Rpb24oISEoZS5jdHJsS2V5IHx8IGUubWV0YUtleSksICEhZS5zaGlmdEtleSwgISFlLmFsdEtleSk7XG5cdFx0fSk7XG5cblx0XHQvLyBcdTI1MDBcdTI1MDAgUmVsaWFibGUgUmlnaHQtQ2xpY2sgZm9yIEdsb2JhbCBNdXRlIFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFxuXHRcdHRhZ0VsLmFkZEV2ZW50TGlzdGVuZXIoXCJjb250ZXh0bWVudVwiLCAoZSkgPT4ge1xuXHRcdFx0aWYgKFBsYXRmb3JtLmlzTW9iaWxlKSB7XG5cdFx0XHRcdGUucHJldmVudERlZmF1bHQoKTtcblx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0fVxuXG5cdFx0XHRlLnByZXZlbnREZWZhdWx0KCk7XG5cdFx0XHRcblx0XHRcdGNvbnN0IG1lbnUgPSBuZXcgTWVudSgpO1xuXHRcdFx0Y29uc3QgaXNNdXRlZCA9IHRhZy5zdGFydHNXaXRoKFwiJVwiKTtcblx0XHRcdGNvbnN0IGFjdGlvbk5hbWUgPSBpc011dGVkID8gXCJHbG9iYWwgVW4tTXV0ZVwiIDogXCJHbG9iYWwgTXV0ZVwiO1xuXHRcdFx0Y29uc3QgdGFyZ2V0VGFnID0gaXNNdXRlZCA/IHRhZy5zbGljZSgxKSA6IGAlJHt0YWd9YDtcblx0XHRcdFxuXHRcdFx0bWVudS5hZGRJdGVtKChpdGVtKSA9PiB7XG5cdFx0XHRcdGl0ZW1cblx0XHRcdFx0XHQuc2V0VGl0bGUoYCR7YWN0aW9uTmFtZX0gdG8gIyR7dGFyZ2V0VGFnfWApXG5cdFx0XHRcdFx0LnNldEljb24oXCJhbGVydC10cmlhbmdsZVwiKVxuXHRcdFx0XHRcdC5vbkNsaWNrKCgpID0+IHtcblx0XHRcdFx0XHRcdG5ldyBHbG9iYWxNdXRlQ29uZmlybU1vZGFsKHRoaXMuYXBwLCB0YWcsIGFzeW5jICgpID0+IHtcblx0XHRcdFx0XHRcdFx0YXdhaXQgdGhpcy5leGVjdXRlR2xvYmFsTXV0ZSh0YWcpO1xuXHRcdFx0XHRcdFx0fSkub3BlbigpO1xuXHRcdFx0XHRcdH0pO1xuXHRcdFx0fSk7XG5cdFx0XHRcblx0XHRcdG1lbnUuc2hvd0F0TW91c2VFdmVudChlKTtcblx0XHR9KTtcblx0XHQvLyBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcblxuXHRcdHRhZ0VsLmFkZEV2ZW50TGlzdGVuZXIoXCJ0b3VjaHN0YXJ0XCIsIChlKSA9PiB7XG5cdFx0XHRjb25zdCB0b3VjaCA9IGUudG91Y2hlc1swXTtcblx0XHRcdHRvdWNoU3RhcnRYID0gdG91Y2guY2xpZW50WDtcblx0XHRcdHRvdWNoU3RhcnRZID0gdG91Y2guY2xpZW50WTtcblx0XHRcdGlzU3dpcGluZyA9IGZhbHNlO1xuXHRcdFx0bG9uZ1ByZXNzVHJpZ2dlcmVkID0gZmFsc2U7XG5cdFx0XHR0b3VjaEhhbmRsZWQgPSBmYWxzZTtcblxuXHRcdFx0aWYgKHRoaXMudG91Y2hUaW1lcikgd2luZG93LmNsZWFyVGltZW91dCh0aGlzLnRvdWNoVGltZXIpO1xuXHRcdFx0dGhpcy50b3VjaFRpbWVyID0gd2luZG93LnNldFRpbWVvdXQoKCkgPT4ge1xuXHRcdFx0XHR0aGlzLnRvdWNoVGltZXIgPSBudWxsO1xuXHRcdFx0XHRpZiAoIWlzU3dpcGluZykge1xuXHRcdFx0XHRcdGxvbmdQcmVzc1RyaWdnZXJlZCA9IHRydWU7XG5cdFx0XHRcdFx0dG91Y2hIYW5kbGVkID0gdHJ1ZTsgXG5cdFx0XHRcdFx0dm9pZCBoYW5kbGVUYWdJbnRlcmFjdGlvbih0cnVlLCBmYWxzZSwgZmFsc2UpO1xuXHRcdFx0XHR9XG5cdFx0XHR9LCA1MDApO1xuXHRcdH0sIHsgcGFzc2l2ZTogdHJ1ZSB9KTtcblxuXHRcdHRhZ0VsLmFkZEV2ZW50TGlzdGVuZXIoXCJ0b3VjaG1vdmVcIiwgKGUpID0+IHtcblx0XHRcdGNvbnN0IHRvdWNoID0gZS50b3VjaGVzWzBdO1xuXHRcdFx0Y29uc3QgZHggPSB0b3VjaC5jbGllbnRYIC0gdG91Y2hTdGFydFg7XG5cdFx0XHRjb25zdCBkeSA9IHRvdWNoLmNsaWVudFkgLSB0b3VjaFN0YXJ0WTtcblx0XHRcdGlmICghaXNTd2lwaW5nKSB7XG5cdFx0XHRcdGlmIChNYXRoLmFicyhkeCkgPiAxMCAmJiBNYXRoLmFicyhkeCkgPiBNYXRoLmFicyhkeSkpIHtcblx0XHRcdFx0XHRpZiAodGhpcy50b3VjaFRpbWVyKSB7IHdpbmRvdy5jbGVhclRpbWVvdXQodGhpcy50b3VjaFRpbWVyKTsgdGhpcy50b3VjaFRpbWVyID0gbnVsbDsgfVxuXHRcdFx0XHRcdGlzU3dpcGluZyA9IHRydWU7XG5cdFx0XHRcdH0gZWxzZSBpZiAoTWF0aC5hYnMoZHkpID4gMTApIHtcblx0XHRcdFx0XHRpZiAodGhpcy50b3VjaFRpbWVyKSB7IHdpbmRvdy5jbGVhclRpbWVvdXQodGhpcy50b3VjaFRpbWVyKTsgdGhpcy50b3VjaFRpbWVyID0gbnVsbDsgfVxuXHRcdFx0XHRcdHJldHVybjtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdFx0aWYgKGlzU3dpcGluZyAmJiBkeCA8IDApIHtcblx0XHRcdFx0ZS5wcmV2ZW50RGVmYXVsdCgpO1xuXHRcdFx0XHRjb25zdCBjYXBwZWQgPSBNYXRoLm1heChkeCwgLTkwKTtcblx0XHRcdFx0dGFnRWwuc3R5bGUudHJhbnNmb3JtID0gYHRyYW5zbGF0ZVgoJHtjYXBwZWR9cHgpYDtcblx0XHRcdFx0dGFnRWwuc3R5bGUub3BhY2l0eSA9IFN0cmluZygwLjUgKyAoTWF0aC5hYnMoY2FwcGVkKSAvIDkwKSAqIDAuNSk7XG5cdFx0XHR9XG5cdFx0fSwgeyBwYXNzaXZlOiBmYWxzZSB9KTtcblxuXHRcdHRhZ0VsLmFkZEV2ZW50TGlzdGVuZXIoXCJ0b3VjaGVuZFwiLCAoZSkgPT4ge1xuXHRcdFx0Y29uc3QgdG91Y2ggPSBlLmNoYW5nZWRUb3VjaGVzWzBdO1xuXHRcdFx0Y29uc3QgZHggPSB0b3VjaC5jbGllbnRYIC0gdG91Y2hTdGFydFg7XG5cdFx0XHR0YWdFbC5zdHlsZS50cmFuc2l0aW9uID0gXCJ0cmFuc2Zvcm0gMC4ycyBlYXNlLCBvcGFjaXR5IDAuMnMgZWFzZVwiO1xuXHRcdFx0dGFnRWwuc3R5bGUudHJhbnNmb3JtID0gXCJcIjtcblx0XHRcdHRhZ0VsLnN0eWxlLm9wYWNpdHkgPSBcIlwiO1xuXHRcdFx0c2V0VGltZW91dCgoKSA9PiB7IHRhZ0VsLnN0eWxlLnRyYW5zaXRpb24gPSBcIlwiOyB9LCAyMjApO1xuXG5cdFx0XHRpZiAoaXNTd2lwaW5nKSB7XG5cdFx0XHRcdGlzU3dpcGluZyA9IGZhbHNlO1xuXHRcdFx0XHR0b3VjaEhhbmRsZWQgPSB0cnVlOyBcblx0XHRcdFx0aWYgKGR4IDw9IC02MCkgdm9pZCBoYW5kbGVUYWdJbnRlcmFjdGlvbihmYWxzZSwgZmFsc2UsIHRydWUpO1xuXHRcdFx0XHRyZXR1cm47XG5cdFx0XHR9XG5cblx0XHRcdGlmIChsb25nUHJlc3NUcmlnZ2VyZWQpIHtcblx0XHRcdFx0bG9uZ1ByZXNzVHJpZ2dlcmVkID0gZmFsc2U7XG5cdFx0XHRcdHJldHVybjtcblx0XHRcdH1cblxuXHRcdFx0aWYgKHRoaXMudG91Y2hUaW1lcikge1xuXHRcdFx0XHR3aW5kb3cuY2xlYXJUaW1lb3V0KHRoaXMudG91Y2hUaW1lcik7XG5cdFx0XHRcdHRoaXMudG91Y2hUaW1lciA9IG51bGw7XG5cdFx0XHR9XG5cdFx0fSwgeyBwYXNzaXZlOiB0cnVlIH0pO1xuXG5cdFx0dGFnRWwuYWRkRXZlbnRMaXN0ZW5lcihcInRvdWNoY2FuY2VsXCIsICgpID0+IHtcblx0XHRcdGlzU3dpcGluZyA9IGZhbHNlO1xuXHRcdFx0bG9uZ1ByZXNzVHJpZ2dlcmVkID0gZmFsc2U7XG5cdFx0XHR0b3VjaEhhbmRsZWQgPSBmYWxzZTtcblx0XHRcdGlmICh0aGlzLnRvdWNoVGltZXIpIHsgd2luZG93LmNsZWFyVGltZW91dCh0aGlzLnRvdWNoVGltZXIpOyB0aGlzLnRvdWNoVGltZXIgPSBudWxsOyB9XG5cdFx0XHR0YWdFbC5zdHlsZS50cmFuc2l0aW9uID0gXCJ0cmFuc2Zvcm0gMC4ycyBlYXNlLCBvcGFjaXR5IDAuMnMgZWFzZVwiO1xuXHRcdFx0dGFnRWwuc3R5bGUudHJhbnNmb3JtID0gXCJcIjtcblx0XHRcdHRhZ0VsLnN0eWxlLm9wYWNpdHkgPSBcIlwiO1xuXHRcdFx0c2V0VGltZW91dCgoKSA9PiB7IHRhZ0VsLnN0eWxlLnRyYW5zaXRpb24gPSBcIlwiOyB9LCAyMjApO1xuXHRcdH0sIHsgcGFzc2l2ZTogdHJ1ZSB9KTtcblx0fVxuXG5cdC8vIFx1MjUwMFx1MjUwMCBFeGVjdXRlIEdsb2JhbCBNdXRlIGxvZ2ljIFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFxuXHRwcml2YXRlIGFzeW5jIGV4ZWN1dGVHbG9iYWxNdXRlKHRhZzogc3RyaW5nKSB7XG5cdFx0Y29uc3QgaXNDdXJyZW50bHlNdXRlZCA9IHRhZy5zdGFydHNXaXRoKFwiJVwiKTtcblx0XHRcblx0XHRjb25zdCB0YXJnZXRUYWdXb3JkID0gaXNDdXJyZW50bHlNdXRlZCA/IHRhZy5zbGljZSgxKSA6IGAlJHt0YWd9YDtcblx0XHRcblx0XHQvLyBDcmVhdGUgYSByZWdleCB0byBmaW5kIHRoZSBleGFjdCB0YWcsIHJlc3BlY3RpbmcgYm91bmRhcmllc1xuXHRcdC8vIEhhbmRsZXMgdGFncyB3aXRoIG9yIHdpdGhvdXQgJSBwcmVmaXggc2VjdXJlbHlcblx0XHRjb25zdCBlc2NhcGVkVGFnID0gdGFnLnJlcGxhY2UoL1suKis/XiR7fSgpfFtcXF1cXFxcXS9nLCAnXFxcXCQmJyk7XG5cdFx0Y29uc3QgdGFnUmVnZXggPSBuZXcgUmVnRXhwKGAjJHtlc2NhcGVkVGFnfSg/IVtcXFxccHtMfVxcXFxwe059X1xcXFwtJV0pYCwgJ2d1Jyk7XG5cblx0XHRsZXQgZmlsZXNNb2RpZmllZCA9IDA7XG5cdFx0Y29uc3QgZmlsZXNUb1Byb2Nlc3M6IHN0cmluZ1tdID0gW107XG5cblx0XHR0aGlzLnRhZ3NCeUZpbGUuZm9yRWFjaCgodGFnc0FyciwgZmlsZVBhdGgpID0+IHtcblx0XHRcdGlmICh0YWdzQXJyLmluY2x1ZGVzKHRhZykpIHtcblx0XHRcdFx0ZmlsZXNUb1Byb2Nlc3MucHVzaChmaWxlUGF0aCk7XG5cdFx0XHR9XG5cdFx0fSk7XG5cblx0XHRuZXcgTm90aWNlKGBHbG9iYWxseSByZXBsYWNpbmcgIyR7dGFnfS4uLmApO1xuXG5cdFx0Zm9yIChjb25zdCBmaWxlUGF0aCBvZiBmaWxlc1RvUHJvY2Vzcykge1xuXHRcdFx0Y29uc3QgZmlsZSA9IHRoaXMuYXBwLnZhdWx0LmdldEFic3RyYWN0RmlsZUJ5UGF0aChmaWxlUGF0aCk7XG5cdFx0XHRpZiAoZmlsZSBpbnN0YW5jZW9mIFRGaWxlKSB7XG5cdFx0XHRcdGF3YWl0IHRoaXMuYXBwLnZhdWx0LnByb2Nlc3MoZmlsZSwgKGRhdGEpID0+IHtcblx0XHRcdFx0XHRjb25zdCBuZXdEYXRhID0gZGF0YS5yZXBsYWNlKHRhZ1JlZ2V4LCBgIyR7dGFyZ2V0VGFnV29yZH1gKTtcblx0XHRcdFx0XHRpZiAoZGF0YSAhPT0gbmV3RGF0YSkgZmlsZXNNb2RpZmllZCsrO1xuXHRcdFx0XHRcdHJldHVybiBuZXdEYXRhO1xuXHRcdFx0XHR9KTtcblx0XHRcdH1cblx0XHR9XG5cblx0XHRuZXcgTm90aWNlKGBTdWNjZXNzOiBSZXBsYWNlZCAjJHt0YWd9IHdpdGggIyR7dGFyZ2V0VGFnV29yZH0gaW4gJHtmaWxlc01vZGlmaWVkfSBmaWxlKHMpLmApO1xuXHRcdFxuXHRcdC8vIENsZWFyIHNlbGVjdGlvbiBpZiB3ZSBqdXN0IG11dGVkIGl0IGdsb2JhbGx5IHNvIFVJIGRvZXNuJ3QgbG9vayBicm9rZW5cblx0XHR0aGlzLnNlbGVjdGVkVGFncy5kZWxldGUodGFnKTtcblx0XHR0aGlzLmV4Y2x1ZGVkVGFncy5kZWxldGUodGFnKTtcblx0XHR0aGlzLnJlbmRlclRhZ3MoKTtcblx0XHR2b2lkIHRoaXMudXBkYXRlU2VhcmNoKCk7XG5cdH1cblx0Ly8gXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXG5cblx0cHJpdmF0ZSBhc3luYyBnZXRGaWx0ZXJlZFRhZ3NBc3luYygpOiBQcm9taXNlPE1hcDxzdHJpbmcsIG51bWJlcj4+IHtcblx0XHRsZXQgZmlsdGVyZWQgPSBuZXcgTWFwPHN0cmluZywgbnVtYmVyPigpO1xuXG5cdFx0aWYgKHRoaXMuc2VsZWN0ZWRUYWdzLnNpemUgPT09IDApIHtcblx0XHRcdGZpbHRlcmVkID0gbmV3IE1hcCh0aGlzLmFsbFRhZ3MpO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHRjb25zdCBzZWxlY3RlZEFyciA9IEFycmF5LmZyb20odGhpcy5zZWxlY3RlZFRhZ3MpO1xuXHRcdFx0Y29uc3QgbWF0Y2hpbmdGaWxlczogc3RyaW5nW10gPSBbXTtcblx0XHRcdHRoaXMudGFnc0J5RmlsZS5mb3JFYWNoKCh0YWdzQXJyLCBmaWxlUGF0aCkgPT4ge1xuXHRcdFx0XHRpZiAoc2VsZWN0ZWRBcnIuZXZlcnkodCA9PiB0YWdzQXJyLmluY2x1ZGVzKHQpKSkgbWF0Y2hpbmdGaWxlcy5wdXNoKGZpbGVQYXRoKTtcblx0XHRcdH0pO1xuXG5cdFx0XHRpZiAodGhpcy5zZWFyY2hNb2RlID09PSBcIm5vdGVcIikge1xuXHRcdFx0XHRmb3IgKGNvbnN0IGZpbGVQYXRoIG9mIG1hdGNoaW5nRmlsZXMpIHtcblx0XHRcdFx0XHRjb25zdCB0YWdzID0gdGhpcy50YWdzQnlGaWxlLmdldChmaWxlUGF0aCk7XG5cdFx0XHRcdFx0aWYgKCF0YWdzKSBjb250aW51ZTtcblx0XHRcdFx0XHRmb3IgKGNvbnN0IHQgb2YgdGFncykgZmlsdGVyZWQuc2V0KHQsIChmaWx0ZXJlZC5nZXQodCkgfHwgMCkgKyAxKTtcblx0XHRcdFx0fVxuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0Zm9yIChjb25zdCBmaWxlUGF0aCBvZiBtYXRjaGluZ0ZpbGVzKSB7XG5cdFx0XHRcdFx0Y29uc3QgZmlsZSA9IHRoaXMuYXBwLnZhdWx0LmdldEFic3RyYWN0RmlsZUJ5UGF0aChmaWxlUGF0aCk7XG5cdFx0XHRcdFx0aWYgKCEoZmlsZSBpbnN0YW5jZW9mIFRGaWxlKSkgY29udGludWU7XG5cdFx0XHRcdFx0Y29uc3QgY29udGVudCA9IGF3YWl0IHRoaXMuYXBwLnZhdWx0LmNhY2hlZFJlYWQoZmlsZSk7XG5cdFx0XHRcdFx0Y29uc3QgbGluZXMgPSBjb250ZW50LnNwbGl0KC9cXHI/XFxuLyk7XG5cdFx0XHRcdFx0Zm9yIChjb25zdCBsaW5lIG9mIGxpbmVzKSB7XG5cdFx0XHRcdFx0XHRjb25zdCBsb3dlciA9IGxpbmUudG9Mb3dlckNhc2UoKTtcblx0XHRcdFx0XHRcdGlmICh0aGlzLnNlYXJjaE1vZGUgPT09IFwidGFza1wiICAgICAgJiYgIWxvd2VyLmluY2x1ZGVzKFwiLSBbXCIpKSAgIGNvbnRpbnVlO1xuXHRcdFx0XHRcdFx0aWYgKHRoaXMuc2VhcmNoTW9kZSA9PT0gXCJ0YXNrLXRvZG9cIiAmJiAhbG93ZXIuaW5jbHVkZXMoXCItIFsgXVwiKSkgY29udGludWU7XG5cdFx0XHRcdFx0XHRpZiAodGhpcy5zZWFyY2hNb2RlID09PSBcInRhc2stZG9uZVwiICYmICFsb3dlci5pbmNsdWRlcyhcIi0gW3hcIikpICBjb250aW51ZTtcblx0XHRcdFx0XHRcdGNvbnN0IGxpbmVUYWdzID0gbmV3IFNldDxzdHJpbmc+KCk7XG5cdFx0XHRcdFx0XHRjb25zdCB0YWdSZWdleCA9IC8jKD8hJSkoW15cXHMjXSspL2c7XG5cdFx0XHRcdFx0XHRsZXQgbTogUmVnRXhwRXhlY0FycmF5IHwgbnVsbDtcblx0XHRcdFx0XHRcdHdoaWxlICgobSA9IHRhZ1JlZ2V4LmV4ZWMobG93ZXIpKSAhPT0gbnVsbCkgbGluZVRhZ3MuYWRkKG1bMV0pO1xuXHRcdFx0XHRcdFx0Y29uc3QgaGFzQWxsID0gc2VsZWN0ZWRBcnIuZXZlcnkoc2VsID0+XG5cdFx0XHRcdFx0XHRcdEFycmF5LmZyb20obGluZVRhZ3MpLnNvbWUodCA9PiB0LnRvTG93ZXJDYXNlKCkgPT09IHNlbC50b0xvd2VyQ2FzZSgpKVxuXHRcdFx0XHRcdFx0KTtcblx0XHRcdFx0XHRcdGlmICghaGFzQWxsKSBjb250aW51ZTtcblx0XHRcdFx0XHRcdGZvciAoY29uc3QgdCBvZiBsaW5lVGFncykgZmlsdGVyZWQuc2V0KHQsIChmaWx0ZXJlZC5nZXQodCkgfHwgMCkgKyAxKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9XG5cblx0XHRmb3IgKGNvbnN0IHQgb2YgdGhpcy5zZWxlY3RlZFRhZ3MpIGlmICghZmlsdGVyZWQuaGFzKHQpKSBmaWx0ZXJlZC5zZXQodCwgdGhpcy5hbGxUYWdzLmdldCh0KSB8fCAwKTtcblx0XHRmb3IgKGNvbnN0IHQgb2YgdGhpcy5leGNsdWRlZFRhZ3MpIGlmICghZmlsdGVyZWQuaGFzKHQpKSBmaWx0ZXJlZC5zZXQodCwgdGhpcy5hbGxUYWdzLmdldCh0KSB8fCAwKTtcblxuXHRcdGNvbnN0IGN1dG9mZkVuYWJsZWQgPSB0aGlzLnBsdWdpbi5zZXR0aW5ncy5mcmVxdWVuY3lDdXRvZmZFbmFibGVkID8/IGZhbHNlO1xuXHRcdGNvbnN0IGN1dG9mZiA9IGN1dG9mZkVuYWJsZWQgPyAodGhpcy5wbHVnaW4uc2V0dGluZ3MuZnJlcXVlbmN5Q3V0b2ZmID8/IDApIDogMDtcblx0XHRjb25zdCBwaW5uZWQgPSBuZXcgU2V0KHRoaXMucGx1Z2luLnNldHRpbmdzLnBpbm5lZFRhZ3MgPz8gW10pO1xuXG5cdFx0aWYgKGN1dG9mZiA+IDApIHtcblx0XHRcdGNvbnN0IG5leHQgPSBuZXcgTWFwPHN0cmluZywgbnVtYmVyPigpO1xuXHRcdFx0ZmlsdGVyZWQuZm9yRWFjaCgoY291bnQsIHRhZykgPT4ge1xuXHRcdFx0XHRpZiAoY291bnQgPj0gY3V0b2ZmIHx8IHRoaXMuc2VsZWN0ZWRUYWdzLmhhcyh0YWcpIHx8IHBpbm5lZC5oYXModGFnKSkgbmV4dC5zZXQodGFnLCBjb3VudCk7XG5cdFx0XHR9KTtcblx0XHRcdGZpbHRlcmVkID0gbmV4dDtcblx0XHR9XG5cblx0XHRpZiAodGhpcy50YWdTZWFyY2hUZXh0KSB7XG5cdFx0XHRjb25zdCBxID0gdGhpcy50YWdTZWFyY2hUZXh0LnRvTG93ZXJDYXNlKCk7XG5cdFx0XHRjb25zdCBuZXh0ID0gbmV3IE1hcDxzdHJpbmcsIG51bWJlcj4oKTtcblx0XHRcdGZpbHRlcmVkLmZvckVhY2goKGNvdW50LCB0YWcpID0+IHtcblx0XHRcdFx0aWYgKHRhZy50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKHEpIHx8IHRoaXMuc2VsZWN0ZWRUYWdzLmhhcyh0YWcpIHx8IHRoaXMuZXhjbHVkZWRUYWdzLmhhcyh0YWcpKVxuXHRcdFx0XHRcdG5leHQuc2V0KHRhZywgY291bnQpO1xuXHRcdFx0fSk7XG5cdFx0XHRmaWx0ZXJlZCA9IG5leHQ7XG5cdFx0fVxuXG5cdFx0cmV0dXJuIGZpbHRlcmVkO1xuXHR9XG5cblx0cHJpdmF0ZSBhc3luYyB1cGRhdGVTZWFyY2gob3B0aW9ucz86IHsgcmV2ZWFsU2VhcmNoPzogYm9vbGVhbjsgY3JlYXRlSWZNaXNzaW5nPzogYm9vbGVhbiB9KSB7XG5cdFx0Y29uc3Qgd29ya3NwYWNlID0gdGhpcy5hcHAud29ya3NwYWNlO1xuXHRcdGNvbnN0IHByZXZMZWFmID0gd29ya3NwYWNlLmFjdGl2ZUxlYWY7XG5cblx0XHRjb25zdCBpc1RvdWNoQ29udGV4dCA9IFBsYXRmb3JtLmlzTW9iaWxlIHx8IHRoaXMubGFzdEludGVyYWN0aW9uV2FzVG91Y2g7XG5cdFx0Y29uc3QgcmV2ZWFsU2VhcmNoICAgID0gb3B0aW9ucz8ucmV2ZWFsU2VhcmNoICAgID8/ICFpc1RvdWNoQ29udGV4dDtcblx0XHRjb25zdCBjcmVhdGVJZk1pc3NpbmcgPSBvcHRpb25zPy5jcmVhdGVJZk1pc3NpbmcgPz8gIWlzVG91Y2hDb250ZXh0O1xuXG5cdFx0bGV0IHNlYXJjaExlYWYgPSB3b3Jrc3BhY2UuZ2V0TGVhdmVzT2ZUeXBlKFwic2VhcmNoXCIpWzBdO1xuXG5cdFx0aWYgKCFzZWFyY2hMZWFmICYmIGNyZWF0ZUlmTWlzc2luZykge1xuXHRcdFx0Y29uc3QgcmlnaHRMZWFmID0gd29ya3NwYWNlLmdldFJpZ2h0TGVhZih0cnVlKTtcblx0XHRcdGlmIChyaWdodExlYWYpIHtcblx0XHRcdFx0c2VhcmNoTGVhZiA9IHJpZ2h0TGVhZjtcblx0XHRcdFx0YXdhaXQgc2VhcmNoTGVhZi5zZXRWaWV3U3RhdGUoeyB0eXBlOiBcInNlYXJjaFwiLCBhY3RpdmU6IGZhbHNlIH0pO1xuXHRcdFx0fVxuXHRcdH1cblxuXHRcdGlmIChzZWFyY2hMZWFmICYmIHJldmVhbFNlYXJjaCkgd29ya3NwYWNlLnJldmVhbExlYWYoc2VhcmNoTGVhZik7XG5cdFx0aWYgKHByZXZMZWFmKSB3b3Jrc3BhY2Uuc2V0QWN0aXZlTGVhZihwcmV2TGVhZiwgeyBmb2N1czogdHJ1ZSB9KTtcblxuXHRcdHRoaXMubGFzdEludGVyYWN0aW9uV2FzVG91Y2ggPSBmYWxzZTtcblxuXHRcdGlmICghc2VhcmNoTGVhZikgcmV0dXJuO1xuXG5cdFx0Y29uc3Qgc2VsZWN0ZWQgPSBBcnJheS5mcm9tKHRoaXMuc2VsZWN0ZWRUYWdzKTtcblx0XHRjb25zdCBleGNsdWRlZCA9IEFycmF5LmZyb20odGhpcy5leGNsdWRlZFRhZ3MpO1xuXHRcdGNvbnN0IHNlYXJjaFZpZXcgPSBzZWFyY2hMZWFmLnZpZXcgYXMgYW55O1xuXG5cdFx0aWYgKHNlbGVjdGVkLmxlbmd0aCA9PT0gMCAmJiBleGNsdWRlZC5sZW5ndGggPT09IDApIHtcblx0XHRcdGNvbnN0IGNsZWFyQnRuID0gc2VhcmNoVmlldz8uY29udGFpbmVyRWw/LnF1ZXJ5U2VsZWN0b3IoXCIuc2VhcmNoLWlucHV0LWNsZWFyLWJ1dHRvblwiKSBhcyBIVE1MRWxlbWVudCB8IG51bGw7XG5cdFx0XHRpZiAoY2xlYXJCdG4pIGNsZWFyQnRuLmRpc3BhdGNoRXZlbnQobmV3IE1vdXNlRXZlbnQoXCJjbGlja1wiLCB7IGJ1YmJsZXM6IHRydWUsIGNhbmNlbGFibGU6IGZhbHNlIH0pKTtcblx0XHRcdGVsc2UgaWYgKHR5cGVvZiBzZWFyY2hWaWV3Py5zZXRRdWVyeSA9PT0gXCJmdW5jdGlvblwiKSBzZWFyY2hWaWV3LnNldFF1ZXJ5KFwiXCIpO1xuXHRcdFx0cmV0dXJuO1xuXHRcdH1cblxuXHRcdGxldCBxdWVyeSA9IFwiXCI7XG5cdFx0aWYgKHRoaXMuc2VhcmNoTW9kZSA9PT0gXCJub3RlXCIpIHtcblx0XHRcdHF1ZXJ5ID0gW1xuXHRcdFx0XHQuLi5zZWxlY3RlZC5tYXAodCA9PiBgdGFnOiMke3R9YCksXG5cdFx0XHRcdC4uLmV4Y2x1ZGVkLm1hcCh0ID0+IGAtdGFnOiMke3R9YCksXG5cdFx0XHRdLmpvaW4oXCIgXCIpO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHRjb25zdCBwcmVmaXggPVxuXHRcdFx0XHR0aGlzLnNlYXJjaE1vZGUgPT09IFwibGluZVwiICAgICAgPyBcImxpbmU6KFwiICAgICAgOlxuXHRcdFx0XHR0aGlzLnNlYXJjaE1vZGUgPT09IFwidGFza1wiICAgICAgPyBcInRhc2s6KFwiICAgICAgOlxuXHRcdFx0XHR0aGlzLnNlYXJjaE1vZGUgPT09IFwidGFzay10b2RvXCIgPyBcInRhc2stdG9kbzooXCIgOlxuXHRcdFx0XHQgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJ0YXNrLWRvbmU6KFwiO1xuXHRcdFx0Y29uc3QgYm9keSA9IFtcblx0XHRcdFx0Li4uc2VsZWN0ZWQubWFwKHQgPT4gYCMke3R9YCksXG5cdFx0XHRcdC4uLmV4Y2x1ZGVkLm1hcCh0ID0+IGAtIyR7dH1gKSxcblx0XHRcdF0uam9pbihcIiBcIik7XG5cdFx0XHRxdWVyeSA9IGAke3ByZWZpeH0ke2JvZHl9KWA7XG5cdFx0fVxuXG5cdFx0aWYgKHR5cGVvZiBzZWFyY2hWaWV3Py5zZXRRdWVyeSA9PT0gXCJmdW5jdGlvblwiKSB7XG5cdFx0XHRzZWFyY2hWaWV3LnNldFF1ZXJ5KHF1ZXJ5KTtcblx0XHRcdHNldFRpbWVvdXQoKCkgPT4gc2VhcmNoVmlldy5zZXRRdWVyeShxdWVyeSksIDE1MCk7XG5cdFx0fVxuXHR9XG5cblx0Z2V0RmlsZVRhZ3MoZmlsZTogVEZpbGUpOiBzdHJpbmdbXSB7XG5cdFx0Y29uc3QgY2FjaGUgPSB0aGlzLmFwcC5tZXRhZGF0YUNhY2hlLmdldEZpbGVDYWNoZShmaWxlKTtcblx0XHRpZiAoIWNhY2hlKSByZXR1cm4gW107XG5cdFx0Y29uc3QgdGFnczogc3RyaW5nW10gPSBbXTtcblx0XHRpZiAoY2FjaGUudGFncykgY2FjaGUudGFncy5mb3JFYWNoKHQgPT4gdGFncy5wdXNoKHQudGFnLnJlcGxhY2UoL14jLywgXCJcIikpKTtcblx0XHRjb25zdCBmbSA9IGNhY2hlLmZyb250bWF0dGVyPy50YWdzO1xuXHRcdGlmICh0eXBlb2YgZm0gPT09IFwic3RyaW5nXCIpIHtcblx0XHRcdGZtLnNwbGl0KFwiLFwiKS5tYXAocyA9PiBzLnRyaW0oKSkuZmlsdGVyKEJvb2xlYW4pLmZvckVhY2godCA9PiB0YWdzLnB1c2godC5yZXBsYWNlKC9eIy8sIFwiXCIpKSk7XG5cdFx0fSBlbHNlIGlmIChBcnJheS5pc0FycmF5KGZtKSkge1xuXHRcdFx0Zm0uZm9yRWFjaCh0ID0+IHsgaWYgKHQpIHRhZ3MucHVzaChTdHJpbmcodCkucmVwbGFjZSgvXiMvLCBcIlwiKSk7IH0pO1xuXHRcdH1cblx0XHRyZXR1cm4gQXJyYXkuZnJvbShuZXcgU2V0KHRhZ3MpKTtcblx0fVxuXG5cdHByaXZhdGUgc3luY0N1dG9mZkNvbnRyb2xzRnJvbVNldHRpbmdzKCkge1xuXHRcdGNvbnN0IGVuYWJsZWQgPSB0aGlzLnBsdWdpbi5zZXR0aW5ncy5mcmVxdWVuY3lDdXRvZmZFbmFibGVkID8/IGZhbHNlO1xuXHRcdGNvbnN0IGN1dG9mZiAgPSB0aGlzLnBsdWdpbi5zZXR0aW5ncy5mcmVxdWVuY3lDdXRvZmYgPz8gMDtcblx0XHR0aGlzLmN1dG9mZklucHV0LnZhbHVlID0gU3RyaW5nKGN1dG9mZik7XG5cdFx0dGhpcy5jdXRvZmZJbnB1dC5kaXNhYmxlZCA9ICFlbmFibGVkO1xuXHRcdHRoaXMuY3V0b2ZmVG9nZ2xlQnRuLnRvZ2dsZUNsYXNzKFwiaXMtZW5hYmxlZFwiLCBlbmFibGVkKTtcblx0XHR0aGlzLmN1dG9mZlRvZ2dsZUJ0bi50b2dnbGVDbGFzcyhcImlzLWRpc2FibGVkXCIsICFlbmFibGVkKTtcblx0XHRzZXRJY29uKHRoaXMuY3V0b2ZmVG9nZ2xlQnRuLCBlbmFibGVkID8gXCJleWVcIiA6IFwiZXllLW9mZlwiKTtcblx0fVxuXG5cdHB1YmxpYyB1cGRhdGVNb2RlVUkoc2tpcFNlYXJjaCA9IGZhbHNlKSB7XG5cdFx0dGhpcy5zb3J0QXpCdG4udG9nZ2xlQ2xhc3MoXCJpcy1hY3RpdmVcIiwgdGhpcy5jdXJyZW50U29ydCA9PT0gXCJhelwiKTtcblx0XHR0aGlzLnNvcnRDb3VudEJ0bi50b2dnbGVDbGFzcyhcImlzLWFjdGl2ZVwiLCB0aGlzLmN1cnJlbnRTb3J0ID09PSBcImNvdW50XCIpO1xuXG5cdFx0dGhpcy5zY29wZUJ0bi5yZW1vdmVDbGFzcyhcImlzLWFjdGl2ZVwiKTtcblx0XHR0aGlzLnRhc2tCdG4ucmVtb3ZlQ2xhc3MoXCJpcy1hY3RpdmVcIik7XG5cblx0XHRpZiAgICAgICh0aGlzLnNlYXJjaE1vZGUgPT09IFwibm90ZVwiKSAgICAgIHsgdGhpcy5zY29wZUJ0bi5zZXRUZXh0KFwiTk9URVwiKTsgICAgICB0aGlzLnNjb3BlQnRuLmFkZENsYXNzKFwiaXMtYWN0aXZlXCIpOyB9XG5cdFx0ZWxzZSBpZiAodGhpcy5zZWFyY2hNb2RlID09PSBcImxpbmVcIikgICAgICB7IHRoaXMuc2NvcGVCdG4uc2V0VGV4dChcIkxJTkVcIik7ICAgICAgdGhpcy5zY29wZUJ0bi5hZGRDbGFzcyhcImlzLWFjdGl2ZVwiKTsgfVxuXHRcdGVsc2UgaWYgKHRoaXMuc2VhcmNoTW9kZSA9PT0gXCJ0YXNrXCIpICAgICAgeyB0aGlzLnRhc2tCdG4uc2V0VGV4dChcIlRBU0stQUxMXCIpOyAgIHRoaXMudGFza0J0bi5hZGRDbGFzcyhcImlzLWFjdGl2ZVwiKTsgfVxuXHRcdGVsc2UgaWYgKHRoaXMuc2VhcmNoTW9kZSA9PT0gXCJ0YXNrLXRvZG9cIikgeyB0aGlzLnRhc2tCdG4uc2V0VGV4dChcIlRBU0stVE9ET1wiKTsgIHRoaXMudGFza0J0bi5hZGRDbGFzcyhcImlzLWFjdGl2ZVwiKTsgfVxuXHRcdGVsc2UgaWYgKHRoaXMuc2VhcmNoTW9kZSA9PT0gXCJ0YXNrLWRvbmVcIikgeyB0aGlzLnRhc2tCdG4uc2V0VGV4dChcIlRBU0stRE9ORVwiKTsgIHRoaXMudGFza0J0bi5hZGRDbGFzcyhcImlzLWFjdGl2ZVwiKTsgfVxuXG5cdFx0aWYgKFtcIm5vdGVcIiwgXCJsaW5lXCJdLmluY2x1ZGVzKHRoaXMuc2VhcmNoTW9kZSkpIHtcblx0XHRcdGlmICghW1wiVEFTSy1BTExcIiwgXCJUQVNLLVRPRE9cIiwgXCJUQVNLLURPTkVcIl0uaW5jbHVkZXModGhpcy50YXNrQnRuLmlubmVyVGV4dCkpIHRoaXMudGFza0J0bi5zZXRUZXh0KFwiVEFTSy1BTExcIik7XG5cdFx0fSBlbHNlIHtcblx0XHRcdGlmICghW1wiTk9URVwiLCBcIkxJTkVcIl0uaW5jbHVkZXModGhpcy5zY29wZUJ0bi5pbm5lclRleHQpKSB0aGlzLnNjb3BlQnRuLnNldFRleHQoXCJOT1RFXCIpO1xuXHRcdH1cblxuXHRcdGlmICghc2tpcFNlYXJjaCkgdm9pZCB0aGlzLnVwZGF0ZVNlYXJjaCgpO1xuXHRcdGlmICh0aGlzLnRhZ0NvbnRhaW5lcikgdGhpcy5yZW5kZXJUYWdzKCk7XG5cdH1cblxuXHRwdWJsaWMgdG9nZ2xlU2NvcGVNb2RlKCkge1xuXHRcdGlmIChbXCJub3RlXCIsIFwibGluZVwiXS5pbmNsdWRlcyh0aGlzLnNlYXJjaE1vZGUpKSB0aGlzLnNlYXJjaE1vZGUgPSB0aGlzLnNlYXJjaE1vZGUgPT09IFwibm90ZVwiID8gXCJsaW5lXCIgOiBcIm5vdGVcIjtcblx0XHRlbHNlIHRoaXMuc2VhcmNoTW9kZSA9IHRoaXMuc2NvcGVCdG4uaW5uZXJUZXh0ID09PSBcIkxJTkVcIiA/IFwibGluZVwiIDogXCJub3RlXCI7XG5cdFx0dGhpcy51cGRhdGVNb2RlVUkoKTtcblx0fVxuXG5cdHB1YmxpYyB0b2dnbGVUYXNrTW9kZSgpIHtcblx0XHRpZiAodGhpcy5zZWFyY2hNb2RlID09PSBcInRhc2tcIikgdGhpcy5zZWFyY2hNb2RlID0gXCJ0YXNrLXRvZG9cIjtcblx0XHRlbHNlIGlmICh0aGlzLnNlYXJjaE1vZGUgPT09IFwidGFzay10b2RvXCIpIHRoaXMuc2VhcmNoTW9kZSA9IFwidGFzay1kb25lXCI7XG5cdFx0ZWxzZSBpZiAodGhpcy5zZWFyY2hNb2RlID09PSBcInRhc2stZG9uZVwiKSB0aGlzLnNlYXJjaE1vZGUgPSBcInRhc2tcIjtcblx0XHRlbHNlIHtcblx0XHRcdGNvbnN0IGxhYmVsID0gdGhpcy50YXNrQnRuPy5pbm5lclRleHQgPz8gXCJUQVNLLUFMTFwiO1xuXHRcdFx0dGhpcy5zZWFyY2hNb2RlID1cblx0XHRcdGxhYmVsID09PSBcIlRBU0stVE9ET1wiID8gXCJ0YXNrLXRvZG9cIiA6XG5cdFx0XHRsYWJlbCA9PT0gXCJUQVNLLURPTkVcIiA/IFwidGFzay1kb25lXCIgOlxuXHRcdFx0XCJ0YXNrXCI7XG5cdFx0fVxuXG5cdFx0dGhpcy51cGRhdGVNb2RlVUkoKTtcblx0fVxuXG5cblx0cHVibGljIHRvZ2dsZVNvcnQoKSB7XG5cdFx0dGhpcy5jdXJyZW50U29ydCA9IHRoaXMuY3VycmVudFNvcnQgPT09IFwiYXpcIiA/IFwiY291bnRcIiA6IFwiYXpcIjtcblx0XHR0aGlzLnVwZGF0ZU1vZGVVSSh0cnVlKTtcblx0fVxuXG5cdHB1YmxpYyBjbGVhclRhZ1NlbGVjdGlvbnMoKSB7XG5cdFx0dGhpcy5zZWxlY3RlZFRhZ3MuY2xlYXIoKTtcblx0XHR0aGlzLmV4Y2x1ZGVkVGFncy5jbGVhcigpO1xuXHRcdHRoaXMucmVuZGVyVGFncygpO1xuXHRcdHZvaWQgdGhpcy51cGRhdGVTZWFyY2goeyByZXZlYWxTZWFyY2g6IGZhbHNlLCBjcmVhdGVJZk1pc3Npbmc6IGZhbHNlIH0pO1xuXHR9XG5cblx0cHVibGljIGNsZWFyU2VhcmNoQm94KCkge1xuXHRcdGNvbnN0IHNlYXJjaEJveCA9IHRoaXMuY29udGVudEVsLnF1ZXJ5U2VsZWN0b3IoXCIuZmxhdC10YWctc2VhcmNoLWlucHV0XCIpIGFzIEhUTUxJbnB1dEVsZW1lbnQgfCBudWxsO1xuXHRcdGlmIChzZWFyY2hCb3gpIHNlYXJjaEJveC52YWx1ZSA9IFwiXCI7XG5cdFx0dGhpcy50YWdTZWFyY2hUZXh0ID0gXCJcIjtcblx0XHR0aGlzLnJlbmRlclRhZ3MoKTtcblx0fVxuXG5cdHB1YmxpYyBzZWxlY3RTaW5nbGVUYWcodGFnOiBzdHJpbmcpIHtcblx0XHR0aGlzLnNlbGVjdGVkVGFncy5jbGVhcigpO1xuXHRcdHRoaXMuZXhjbHVkZWRUYWdzLmNsZWFyKCk7XG5cdFx0XG5cdFx0Y29uc3QgY2xlYW5UYWcgPSB0YWcucmVwbGFjZSgvXiMvLCBcIlwiKTtcblx0XHR0aGlzLnNlbGVjdGVkVGFncy5hZGQoY2xlYW5UYWcpO1xuXHRcdFxuXHRcdHRoaXMucmVuZGVyVGFncygpO1xuXHRcdHZvaWQgdGhpcy51cGRhdGVTZWFyY2goeyByZXZlYWxTZWFyY2g6IHRydWUsIGNyZWF0ZUlmTWlzc2luZzogdHJ1ZSB9KTtcblx0fVxufSIsICJleHBvcnQgY29uc3QgZ2V0U3R5bGVzID0gKCk6IHN0cmluZyA9PiB7XG5cdHJldHVybiBgXG4ud29ya3NwYWNlLXNwbGl0Lm1vZC1yb290IC52aWV3LWNvbnRlbnQuZmxhdC10YWctdmlldyB7XG5cdGRpc3BsYXk6IGZsZXg7XG5cdGZsZXgtZGlyZWN0aW9uOiBjb2x1bW47XG5cdGp1c3RpZnktY29udGVudDogZmxleC1zdGFydDtcblx0YWxpZ24taXRlbXM6IHN0cmV0Y2g7XG5cdGhlaWdodDogMTAwJTtcblx0cGFkZGluZzogMDtcblx0bWFyZ2luOiAwO1xufVxuXG4uZmxhdC10YWctY29udGFpbmVyIHtcblx0ZGlzcGxheTogZmxleDtcblx0ZmxleC1kaXJlY3Rpb246IGNvbHVtbjtcblx0YWxpZ24taXRlbXM6IGZsZXgtc3RhcnQ7XG5cdGp1c3RpZnktY29udGVudDogZmxleC1zdGFydDtcblx0d2lkdGg6IDEwMCU7XG5cdGhlaWdodDogMTAwJTtcblx0Ym94LXNpemluZzogYm9yZGVyLWJveDtcblx0cGFkZGluZzogMDtcblx0bWFyZ2luOiAwO1xufVxuXG4uZmxhdC10YWctc29ydC1jb250YWluZXIge1xuXHRkaXNwbGF5OiBmbGV4O1xuXHRqdXN0aWZ5LWNvbnRlbnQ6IHNwYWNlLWJldHdlZW47XG5cdGFsaWduLWl0ZW1zOiBjZW50ZXI7XG5cdGZsZXgtc2hyaW5rOiAwO1xuXHRwYWRkaW5nOiA4cHg7XG5cdGJhY2tncm91bmQtY29sb3I6IHZhcigtLWJhY2tncm91bmQtcHJpbWFyeSk7XG5cdGJvcmRlci1ib3R0b206IDFweCBzb2xpZCB2YXIoLS1iYWNrZ3JvdW5kLW1vZGlmaWVyLWJvcmRlcik7XG5cdHdpZHRoOiAxMDAlO1xuXHRmbGV4LXdyYXA6IHdyYXA7XG5cdGdhcDogOHB4O1xufVxuXG4uZmxhdC10YWctYnV0dG9ucy1zZWN0aW9uIHtcblx0ZGlzcGxheTogZmxleDtcblx0Z2FwOiA2cHg7XG5cdGFsaWduLWl0ZW1zOiBjZW50ZXI7XG5cdGZsZXgtd3JhcDogd3JhcDtcbn1cblxuLmZsYXQtdGFnLW1vZGUtYnV0dG9uIHtcblx0Y3Vyc29yOiBwb2ludGVyO1xuXHRwYWRkaW5nOiA0cHggMTBweDtcblx0Zm9udC1zaXplOiAwLjhlbTtcblx0Zm9udC13ZWlnaHQ6IDUwMDtcblx0Ym9yZGVyLXJhZGl1czogdmFyKC0tcmFkaXVzLXMpO1xuXHRjb2xvcjogdmFyKC0tdGV4dC1tdXRlZCk7XG5cdGJhY2tncm91bmQtY29sb3I6IHZhcigtLWJhY2tncm91bmQtbW9kaWZpZXItZm9ybS1maWVsZCk7XG5cdGJvcmRlcjogMXB4IHNvbGlkIHZhcigtLWJhY2tncm91bmQtbW9kaWZpZXItYm9yZGVyKTtcblx0dHJhbnNpdGlvbjogYWxsIDAuMTVzIGVhc2UtaW4tb3V0O1xuXHR1c2VyLXNlbGVjdDogbm9uZTtcblx0ZGlzcGxheTogZmxleDtcblx0YWxpZ24taXRlbXM6IGNlbnRlcjtcblx0anVzdGlmeS1jb250ZW50OiBjZW50ZXI7XG5cdG1pbi13aWR0aDogNjVweDtcbn1cblxuLmZsYXQtdGFnLW1vZGUtYnV0dG9uOmhvdmVyIHtcblx0Y29sb3I6IHZhcigtLXRleHQtbm9ybWFsKTtcblx0YmFja2dyb3VuZC1jb2xvcjogdmFyKC0tYmFja2dyb3VuZC1tb2RpZmllci1ob3Zlcik7XG5cdGJvcmRlci1jb2xvcjogdmFyKC0tYmFja2dyb3VuZC1tb2RpZmllci1ib3JkZXItaG92ZXIpO1xufVxuXG4uZmxhdC10YWctbW9kZS1idXR0b24uaXMtYWN0aXZlIHtcblx0YmFja2dyb3VuZC1jb2xvcjogdmFyKC0taW50ZXJhY3RpdmUtYWNjZW50KTtcblx0Y29sb3I6IHZhcigtLXRleHQtb24tYWNjZW50KTtcblx0Ym9yZGVyLWNvbG9yOiB2YXIoLS1pbnRlcmFjdGl2ZS1hY2NlbnQpO1xuXHRib3gtc2hhZG93OiBpbnNldCAwIDFweCAzcHggcmdiYSgwLCAwLCAwLCAwLjIpO1xufVxuXG4uZmxhdC10YWctbW9kZS1idXR0b24uaXMtYWN0aXZlOmhvdmVyIHtcblx0YmFja2dyb3VuZC1jb2xvcjogdmFyKC0taW50ZXJhY3RpdmUtYWNjZW50LWhvdmVyKTtcblx0Ym9yZGVyLWNvbG9yOiB2YXIoLS1pbnRlcmFjdGl2ZS1hY2NlbnQtaG92ZXIpO1xufVxuXG4uZmxhdC10YWctc2VhcmNoLXNlY3Rpb24ge1xuXHRkaXNwbGF5OiBmbGV4O1xuXHRhbGlnbi1pdGVtczogY2VudGVyO1xuXHRnYXA6IDRweDtcblx0bWFyZ2luLWxlZnQ6IGF1dG87XG5cdGJhY2tncm91bmQtY29sb3I6IHZhcigtLWJhY2tncm91bmQtc2Vjb25kYXJ5KTtcblx0Ym9yZGVyLXJhZGl1czogNHB4O1xuXHRwYWRkaW5nOiAycHggOHB4O1xuXHRmbGV4LWdyb3c6IDE7XG5cdG1heC13aWR0aDogMjIwcHg7XG59XG5cbi5mbGF0LXRhZy1zZWFyY2gtaW5wdXQge1xuXHRiYWNrZ3JvdW5kOiB0cmFuc3BhcmVudDtcblx0Ym9yZGVyOiBub25lO1xuXHRjb2xvcjogdmFyKC0tdGV4dC1ub3JtYWwpO1xuXHR3aWR0aDogMTAwJTtcblx0aGVpZ2h0OiAyNHB4O1xuXHRmb250LXNpemU6IDAuOWVtO1xufVxuXG4uZmxhdC10YWctc2VhcmNoLWlucHV0OmZvY3VzIHtcblx0b3V0bGluZTogbm9uZTtcblx0Ym94LXNoYWRvdzogbm9uZTtcbn1cblxuLmZsYXQtdGFnLXNlYXJjaC1jbGVhci1idXR0b24ge1xuXHRjdXJzb3I6IHBvaW50ZXI7XG5cdGNvbG9yOiB2YXIoLS10ZXh0LW11dGVkKTtcblx0ZGlzcGxheTogZmxleDtcblx0YWxpZ24taXRlbXM6IGNlbnRlcjtcblx0anVzdGlmeS1jb250ZW50OiBjZW50ZXI7XG5cdGZvbnQtc2l6ZTogMC44ZW07XG59XG5cbi5mbGF0LXRhZy1zZWFyY2gtY2xlYXItYnV0dG9uOmhvdmVyIHtcblx0Y29sb3I6IHZhcigtLXRleHQtbm9ybWFsKTtcbn1cblxuLmZsYXQtdGFnLXNvcnQtYnV0dG9uLFxuLmZsYXQtdGFnLWNsZWFyLWJ1dHRvbiB7XG5cdGN1cnNvcjogcG9pbnRlcjtcblx0cGFkZGluZzogNHB4O1xuXHRib3JkZXItcmFkaXVzOiA0cHg7XG5cdGRpc3BsYXk6IGZsZXg7XG5cdGFsaWduLWl0ZW1zOiBjZW50ZXI7XG5cdGp1c3RpZnktY29udGVudDogY2VudGVyO1xufVxuXG4uZmxhdC10YWctc29ydC1idXR0b246aG92ZXIsXG4uZmxhdC10YWctY2xlYXItYnV0dG9uOmhvdmVyIHtcblx0YmFja2dyb3VuZC1jb2xvcjogdmFyKC0taW50ZXJhY3RpdmUtaG92ZXIpO1xufVxuXG4uZmxhdC10YWctc29ydC1idXR0b24uaXMtYWN0aXZlIHtcblx0YmFja2dyb3VuZC1jb2xvcjogdmFyKC0taW50ZXJhY3RpdmUtYWNjZW50KTtcblx0Y29sb3I6IHZhcigtLXRleHQtb24tYWNjZW50KTtcblx0Ym94LXNoYWRvdzogaW5zZXQgMCAxcHggM3B4IHJnYmEoMCwgMCwgMCwgMC4yKTtcbn1cblxuLmZsYXQtdGFnLXNvcnQtYnV0dG9uLmlzLWFjdGl2ZTpob3ZlciB7XG5cdGJhY2tncm91bmQtY29sb3I6IHZhcigtLWludGVyYWN0aXZlLWFjY2VudC1ob3Zlcik7XG59XG5cbi8qIEN1dG9mZiBjb250cm9scyAqL1xuLmZsYXQtdGFnLWN1dG9mZi1zcGFjZXIge1xuXHRmbGV4OiAwIDAgOHB4O1xuXHR3aWR0aDogOHB4O1xuXHRoZWlnaHQ6IDFweDtcbn1cblxuLmZsYXQtdGFnLWN1dG9mZi1zZWN0aW9uIHtcblx0ZGlzcGxheTogZmxleDtcblx0YWxpZ24taXRlbXM6IGNlbnRlcjtcblx0Z2FwOiA2cHg7XG5cdHBhZGRpbmc6IDJweCA4cHg7XG5cdGJvcmRlci1yYWRpdXM6IHZhcigtLXJhZGl1cy1zKTtcblx0Ym9yZGVyOiAxcHggc29saWQgdmFyKC0tYmFja2dyb3VuZC1tb2RpZmllci1ib3JkZXIpO1xuXHRiYWNrZ3JvdW5kOiBsaW5lYXItZ3JhZGllbnQoMTgwZGVnLCB2YXIoLS1iYWNrZ3JvdW5kLXNlY29uZGFyeSkgMCUsIHZhcigtLWJhY2tncm91bmQtcHJpbWFyeSkgMTAwJSk7XG5cdGJveC1zaGFkb3c6IGluc2V0IDAgMXB4IDAgcmdiYSgyNTUsIDI1NSwgMjU1LCAwLjA0KTtcblx0aGVpZ2h0OiAyOHB4O1xufVxuXG4uZmxhdC10YWctY3V0b2ZmLXRvZ2dsZSB7XG5cdGN1cnNvcjogcG9pbnRlcjtcblx0ZGlzcGxheTogaW5saW5lLWZsZXg7XG5cdGFsaWduLWl0ZW1zOiBjZW50ZXI7XG5cdGp1c3RpZnktY29udGVudDogY2VudGVyO1xuXHRjb2xvcjogdmFyKC0tdGV4dC1tdXRlZCk7XG5cdHBhZGRpbmc6IDJweDtcblx0Ym9yZGVyLXJhZGl1czogdmFyKC0tcmFkaXVzLXMpO1xufVxuXG4uZmxhdC10YWctY3V0b2ZmLXRvZ2dsZTpob3ZlciB7XG5cdGNvbG9yOiB2YXIoLS10ZXh0LW5vcm1hbCk7XG5cdGJhY2tncm91bmQtY29sb3I6IHZhcigtLWJhY2tncm91bmQtbW9kaWZpZXItaG92ZXIpO1xufVxuXG4uZmxhdC10YWctY3V0b2ZmLXRvZ2dsZS5pcy1lbmFibGVkIHtcblx0Y29sb3I6IHZhcigtLWludGVyYWN0aXZlLWFjY2VudCk7XG59XG5cbi5mbGF0LXRhZy1jdXRvZmYtdG9nZ2xlLmlzLWRpc2FibGVkIHtcblx0b3BhY2l0eTogMC43O1xufVxuXG4uZmxhdC10YWctY3V0b2ZmLWlucHV0IHtcblx0d2lkdGg6IDUycHg7XG5cdGhlaWdodDogMjJweDtcblx0Ym9yZGVyOiBub25lO1xuXHRiYWNrZ3JvdW5kOiB0cmFuc3BhcmVudDtcblx0cGFkZGluZzogMDtcblx0bWFyZ2luOiAwO1xuXHR0ZXh0LWFsaWduOiBjZW50ZXI7XG5cdGZvbnQtc2l6ZTogMC45ZW07XG5cdGNvbG9yOiB2YXIoLS10ZXh0LW5vcm1hbCk7XG59XG5cbi5mbGF0LXRhZy1jdXRvZmYtaW5wdXQ6Zm9jdXMge1xuXHRvdXRsaW5lOiBub25lO1xuXHRib3gtc2hhZG93OiBub25lO1xufVxuXG4uZmxhdC10YWctY3V0b2ZmLWlucHV0OmRpc2FibGVkIHtcblx0Y29sb3I6IHZhcigtLXRleHQtZmFpbnQpO1xuXHRjdXJzb3I6IG5vdC1hbGxvd2VkO1xufVxuXG4uZmxhdC10YWctbGlzdCB7XG5cdGRpc3BsYXk6IGZsZXg7XG5cdGZsZXgtd3JhcDogd3JhcDtcblx0YWxpZ24tY29udGVudDogZmxleC1zdGFydDtcblx0b3ZlcmZsb3cteTogYXV0bztcblx0ZmxleDogMTtcblx0bGluZS1oZWlnaHQ6IDEuNWVtO1xuXHRwYWRkaW5nOiA4cHg7XG5cdHdpZHRoOiAxMDAlO1xufVxuXG4uZmxhdC10YWcge1xuXHRkaXNwbGF5OiBpbmxpbmUtYmxvY2s7XG5cdHBhZGRpbmc6IDJweCA2cHg7XG5cdG1hcmdpbjogMnB4O1xuXHRib3JkZXItcmFkaXVzOiA0cHg7XG5cdGN1cnNvcjogcG9pbnRlcjtcblx0YmFja2dyb3VuZC1jb2xvcjogdmFyKC0tdGFnLWJhY2tncm91bmQpO1xuXHRjb2xvcjogdmFyKC0tdGFnLWNvbG9yKTtcblx0dHJhbnNpdGlvbjogYmFja2dyb3VuZC1jb2xvciAwLjFzO1xufVxuXG4uZmxhdC10YWc6aG92ZXIge1xuXHRiYWNrZ3JvdW5kLWNvbG9yOiB2YXIoLS10YWctYmFja2dyb3VuZC1ob3Zlcik7XG59XG5cbi5mbGF0LXRhZy1zZWxlY3RlZCB7XG5cdGZvbnQtd2VpZ2h0OiBib2xkO1xuXHRiYWNrZ3JvdW5kLWNvbG9yOiB2YXIoLS1pbnRlcmFjdGl2ZS1hY2NlbnQpO1xuXHRjb2xvcjogdmFyKC0tdGV4dC1vbi1hY2NlbnQpO1xufVxuXG4uZmxhdC10YWctZXhjbHVkZWQge1xuXHRmb250LXdlaWdodDogYm9sZDtcblx0YmFja2dyb3VuZC1jb2xvcjogdmFyKC0tY29sb3ItcmVkKTtcblx0Y29sb3I6IHZhcigtLXRleHQtb24tYWNjZW50KTtcbn1cblxuLmZsYXQtdGFnLWxldHRlciB7XG5cdGRpc3BsYXk6IGlubGluZS1mbGV4O1xuXHRmb250LXdlaWdodDogYm9sZDtcblx0Zm9udC1zaXplOiAxLjJlbTtcblx0bWFyZ2luOiAycHg7XG5cdHBhZGRpbmc6IDJweCA2cHg7XG5cdGJvcmRlci1yYWRpdXM6IDRweDtcblx0YmFja2dyb3VuZC1jb2xvcjogdmFyKC0tYmFja2dyb3VuZC1zZWNvbmRhcnkpO1xuXHRjb2xvcjogdmFyKC0tdGV4dC1ub3JtYWwpO1xuXHRhbGlnbi1pdGVtczogY2VudGVyO1xuXHRqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlcjtcblx0bWluLXdpZHRoOiAyNHB4O1xufVxuXG4uZmxhdC10YWctcGlubmVkLXNlY3Rpb24ge1xuXHRwb3NpdGlvbjogc3RpY2t5O1xuICBcdHRvcDogMDtcbiAgXHR6LWluZGV4OiA1O1xuXHR3aWR0aDogMTAwJTtcblx0ZGlzcGxheTogZmxleDtcblx0ZmxleC13cmFwOiB3cmFwO1xuXHRhbGlnbi1pdGVtczogY2VudGVyO1xuXHRiYWNrZ3JvdW5kLWNvbG9yOiBjb2xvci1taXgoaW4gc3JnYiwgdmFyKC0taW50ZXJhY3RpdmUtYWNjZW50KSAxMCUsIHZhcigtLWJhY2tncm91bmQtcHJpbWFyeSkpO1xuXHRib3JkZXI6IDFweCBzb2xpZCBjb2xvci1taXgoaW4gc3JnYiwgdmFyKC0taW50ZXJhY3RpdmUtYWNjZW50KSAyNSUsIHRyYW5zcGFyZW50KTtcblx0cGFkZGluZzogNHB4O1xuXHRib3JkZXItcmFkaXVzOiB2YXIoLS1yYWRpdXMtcyk7XG5cdG1hcmdpbi1ib3R0b206IDRweDtcbn1cblxuLmZsYXQtdGFnLXNlcGFyYXRvciB7XG5cdHdpZHRoOiAxMDAlO1xuXHRoZWlnaHQ6IDFweDtcblx0YmFja2dyb3VuZC1jb2xvcjogdmFyKC0tYmFja2dyb3VuZC1tb2RpZmllci1ib3JkZXIpO1xuXHRtYXJnaW46IDRweCAwIDhweCAwO1xufVxuXG4uZmxhdC10YWctcGlubmVkIHtcblx0Ym9yZGVyOiAxcHggc29saWQgdmFyKC0taW50ZXJhY3RpdmUtYWNjZW50KTtcbn1cblxuXG4vKiBHbG93IHJlbWluZGVyIHdoZW4gbGlzdCBpcyBmaWx0ZXJlZDpcbiAgIGlucHV0IGlzIG5vdCBmb2N1c2VkIGFuZCBub3QgZW1wdHkgKHBsYWNlaG9sZGVyIG5vdCBzaG93bikuICovXG4uZmxhdC10YWctc2VhcmNoLWlucHV0Om5vdCg6Zm9jdXMpOm5vdCg6cGxhY2Vob2xkZXItc2hvd24pIHtcbiAgYm9yZGVyLWNvbG9yOiB2YXIoLS1pbnRlcmFjdGl2ZS1hY2NlbnQpO1xuICBib3gtc2hhZG93OlxuICAgIDAgMCAwIDJweCBjb2xvci1taXgoaW4gc3JnYiwgdmFyKC0taW50ZXJhY3RpdmUtYWNjZW50KSAzNSUsIHRyYW5zcGFyZW50KSxcbiAgICAwIDAgMTRweCBjb2xvci1taXgoaW4gc3JnYiwgdmFyKC0taW50ZXJhY3RpdmUtYWNjZW50KSAyNSUsIHRyYW5zcGFyZW50KTtcbiAgYW5pbWF0aW9uOiBmdHYtc2VhcmNoLXB1bHNlIDIuMnMgZWFzZS1pbi1vdXQgaW5maW5pdGU7XG59XG5cbkBrZXlmcmFtZXMgZnR2LXNlYXJjaC1wdWxzZSB7XG4gIDAlLCAxMDAlIHtcbiAgICBib3gtc2hhZG93OlxuICAgICAgMCAwIDAgMnB4IGNvbG9yLW1peChpbiBzcmdiLCB2YXIoLS1pbnRlcmFjdGl2ZS1hY2NlbnQpIDI4JSwgdHJhbnNwYXJlbnQpLFxuICAgICAgMCAwIDEwcHggY29sb3ItbWl4KGluIHNyZ2IsIHZhcigtLWludGVyYWN0aXZlLWFjY2VudCkgMTglLCB0cmFuc3BhcmVudCk7XG4gIH1cbiAgNTAlIHtcbiAgICBib3gtc2hhZG93OlxuICAgICAgMCAwIDAgMnB4IGNvbG9yLW1peChpbiBzcmdiLCB2YXIoLS1pbnRlcmFjdGl2ZS1hY2NlbnQpIDQ1JSwgdHJhbnNwYXJlbnQpLFxuICAgICAgMCAwIDE4cHggY29sb3ItbWl4KGluIHNyZ2IsIHZhcigtLWludGVyYWN0aXZlLWFjY2VudCkgMzUlLCB0cmFuc3BhcmVudCk7XG4gIH1cbn1cblxuLyogVGhlbWUgdHVuaW5nICovXG5ib2R5LnRoZW1lLWxpZ2h0IC5mbGF0LXRhZy1zZWFyY2gtaW5wdXQ6bm90KDpmb2N1cyk6bm90KDpwbGFjZWhvbGRlci1zaG93bikge1xuICBhbmltYXRpb24tZHVyYXRpb246IDIuNnM7XG59XG5cbmJvZHkudGhlbWUtZGFyayAuZmxhdC10YWctc2VhcmNoLWlucHV0Om5vdCg6Zm9jdXMpOm5vdCg6cGxhY2Vob2xkZXItc2hvd24pIHtcbiAgYW5pbWF0aW9uLWR1cmF0aW9uOiAyLjBzO1xufVxuXG4vKiBSZXNwZWN0IHJlZHVjZWQgbW90aW9uICovXG5AbWVkaWEgKHByZWZlcnMtcmVkdWNlZC1tb3Rpb246IHJlZHVjZSkge1xuICAuZmxhdC10YWctc2VhcmNoLWlucHV0Om5vdCg6Zm9jdXMpOm5vdCg6cGxhY2Vob2xkZXItc2hvd24pIHtcbiAgICBhbmltYXRpb246IG5vbmU7XG4gIH1cbn1cblxuYDtcbn07XG4iLCAiaW1wb3J0IHsgQXBwLCBQbHVnaW5TZXR0aW5nVGFiLCBTZXR0aW5nIH0gZnJvbSBcIm9ic2lkaWFuXCI7XG5pbXBvcnQgRmxhdFRhZ1BsdWdpbiBmcm9tIFwiLi9tYWluXCI7XG5cbmV4cG9ydCB0eXBlIEFsdENsaWNrVGFnTW9kZSA9IFwic3RhcnQtbGluZVwiIHwgXCJpbi1wbGFjZVwiIHwgXCJlbmQtbGluZVwiO1xuXG5leHBvcnQgaW50ZXJmYWNlIEZsYXRUYWdQbHVnaW5TZXR0aW5ncyB7XG5cdHBpbm5lZFRhZ3M6IHN0cmluZ1tdO1xuXHRmcmVxdWVuY3lDdXRvZmY6IG51bWJlcjtcblx0ZnJlcXVlbmN5Q3V0b2ZmRW5hYmxlZDogYm9vbGVhbjtcblxuXHRhbHRDbGlja1RhZ01vZGU6IEFsdENsaWNrVGFnTW9kZTtcblx0XG5cdHNob3dQbGFjZW1lbnRJblN0YXR1c0JhcjogYm9vbGVhbjtcblx0XG5cdG1vYmlsZUxvbmdQcmVzc0VuYWJsZWQ6IGJvb2xlYW47XG5cdG1vYmlsZUxvbmdQcmVzc01zOiBudW1iZXI7XG59XG5cbmV4cG9ydCBjb25zdCBERUZBVUxUX1NFVFRJTkdTOiBGbGF0VGFnUGx1Z2luU2V0dGluZ3MgPSB7XG5cdHBpbm5lZFRhZ3M6IFtdLFxuXHRmcmVxdWVuY3lDdXRvZmY6IDAsXG5cdGZyZXF1ZW5jeUN1dG9mZkVuYWJsZWQ6IGZhbHNlLFxuXG5cdGFsdENsaWNrVGFnTW9kZTogXCJzdGFydC1saW5lXCIsXG5cblx0c2hvd1BsYWNlbWVudEluU3RhdHVzQmFyOiB0cnVlLFxuXG5cdG1vYmlsZUxvbmdQcmVzc0VuYWJsZWQ6IHRydWUsXG5cdG1vYmlsZUxvbmdQcmVzc01zOiAxMDAwLFxufTtcblxuZXhwb3J0IGNsYXNzIEZsYXRUYWdTZXR0aW5nVGFiIGV4dGVuZHMgUGx1Z2luU2V0dGluZ1RhYiB7XG5cdHBsdWdpbjogRmxhdFRhZ1BsdWdpbjtcblxuXHRjb25zdHJ1Y3RvcihhcHA6IEFwcCwgcGx1Z2luOiBGbGF0VGFnUGx1Z2luKSB7XG5cdFx0c3VwZXIoYXBwLCBwbHVnaW4pO1xuXHRcdHRoaXMucGx1Z2luID0gcGx1Z2luO1xuXHR9XG5cblx0ZGlzcGxheSgpOiB2b2lkIHtcblx0XHRjb25zdCB7IGNvbnRhaW5lckVsIH0gPSB0aGlzO1xuXHRcdGNvbnRhaW5lckVsLmVtcHR5KCk7XG5cblx0XHRuZXcgU2V0dGluZyhjb250YWluZXJFbClcblx0XHRcdC5zZXROYW1lKFwiQWx0LWNsaWNrIHRhZyBwbGFjZW1lbnRcIilcblx0XHRcdC5zZXREZXNjKFwiV2hlbiBjcmVhdGluZyBhIHRhZywgd2hlcmUgaXQgc2hvdWxkIGdvLlwiKVxuXHRcdFx0LmFkZERyb3Bkb3duKChkZCkgPT5cblx0XHRcdFx0ZGRcblx0XHRcdFx0XHQuYWRkT3B0aW9uKFwic3RhcnQtbGluZVwiLCBcIlB1dCB0YWcgYXQgc3RhcnQgb2YgbGluZVwiKVxuXHRcdFx0XHRcdC5hZGRPcHRpb24oXCJpbi1wbGFjZVwiLCBcIlR1cm4gd29yZCBpbnRvIHRhZyBpbiBwbGFjZVwiKVxuXHRcdFx0XHRcdC5hZGRPcHRpb24oXCJlbmQtbGluZVwiLCBcIlB1dCB0YWcgYXQgZW5kIG9mIGxpbmVcIilcblx0XHRcdFx0XHQuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MuYWx0Q2xpY2tUYWdNb2RlKVxuXHRcdFx0XHRcdC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcblx0XHRcdFx0XHRcdHRoaXMucGx1Z2luLnNldHRpbmdzLmFsdENsaWNrVGFnTW9kZSA9IHZhbHVlIGFzIEFsdENsaWNrVGFnTW9kZTtcblx0XHRcdFx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuXHRcdFx0XHRcdH0pXG5cdFx0XHQpO1xuXHRcdG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxuXHRcdFx0LnNldE5hbWUoXCJTaG93IHBsYWNlbWVudCBvZiBuZXdseSBjcmVhdGVkIHRhZ3MgaW4gc3RhdHVzIGJhclwiKVxuXHRcdFx0LnNldERlc2MoXCJEaXNwbGF5cyBTT0wgLyBJTlAgLyBFT0wgaW4gdGhlIE9ic2lkaWFuIHN0YXR1cyBiYXIuXCIpXG5cdFx0XHQuYWRkVG9nZ2xlKHQgPT4gdFxuXHRcdFx0XHQuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3Muc2hvd1BsYWNlbWVudEluU3RhdHVzQmFyKVxuXHRcdFx0XHQub25DaGFuZ2UoYXN5bmMgKHZhbCkgPT4ge1xuXHRcdFx0XHRcdHRoaXMucGx1Z2luLnNldHRpbmdzLnNob3dQbGFjZW1lbnRJblN0YXR1c0JhciA9IHZhbDtcblx0XHRcdFx0XHRhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcblx0XHRcdFx0fSlcblx0XHRcdCk7XG5cdFx0Ly8gVE9ETzogcmUtZW5hYmxlIHdoZW4gbW9iaWxlIHRvdWNoIGhhbmRsaW5nIGlzIHN0YWJsZVx0XG5cdFx0Ly8gbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXG5cdFx0Ly8gXHQuc2V0TmFtZShcIk1vYmlsZSBsb25nLXByZXNzXCIpXG5cdFx0Ly8gXHQuc2V0RGVzYyhcIk9uIG1vYmlsZSwgYSBsb25nLXByZXNzIGNhbiB0cmlnZ2VyIHRoZSBzYW1lIGFjdGlvbiBhcyBBbHQtY2xpY2sgKHdvcmtzIGJlc3Qgd2hlbiB0ZXh0IGlzIHNlbGVjdGVkKS5cIilcblx0XHQvLyBcdC5hZGRUb2dnbGUoKHRvZ2dsZSkgPT5cblx0XHQvLyBcdFx0dG9nZ2xlLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLm1vYmlsZUxvbmdQcmVzc0VuYWJsZWQpLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuXHRcdC8vIFx0XHRcdHRoaXMucGx1Z2luLnNldHRpbmdzLm1vYmlsZUxvbmdQcmVzc0VuYWJsZWQgPSB2YWx1ZTtcblx0XHQvLyBcdFx0XHRhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcblx0XHQvLyBcdFx0fSlcblx0XHQvLyBcdCk7XG5cblx0XHQvLyBuZXcgU2V0dGluZyhjb250YWluZXJFbClcblx0XHQvLyBcdC5zZXROYW1lKFwiTW9iaWxlIGxvbmctcHJlc3MgZHVyYXRpb24gKG1zKVwiKVxuXHRcdC8vIFx0LnNldERlc2MoXCJSYW5nZTogMjUwXHUyMDEzNTAwMC4gRGVmYXVsdDogMTAwMC5cIilcblx0XHQvLyBcdC5hZGRUZXh0KCh0ZXh0KSA9PlxuXHRcdC8vIFx0XHR0ZXh0XG5cdFx0Ly8gXHRcdFx0LnNldFBsYWNlaG9sZGVyKFwiMTAwMFwiKVxuXHRcdC8vIFx0XHRcdC5zZXRWYWx1ZShTdHJpbmcodGhpcy5wbHVnaW4uc2V0dGluZ3MubW9iaWxlTG9uZ1ByZXNzTXMgPz8gMTAwMCkpXG5cdFx0Ly8gXHRcdFx0Lm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuXHRcdC8vIFx0XHRcdFx0Y29uc3QgcGFyc2VkID0gcGFyc2VJbnQodmFsdWUsIDEwKTtcblx0XHQvLyBcdFx0XHRcdGlmICghaXNOYU4ocGFyc2VkKSkge1xuXHRcdC8vIFx0XHRcdFx0XHR0aGlzLnBsdWdpbi5zZXR0aW5ncy5tb2JpbGVMb25nUHJlc3NNcyA9IE1hdGgubWF4KDI1MCwgTWF0aC5taW4oNTAwMCwgcGFyc2VkKSk7XG5cdFx0Ly8gXHRcdFx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuXHRcdC8vIFx0XHRcdFx0fVxuXHRcdC8vIFx0XHRcdH0pXG5cdFx0Ly8gXHQpO1xuXG5cdFx0bmV3IFNldHRpbmcoY29udGFpbmVyRWwpXG5cdFx0XHQuc2V0TmFtZShcIkZyZXF1ZW5jeSBjdXRvZmZcIilcblx0XHRcdC5zZXREZXNjKFwiSGlkZSB0YWdzIHRoYXQgYXBwZWFyIGZld2VyIHRpbWVzIHRoYW4gdGhpcyBudW1iZXIgaW4gdGhlIHZhdWx0LlwiKVxuXHRcdFx0LmFkZFRvZ2dsZSgodG9nZ2xlKSA9PlxuXHRcdFx0XHR0b2dnbGUuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MuZnJlcXVlbmN5Q3V0b2ZmRW5hYmxlZCkub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG5cdFx0XHRcdFx0dGhpcy5wbHVnaW4uc2V0dGluZ3MuZnJlcXVlbmN5Q3V0b2ZmRW5hYmxlZCA9IHZhbHVlO1xuXHRcdFx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuXHRcdFx0XHR9KVxuXHRcdFx0KVxuXHRcdFx0LmFkZFRleHQoKHRleHQpID0+XG5cdFx0XHRcdHRleHRcblx0XHRcdFx0XHQuc2V0UGxhY2Vob2xkZXIoXCIwXCIpXG5cdFx0XHRcdFx0LnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLmZyZXF1ZW5jeUN1dG9mZi50b1N0cmluZygpKVxuXHRcdFx0XHRcdC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcblx0XHRcdFx0XHRcdGNvbnN0IHBhcnNlZCA9IHBhcnNlSW50KHZhbHVlLCAxMCk7XG5cdFx0XHRcdFx0XHRpZiAoIWlzTmFOKHBhcnNlZCkgJiYgcGFyc2VkID49IDApIHtcblx0XHRcdFx0XHRcdFx0dGhpcy5wbHVnaW4uc2V0dGluZ3MuZnJlcXVlbmN5Q3V0b2ZmID0gcGFyc2VkO1xuXHRcdFx0XHRcdFx0XHRhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9KVxuXHRcdFx0KTtcblxuXHRcdG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxuXHRcdFx0LnNldE5hbWUoXCJDbGVhciBwaW5uZWQgdGFnc1wiKVxuXHRcdFx0LnNldERlc2MoXCJSZW1vdmVzIGFsbCBwaW5uZWQgdGFncyBmcm9tIHRoZSB0b3Agb2YgdGhlIGZsYXQgdGFnIGxpc3QuXCIpXG5cdFx0XHQuYWRkQnV0dG9uKChidG4pID0+XG5cdFx0XHRcdGJ0bi5zZXRCdXR0b25UZXh0KFwiQ2xlYXIgcGlubmVkXCIpLm9uQ2xpY2soYXN5bmMgKCkgPT4ge1xuXHRcdFx0XHRcdHRoaXMucGx1Z2luLnNldHRpbmdzLnBpbm5lZFRhZ3MgPSBbXTtcblx0XHRcdFx0XHRhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcblx0XHRcdFx0fSlcblx0XHRcdCk7XG5cdH1cbn1cbiJdLAogICJtYXBwaW5ncyI6ICI7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SyxXQUFXO0FBQ2hCLFNBQUssS0FBSyxhQUFhLEVBQUUsY0FBYyxNQUFNLGlCQUFpQixLQUFLLENBQUM7QUFBQSxFQUNyRTtBQUNEOzs7QUM1eUJPLElBQU0sWUFBWSxNQUFjO0FBQ3RDLFNBQU87QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFxVVI7OztBQ3RVQSxJQUFBQyxtQkFBK0M7QUFrQnhDLElBQU0sbUJBQTBDO0FBQUEsRUFDdEQsWUFBWSxDQUFDO0FB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RixpQkFBaUI7QUFBQSxNQUV2QixpQkFBa0IsT0FBTyxVQUFVLG9CQUFvQixZQUFZLENBQUMsTUFBTSxVQUFVLGVBQWUsSUFDN0YsS0FBSyxJQUFJLEdBQUcsS0FBSyxNQUFNLFVBQVUsZUFBZSxDQUFDLElBQ2pELGlCQUFpQjtBQUFBLE1BRXZCLHdCQUF3QixPQUFPLFVBQVUsMkJBQTJCLFlBQzlELFVBQVUseUJBQ1YsaUJBQWlCO0FBQUEsTUFFdkIsaUJBQWtCLFNBQVMsZ0JBQWdCLFNBQVMsY0FBYyxTQUFTLGFBQ3JFLE9BQ0EsaUJBQWlCO0FBQUEsTUFFdkIsd0JBQXdCLE9BQU8sVUFBVSwyQkFBMkIsWUFDOUQsVUFBVSx5QkFDVixpQkFBaUI7QUFBQSxNQUV2QixtQkFBb0IsT0FBTyxVQUFVLHNCQUFzQixZQUFZLENBQUMsTUFBTSxVQUFVLGlCQUFpQixJQUNuRyxLQUFLLElBQUksS0FBSyxLQUFLLElBQUksS0FBTSxLQUFLLE1BQU0sVUFBVSxpQkFBaUIsQ0FBQyxDQUFDLElBQ3JFLGlCQUFpQjtBQUFBLE1BRXZCLDBCQUEwQixPQUFPLFVBQVUsNkJBQTZCLFlBQ2xFLFVBQVUsMkJBQ1YsaUJBQWlCO0FBQUEsSUFDM0I7QUFHQSxVQUFNLEtBQUssU0FBUyxLQUFLLFFBQVE7QUFBQSxFQUNyQztBQUFBLEVBRUEsTUFBTSxlQUFlO0FBQ2pCLFVBQU0sS0FBSyxTQUFTLEtBQUssUUFBUTtBQUNqQyxTQUFLLElBQUksVUFBVSxRQUFRLGdDQUFnQztBQUMzRCxTQUFLLGdCQUFnQjtBQUFBLEVBQ3pCO0FBQUE7QUFBQSxFQUlBLE1BQU0sZUFBZTtBQUNqQixVQUFNLFlBQVksS0FBSyxJQUFJO0FBQzNCLFFBQUksT0FBTyxVQUFVLGdCQUFnQixTQUFTLEVBQUUsQ0FBQztBQUVqRCxRQUFJLENBQUMsTUFBTTtBQUNQLFlBQU0sWUFBWSxVQUFVLGFBQWEsS0FBSztBQUM5QyxVQUFJLENBQUM7QUFBVztBQUNoQixhQUFPO0FBQ1AsWUFBTSxLQUFLLGFBQWEsRUFBRSxNQUFNLFVBQVUsQ0FBQztBQUFBLElBQy9DO0FBRUEsY0FBVSxXQUFXLElBQUk7QUFBQSxFQUM3QjtBQUFBLEVBRVEsV0FBVztBQUNmLFVBQU0sVUFBVSxTQUFTLGNBQWMsT0FBTztBQUM5QyxZQUFRLFlBQVksVUFBVTtBQUM5QixhQUFTLEtBQUssWUFBWSxPQUFPO0FBQUEsRUFDckM7QUFDSjsiLAogICJuYW1lcyI6IFsiaW1wb3J0X29ic2lkaWFuIiwgIl9hIiwgImltcG9ydF9vYnNpZGlhbiIsICJuZXh0IiwgIm5ld0xpbmUiXQp9Cg==
